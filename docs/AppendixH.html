<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.30">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Elen Le Foll">
<title>Textbook English – Appendix H — Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./AppendixG.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./AppendixA.html">Appendices</a></li><li class="breadcrumb-item"><a href="./AppendixH.html"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Textbook English <br>(Le Foll 2024)</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="mailto:elefoll@uni-koeln.de" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
    <a href="https://github.com/elenlefoll/TextbookMDA/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Textbook-English.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Online supplements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./OpenScience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Open Science statement</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Synthesis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Literature Review Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Corpus Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Linguistic Features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Evaluation of the Multi-Feature Tagger of English (MFTE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Intra-Textbook Variation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Intra-Textbook Variation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixH.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#packages-required" id="toc-packages-required" class="nav-link active" data-scroll-target="#packages-required"><span class="header-section-number">H.1</span> Packages required</a></li>
  <li><a href="#conducting-the-pca" id="toc-conducting-the-pca" class="nav-link" data-scroll-target="#conducting-the-pca"><span class="header-section-number">H.2</span> Conducting the PCA</a></li>
  <li>
<a href="#plotting-pca-results" id="toc-plotting-pca-results" class="nav-link" data-scroll-target="#plotting-pca-results"><span class="header-section-number">H.3</span> Plotting PCA results</a>
  <ul class="collapse">
<li><a href="#d-plots" id="toc-d-plots" class="nav-link" data-scroll-target="#d-plots"><span class="header-section-number">H.3.1</span> 3D plots</a></li>
  </ul>
</li>
  <li>
<a href="#two-dimensional-plots-biplots" id="toc-two-dimensional-plots-biplots" class="nav-link" data-scroll-target="#two-dimensional-plots-biplots"><span class="header-section-number">H.4</span> Two-dimensional plots (biplots)</a>
  <ul class="collapse">
<li><a href="#data-wrangling-for-pcatools" id="toc-data-wrangling-for-pcatools" class="nav-link" data-scroll-target="#data-wrangling-for-pcatools"><span class="header-section-number">H.4.1</span> Data wrangling for PCAtools</a></li>
  <li><a href="#pairs-plot" id="toc-pairs-plot" class="nav-link" data-scroll-target="#pairs-plot"><span class="header-section-number">H.4.2</span> Pairs plot</a></li>
  <li><a href="#bi-plots" id="toc-bi-plots" class="nav-link" data-scroll-target="#bi-plots"><span class="header-section-number">H.4.3</span> Bi-plots</a></li>
  </ul>
</li>
  <li><a href="#feature-contributions-loadings-on-each-component" id="toc-feature-contributions-loadings-on-each-component" class="nav-link" data-scroll-target="#feature-contributions-loadings-on-each-component"><span class="header-section-number">H.5</span> Feature contributions (loadings) on each component</a></li>
  <li><a href="#graphs-of-features-of-that-contribute-most-to-each-componentdimension" id="toc-graphs-of-features-of-that-contribute-most-to-each-componentdimension" class="nav-link" data-scroll-target="#graphs-of-features-of-that-contribute-most-to-each-componentdimension"><span class="header-section-number">H.6</span> Graphs of features of that contribute most to each component/dimension</a></li>
  <li><a href="#exploring-feature-contributions-in-terms-of-normalised-frequencies" id="toc-exploring-feature-contributions-in-terms-of-normalised-frequencies" class="nav-link" data-scroll-target="#exploring-feature-contributions-in-terms-of-normalised-frequencies"><span class="header-section-number">H.7</span> Exploring feature contributions in terms of normalised frequencies</a></li>
  <li><a href="#exploring-the-dimensions-of-the-model" id="toc-exploring-the-dimensions-of-the-model" class="nav-link" data-scroll-target="#exploring-the-dimensions-of-the-model"><span class="header-section-number">H.8</span> Exploring the dimensions of the model</a></li>
  <li><a href="#raincloud-plots-visualising-dimension-scores" id="toc-raincloud-plots-visualising-dimension-scores" class="nav-link" data-scroll-target="#raincloud-plots-visualising-dimension-scores"><span class="header-section-number">H.9</span> Raincloud plots visualising dimension scores</a></li>
  <li>
<a href="#computing-mixed-effects-models-of-the-dimension-scores" id="toc-computing-mixed-effects-models-of-the-dimension-scores" class="nav-link" data-scroll-target="#computing-mixed-effects-models-of-the-dimension-scores"><span class="header-section-number">H.10</span> Computing mixed-effects models of the dimension scores</a>
  <ul class="collapse">
<li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">H.10.1</span> Data preparation</a></li>
  <li><a href="#dimension-1-spontaneous-interactional-vs.-edited-informational" id="toc-dimension-1-spontaneous-interactional-vs.-edited-informational" class="nav-link" data-scroll-target="#dimension-1-spontaneous-interactional-vs.-edited-informational"><span class="header-section-number">H.10.2</span> Dimension 1: ‘Spontaneous interactional vs.&nbsp;Edited informational’</a></li>
  <li><a href="#dimension-2-narrative-vs.-non-narrative" id="toc-dimension-2-narrative-vs.-non-narrative" class="nav-link" data-scroll-target="#dimension-2-narrative-vs.-non-narrative"><span class="header-section-number">H.10.3</span> Dimension 2: ‘Narrative vs.&nbsp;Non-narrative’</a></li>
  <li><a href="#dimension-3-pedagogically-adapted-vs.-natural" id="toc-dimension-3-pedagogically-adapted-vs.-natural" class="nav-link" data-scroll-target="#dimension-3-pedagogically-adapted-vs.-natural"><span class="header-section-number">H.10.4</span> Dimension 3: ‘Pedagogically adapted vs.&nbsp;Natural’</a></li>
  <li><a href="#dimension-4-factual-vs.-speculative-simple-vs.-complex-verb-forms" id="toc-dimension-4-factual-vs.-speculative-simple-vs.-complex-verb-forms" class="nav-link" data-scroll-target="#dimension-4-factual-vs.-speculative-simple-vs.-complex-verb-forms"><span class="header-section-number">H.10.5</span> Dimension 4: ‘Factual vs.&nbsp;Speculative’ / ‘Simple vs.&nbsp;complex verb forms’?</a></li>
  <li><a href="#testing-model-assumptions" id="toc-testing-model-assumptions" class="nav-link" data-scroll-target="#testing-model-assumptions"><span class="header-section-number">H.10.6</span> Testing model assumptions</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./AppendixA.html">Appendices</a></li><li class="breadcrumb-item"><a href="./AppendixH.html"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Appendix H — Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>This script documents the analysis of data from the TEC and reference corpus data (as pre-processed in Appendix F) to arrive at the multi-dimensional model of Textbook Englisch vs.&nbsp;‘real-world’ English described in Chapter 7. It generates all of the statistics and plots included in the book, as well as many others that were used in the analysis, but were not included in the book for reasons of space.</p>
<section id="packages-required" class="level2" data-number="H.1"><h2 data-number="H.1" class="anchored" data-anchor-id="packages-required">
<span class="header-section-number">H.1</span> Packages required</h2>
<p>The following packages must be installed and loaded to process the data.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original thesis.</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span> <span class="co"># For its confusion matrix function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co"># For its plot themes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span> <span class="co"># For 95% CI</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span> <span class="co"># For the emmeans function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span> <span class="co"># For circular graphs of variables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary">gtsummary</a></span><span class="op">)</span> <span class="co"># For nice table of summary statistics (optional)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span> <span class="co"># For Fig. 35</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span> <span class="co"># For dynamic file paths</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span> <span class="co"># For theme of factoextra plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span> <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co"># For linear regression modelling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span> <span class="co"># To create figures with more than one plot</span></span>
<span><span class="co">#library(pca3d) # For 3-D plots (not rendered in exports)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kevinblighe/PCAtools">PCAtools</a></span><span class="op">)</span> <span class="co"># For nice biplots of PCA results</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span> <span class="co"># For various useful stats function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co"># For model plots and tables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># For data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbreheny.github.io/visreg">visreg</a></span><span class="op">)</span> <span class="co"># For plots of interaction effects</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R_rainclouds.R"</span><span class="op">)</span><span class="op">)</span> <span class="co"># For geom_flat_violin rainplots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="conducting-the-pca" class="level2" data-number="H.2"><h2 data-number="H.2" class="anchored" data-anchor-id="conducting-the-pca">
<span class="header-section-number">H.2</span> Conducting the PCA</h2>
<p>We first import the full dataset (see Appendix F for data preparation steps).</p>
<p>The following chunks can be used to perform the MDA on various subsets of the data (see also Section 10.1.1 in the book).</p>
<ol type="i">
<li>Subset of the data that excludes the lower-level textbooks:</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"processed_data"</span>, <span class="st">"dataforPCA.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Level</span> <span class="op">!=</span><span class="st">"A"</span> <span class="op">&amp;</span> <span class="va">Level</span> <span class="op">!=</span> <span class="st">"B"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Level</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="i">
<li>Subset of the data that includes only one <code>Country</code>` subcorpus of the TEC (note that a detailed analysis of the German subcorpus can be found in <span class="citation" data-cites="lefoll">(<a href="references.html#ref-lefoll" role="doc-biblioref">Le Foll</a>)</span>):</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"processed_data"</span>, <span class="st">"dataforPCA.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">#filter(Country != "France" &amp; Country != "Germany") |&gt; # Spain only</span></span>
<span>  <span class="co">#filter(Country != "France" &amp; Country != "Spain") |&gt; # Germany only</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">!=</span> <span class="st">"Spain"</span> <span class="op">&amp;</span> <span class="va">Country</span> <span class="op">!=</span> <span class="st">"Germany"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># France only</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Country</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="i">
<li>Random subsets of the data to test the stability of the model proposed in Chapter 7. Re-running this line will generate a new subset of 2/3 of the texts randomly sampled. <code>set.seed(13)</code> was used for the analyses reported on in Section 10.1.1.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span> </span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"processed_data"</span>, <span class="st">"dataforPCA.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4980</span><span class="op">*</span><span class="fl">0.6</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">Filename</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#Using the set.seed(13), these should be:</span></span>
<span><span class="co">#[1] HT_4_Spoken_0009.txt                       </span></span>
<span><span class="co">#[2] Solutions_Intermediate_Plus_Spoken_0020.txt</span></span>
<span><span class="co">#[3] 141_PRATCHETT1992DW13GODS_4.txt            </span></span>
<span><span class="co">#[4] Achievers_B2_Informative_0004.txt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="plotting-pca-results" class="level2" data-number="H.3"><h2 data-number="H.3" class="anchored" data-anchor-id="plotting-pca-results">
<span class="header-section-number">H.3</span> Plotting PCA results</h2>
<section id="d-plots" class="level3" data-number="H.3.1"><h3 data-number="H.3.1" class="anchored" data-anchor-id="d-plots">
<span class="header-section-number">H.3.1</span> 3D plots</h3>
<p>The following chunk can be used to create projections of TEC texts on three dimensions of the model. These plots cannot be rendered in two dimensions and are therefore not generated in the present document. For more information on the <code>pca3d</code> library, see: <a href="https://cran.r-project.org/web/packages/pca3d/vignettes/pca3d.pdf" class="uri">https://cran.r-project.org/web/packages/pca3d/vignettes/pca3d.pdf</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data preparation for 3D plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="co"># Checking that the features start at the 9th column</span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, scale.<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># All quantitative variables that contribute to the model</span></span>
<span><span class="va">register</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="st">"Register"</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="va">corpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="st">"Corpus"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">subcorpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="st">"Subcorpus"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pca3d</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pca3d</span><span class="op">(</span><span class="va">pca</span>, group <span class="op">=</span> <span class="va">subcorpus</span>,</span>
<span>       components <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>       components <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>       show.plane<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>       col <span class="op">=</span> <span class="va">col6</span>,</span>
<span>       shape <span class="op">=</span> <span class="va">shapes6</span>,</span>
<span>       radius <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>       legend <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">snapshotPCA3d</span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"plots"</span>, <span class="st">"PCA_TxB_3Ref_3Dsnapshot.png"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternative visualisation, looking at all three Textbook English registers in one colour</span></span>
<span></span>
<span><span class="fu">pca3d</span><span class="op">(</span><span class="va">pca</span>, group <span class="op">=</span> <span class="va">corpus</span>, </span>
<span>      show.plane<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>      components <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>      col <span class="op">=</span> <span class="va">col4</span>,</span>
<span>      shape <span class="op">=</span> <span class="va">shapes4</span>,</span>
<span>      radius <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>      legend <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="two-dimensional-plots-biplots" class="level2" data-number="H.4"><h2 data-number="H.4" class="anchored" data-anchor-id="two-dimensional-plots-biplots">
<span class="header-section-number">H.4</span> Two-dimensional plots (biplots)</h2>
<p>These plots were generated using the <code>PCAtools</code> package, which requires the data to be formatted in a rather unconventional way so it needs to wrangled first.</p>
<section id="data-wrangling-for-pcatools" class="level3" data-number="H.4.1"><h3 data-number="H.4.1" class="anchored" data-anchor-id="data-wrangling-for-pcatools">
<span class="header-section-number">H.4.1</span> Data wrangling for PCAtools</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data wrangling</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Source <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">Corpus</span>, Textbook.English <span class="op">=</span> <span class="st">"Textbook English (TEC)"</span>, Informative.Teens <span class="op">=</span> <span class="st">"Reference corpora"</span>, Spoken.BNC2014 <span class="op">=</span> <span class="st">"Reference corpora"</span>, Youth.Fiction <span class="op">=</span> <span class="st">"Reference corpora"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Corpus <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">Subcorpus</span>, <span class="st">"Info Teens Ref."</span>, after <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">Source</span>, .after <span class="op">=</span> <span class="st">"Corpus"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># colnames(data2)</span></span>
<span><span class="va">data2meta</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data2meta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data2meta</span><span class="op">$</span><span class="va">Filename</span></span>
<span><span class="va">data2meta</span> <span class="op">&lt;-</span> <span class="va">data2meta</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Filename</span><span class="op">)</span></span>
<span><span class="co"># head(data2meta)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">Filename</span></span>
<span><span class="va">data2num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">data2</span><span class="op">[</span>,<span class="fl">10</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># data2num[1:5,1:5] # Check data frame format is correct by comparing to output of head(data2meta) above</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/pca.html">pca</a></span><span class="op">(</span><span class="va">data2num</span>, </span>
<span>         metadata <span class="op">=</span> <span class="va">data2meta</span>,</span>
<span>         scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The cumulative proportion of variance in the dataset explained the first four components explain 47.15%.</p>
</section><section id="pairs-plot" class="level3" data-number="H.4.2"><h3 data-number="H.4.2" class="anchored" data-anchor-id="pairs-plot">
<span class="header-section-number">H.4.2</span> Pairs plot</h3>
<p>This chunk produces a scatterplot matrix of combinations of the four dimensions of the model of Textbook English vs.&nbsp;‘real-world’ English. Note that the number before the comma on each axis label shows which principal component is plotted on that axis; this is followed by the percentage of the total variance explained by that particular component. The colours correspond to the text registers.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># For five TEC registers</span></span>
<span><span class="co"># colkey = c(`Spoken BNC2014 Ref.`="#BD241E", `Info Teens Ref.`="#15274D", `Youth Fiction Ref.`="#267226", `Textbook Fiction`="#A18A33", `Textbook Conversation`="#F9B921", `Textbook Informative` = "#722672", `Textbook Instructional` = "grey", `Textbook Personal` = "black")</span></span>
<span></span>
<span><span class="co"># For three TEC registers</span></span>
<span><span class="co"># summary(data2$Corpus)</span></span>
<span><span class="va">colkey</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`Spoken BNC2014 Ref.`<span class="op">=</span><span class="st">"#BD241E"</span>, `Info Teens Ref.`<span class="op">=</span><span class="st">"#15274D"</span>, `Youth Fiction Ref.`<span class="op">=</span><span class="st">"#267226"</span>, `Textbook Fiction`<span class="op">=</span><span class="st">"#A18A33"</span>, `Textbook Conversation`<span class="op">=</span><span class="st">"#F9B921"</span>, `Textbook Informative` <span class="op">=</span> <span class="st">"#722672"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#summary(data2$Source)</span></span>
<span><span class="co">#shapekey = c(`Textbook English (TEC)`=6, `Reference corpora`=1)</span></span>
<span></span>
<span><span class="co"># summary(data2$Level)</span></span>
<span><span class="va">shapekey</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A<span class="op">=</span><span class="fl">1</span>, B<span class="op">=</span><span class="fl">2</span>, C<span class="op">=</span><span class="fl">6</span>, D<span class="op">=</span><span class="fl">0</span>, E<span class="op">=</span><span class="fl">5</span>, `Ref.`<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Warning: this can be very slow! Open in extra zoomed out window!</span></span>
<span></span>
<span><span class="co">#png(here("plots", "PCA_3Ref_pairsplot.png"), width = 12, height= 19, units = "cm", res = 300)</span></span>
<span><span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/pairsplot.html">pairsplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 triangle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 components <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>                 ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekey</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Corpus"</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                 margingaps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkey</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/PCAtools-pairsplots-TxB-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="AppendixH_files/figure-html/PCAtools-pairsplots-TxB-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#dev.off()</span></span>
<span><span class="co">#ggsave(here("plots", "PCA_TxB_pairsplot.svg"), width = 6, height = 10)</span></span>
<span><span class="co"># Note that the legend has to be added manually (it was taken from the biplot code below).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="bi-plots" class="level3" data-number="H.4.3"><h3 data-number="H.4.3" class="anchored" data-anchor-id="bi-plots">
<span class="header-section-number">H.4.3</span> Bi-plots</h3>
<p>Biplots are used to more closely examine the position of texts on just two dimensions.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># These settings (with legendPosition = "top") were used to generate the legend for the scatterplot matrix above:</span></span>
<span><span class="co">#png(here("plots", "PCA_3Ref_Biplot_PC1_PC2test.png"), width = 40, height= 25, units = "cm", res = 300) </span></span>
<span></span>
<span><span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC1"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC2"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Corpus"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkey</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekey</span>,</span>
<span>                 xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC1"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC1"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC2"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC2"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 axisLabSize <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">14</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/PCAtools-biplots-TxB-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="AppendixH_files/figure-html/PCAtools-biplots-TxB-1.png" class="img-fluid figure-img" width="1248"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "PCA_Ref3TxB_BiplotPC1_PC2.svg"), width = 12, height = 8)</span></span>
<span></span>
<span><span class="co"># Biplots to examine components more carefully</span></span>
<span><span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC3"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC4"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Corpus"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkey</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekey</span>,</span>
<span>                 xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC3"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC3"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC4"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC4"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 axisLabSize <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">14</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/PCAtools-biplots-TxB-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="AppendixH_files/figure-html/PCAtools-biplots-TxB-2.png" class="img-fluid figure-img" width="1248"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "PCA_Ref3TxB_BiplotPC3_PC4.svg"), width = 12, height = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The colours and corresponding ellipses can be used to visualise different clusters and patterns. In the following, we change the colour of the points and the ellipses to represent the texts’ target proficiency levels instead of the register, allowing for a different interpretation of the model.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Biplot with ellipses for Level rather than Register</span></span>
<span><span class="va">colkeyLevels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A<span class="op">=</span><span class="st">"#F9B921"</span>, B<span class="op">=</span><span class="st">"#A18A33"</span>, C<span class="op">=</span><span class="st">"#BD241E"</span>, D<span class="op">=</span><span class="st">"#722672"</span>, E<span class="op">=</span><span class="st">"#15274D"</span>, `Ref. data`<span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span></span>
<span><span class="va">shapekeyLevels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`Spoken BNC2014 Ref.`<span class="op">=</span><span class="fl">16</span>, `Info Teens Ref.`<span class="op">=</span><span class="fl">17</span>, `Youth Fiction Ref.`<span class="op">=</span><span class="fl">15</span>, `Textbook Fiction`<span class="op">=</span><span class="fl">0</span>, `Textbook Conversation`<span class="op">=</span><span class="fl">1</span>, `Textbook Informative`<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC3"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC4"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkeyLevels</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Corpus"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekeyLevels</span>,</span>
<span>                 xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC3"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC3"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC4"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">rotated</span><span class="op">[</span>, <span class="st">"PC4"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 axisLabSize <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">14</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/PCAtools-biplots-TxB-Levels-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="AppendixH_files/figure-html/PCAtools-biplots-TxB-Levels-1.png" class="img-fluid figure-img" width="1248"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "PCA_Ref3TxB_BiplotPC3_PC4_levels.svg"), width = 12, height = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="feature-contributions-loadings-on-each-component" class="level2" data-number="H.5"><h2 data-number="H.5" class="anchored" data-anchor-id="feature-contributions-loadings-on-each-component">
<span class="header-section-number">H.5</span> Feature contributions (loadings) on each component</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#data &lt;- readRDS(here("processed_data", "dataforPCA.rds")) </span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, scale.<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># All quantitative variables to be included in the model</span></span>
<span></span>
<span><span class="co"># The rotated data that represents the observations / samples is stored in rotated, while the variable loadings are stored in loadings</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table of loadings with no minimum threshold applied</span></span>
<span><span class="va">loadings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
<th style="text-align: right;">PC4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ACT</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">AMP</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ASPECT</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">AWL</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BEMA</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">CAUSE</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CC</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">COMM</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CONC</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">COND</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CONT</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">CUZ</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">-0.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DEMO</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">DMA</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DOAUX</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">DT</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DWNT</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">ELAB</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EMPH</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">EX</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EXIST</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">FPP1P</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FPP1S</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">FPUH</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GTO</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">HDG</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HGOT</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">IN</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JJAT</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">JJPR</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LD</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">MDCA</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MDCO</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">MDMM</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MDNE</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">0.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">MDWO</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MDWS</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">MENTAL</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NCOMP</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">NN</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OCCUR</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">PASS</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PEAS</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIT</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PLACE</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLITE</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POS</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">PROG</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QUAN</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">QUPR</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QUTAG</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">RB</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RP</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPLIT</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPP2</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">STPR</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">THATD</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">THRC</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">THSC</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">TTR</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VBD</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">VBG</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VBN</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">VIMP</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WHQU</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">WHSC</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XX0</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">YNQU</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TPP3</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">FQTI</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.14</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#clipr::write_last_clip()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="graphs-of-features-of-that-contribute-most-to-each-componentdimension" class="level2" data-number="H.6"><h2 data-number="H.6" class="anchored" data-anchor-id="graphs-of-features-of-that-contribute-most-to-each-componentdimension">
<span class="header-section-number">H.6</span> Graphs of features of that contribute most to each component/dimension</h2>
<p>Graphs of features display the features with the strongest contributions to any two dimensions of the model of intra-textbook variation. They are created using the <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">factoextra::fviz_pca_var</a></code> function.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">pca</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>             select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>contrib <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>             col.var <span class="op">=</span> <span class="st">"contrib"</span>, <span class="co"># Colour by contributions to the PC</span></span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#DB241E"</span>, <span class="st">"#722672"</span><span class="op">)</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Try to avoid too much text overlapping</span></span>
<span>             ggtheme <span class="op">=</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/graphs-of-variables-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="AppendixH_files/figure-html/graphs-of-variables-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "fviz_pca_var_PC1_PC2_Ref3Reg.svg"), width = 9, height = 7)</span></span>
<span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">pca</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>             select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>contrib <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>             col.var <span class="op">=</span> <span class="st">"contrib"</span>, <span class="co"># Colour by contributions to the PC</span></span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#DB241E"</span>, <span class="st">"#722672"</span><span class="op">)</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Try to avoid too much text overlapping</span></span>
<span>             ggtheme <span class="op">=</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/graphs-of-variables-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="AppendixH_files/figure-html/graphs-of-variables-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "fviz_pca_var_PC3_PC2_Ref3Reg.svg"), width = 9, height = 8)</span></span>
<span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">pca</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>             select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>contrib <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>             col.var <span class="op">=</span> <span class="st">"contrib"</span>, <span class="co"># Colour by contributions to the PC</span></span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#DB241E"</span>, <span class="st">"#722672"</span><span class="op">)</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Try to avoid too much text overlapping</span></span>
<span>             ggtheme <span class="op">=</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/graphs-of-variables-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="AppendixH_files/figure-html/graphs-of-variables-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "fviz_pca_var_PC3_PC4_Ref3Reg.svg"), width = 9, height = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="exploring-feature-contributions-in-terms-of-normalised-frequencies" class="level2" data-number="H.7"><h2 data-number="H.7" class="anchored" data-anchor-id="exploring-feature-contributions-in-terms-of-normalised-frequencies">
<span class="header-section-number">H.7</span> Exploring feature contributions in terms of normalised frequencies</h2>
<p>We can go back to the normalised frequencies of the individual features to compare them across different registers and levels, e.g.,:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ncounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"ncounts3_3Reg.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ncounts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Register</span><span class="op">==</span><span class="st">"Informative"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">#filter(Level %in% c("C", "D", "E")) |&gt; </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Level</span>, <span class="va">VBD</span>, <span class="va">PEAS</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Level</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Level</th>
<th style="text-align: right;">VBD</th>
<th style="text-align: right;">PEAS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">28.11</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">34.11</td>
<td style="text-align: right;">2.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">35.21</td>
<td style="text-align: right;">5.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">39.83</td>
<td style="text-align: right;">7.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">35.17</td>
<td style="text-align: right;">6.91</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ref.</td>
<td style="text-align: right;">39.73</td>
<td style="text-align: right;">4.94</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The following chunk produces Figure 35 which shows normalised counts of selected features with salient loadings on PC1 in the Textbook Informative subcorpus (Levels A to E) and the reference Info Teens corpus (Ref.). This plots visualises the observed normalised frequencies as they were extracted using the MFTE Perl (see Appendices C and F).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#A18A33"</span>, <span class="st">"#BD241E"</span>, <span class="st">"#722672"</span>, <span class="st">"#15274D"</span>, <span class="st">"darkgrey"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">boxfeature</span> <span class="op">&lt;-</span> <span class="va">ncounts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Register</span><span class="op">==</span><span class="st">"Informative"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">#filter(Level %in% c("C", "D", "E")) |&gt; </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Level</span>, <span class="va">FPP1S</span>, <span class="va">SPP2</span>, <span class="va">CONT</span>, <span class="va">EXIST</span>, <span class="va">AWL</span>, <span class="va">XX0</span>, <span class="va">PASS</span>, <span class="va">VBN</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Level</span>, y <span class="op">=</span> <span class="va">CONT</span>, colour <span class="op">=</span> <span class="va">Level</span>, fill <span class="op">=</span> <span class="va">Level</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.7</span>, alpha<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span>, fatten <span class="op">=</span> <span class="fl">2</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cols</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CONT</span> <span class="op">=</span> <span class="va">boxfeature</span></span>
<span><span class="va">SPP2</span> <span class="op">&lt;-</span> <span class="va">boxfeature</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">SPP2</span><span class="op">)</span> </span>
<span><span class="va">EXIST</span> <span class="op">&lt;-</span> <span class="va">boxfeature</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">EXIST</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="co"># These y-axis limits remove individual outliers that overextend the scales and make the existing differences invisible to the naked eye. They can be removed to visualise all data points.</span></span>
<span><span class="va">FFP1</span> <span class="op">&lt;-</span> <span class="va">boxfeature</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">FPP1S</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">AWL</span> <span class="op">&lt;-</span> <span class="va">boxfeature</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">AWL</span><span class="op">)</span></span>
<span><span class="va">XX0</span> <span class="op">&lt;-</span> <span class="va">boxfeature</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">XX0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PASS</span> <span class="op">&lt;-</span> <span class="va">boxfeature</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">PASS</span><span class="op">)</span></span>
<span><span class="va">VBN</span> <span class="op">&lt;-</span> <span class="va">boxfeature</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">VBN</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">boxplots</span> <span class="op">&lt;-</span> <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">PASS</span>, <span class="va">VBN</span>, <span class="va">AWL</span>, <span class="va">EXIST</span>, <span class="va">FFP1</span>, <span class="va">SPP2</span>, <span class="va">CONT</span>, <span class="va">XX0</span>, ncol<span class="op">=</span><span class="fl">2</span>, nrow<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/boxplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="AppendixH_files/figure-html/boxplots-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "BoxplotsInformativeFeatures.svg"), plot = boxplots, dpi = 300, width = 9, height = 11)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="exploring-the-dimensions-of-the-model" class="level2" data-number="H.8"><h2 data-number="H.8" class="anchored" data-anchor-id="exploring-the-dimensions-of-the-model">
<span class="header-section-number">H.8</span> Exploring the dimensions of the model</h2>
<p>We begin with some descriptive statistics of the dimension scores.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#data &lt;- readRDS(here("data", "processed", "dataforPCA.rds")) </span></span>
<span><span class="co">#colnames(data)</span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, scale.<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># All quantitative variables</span></span>
<span></span>
<span><span class="co">## Access to the PCA results</span></span>
<span><span class="co">#colnames(data)</span></span>
<span><span class="va">res.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary statistics</span></span>
<span><span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Subcorpus</span>, <span class="va">Level</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Subcorpus</th>
<th style="text-align: left;">Level</th>
<th style="text-align: right;">Words_mean</th>
<th style="text-align: right;">PC1_mean</th>
<th style="text-align: right;">PC2_mean</th>
<th style="text-align: right;">PC3_mean</th>
<th style="text-align: right;">PC4_mean</th>
<th style="text-align: right;">Words_sd</th>
<th style="text-align: right;">PC1_sd</th>
<th style="text-align: right;">PC2_sd</th>
<th style="text-align: right;">PC3_sd</th>
<th style="text-align: right;">PC4_sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">813.02</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">-1.02</td>
<td style="text-align: right;">3.49</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">154.57</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.73</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">819.48</td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">-0.64</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">218.88</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">823.69</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">279.14</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">797.85</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">187.98</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">0.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">1132.79</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">569.85</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">886.00</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">242.78</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">864.16</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">222.44</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">854.21</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">198.21</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">801.78</td>
<td style="text-align: right;">-0.84</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">196.33</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.59</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">853.26</td>
<td style="text-align: right;">-0.65</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">195.97</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">851.71</td>
<td style="text-align: right;">-1.46</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">-0.70</td>
<td style="text-align: right;">199.77</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.85</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">844.03</td>
<td style="text-align: right;">-1.63</td>
<td style="text-align: right;">-0.50</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">182.83</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">1.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">838.90</td>
<td style="text-align: right;">-1.87</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">160.21</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">1.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">847.65</td>
<td style="text-align: right;">-2.24</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">179.25</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.83</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">823.23</td>
<td style="text-align: right;">-2.57</td>
<td style="text-align: right;">-0.66</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">180.39</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spoken BNC2014 Ref.</td>
<td style="text-align: left;">Ref.</td>
<td style="text-align: right;">10637.74</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">-0.52</td>
<td style="text-align: right;">-0.64</td>
<td style="text-align: right;">-0.53</td>
<td style="text-align: right;">8974.14</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Youth Fiction Ref.</td>
<td style="text-align: left;">Ref.</td>
<td style="text-align: right;">5944.78</td>
<td style="text-align: right;">-0.49</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">198.64</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">Info Teens Ref.</td>
<td style="text-align: left;">Ref.</td>
<td style="text-align: right;">805.41</td>
<td style="text-align: right;">-3.06</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">193.31</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">1.19</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res.ind</span> <span class="op">&lt;-</span> <span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Subsubcorpus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Corpus</span>, <span class="va">Register</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Subsubcorpus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Subsubcorpus</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">PC1</span>, <span class="va">PC2</span>, <span class="va">PC3</span>, <span class="va">PC4</span>, <span class="va">Subsubcorpus</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html">tbl_summary</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">Subsubcorpus</span>,</span>
<span>              digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html">all_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              statistic <span class="op">=</span> <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html">all_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span>  <span class="st">"{mean} ({sd})"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<div id="rhrcbhukny" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rhrcbhukny table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rhrcbhukny thead, #rhrcbhukny tbody, #rhrcbhukny tfoot, #rhrcbhukny tr, #rhrcbhukny td, #rhrcbhukny th {
  border-style: none;
}

#rhrcbhukny p {
  margin: 0;
  padding: 0;
}

#rhrcbhukny .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rhrcbhukny .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rhrcbhukny .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rhrcbhukny .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rhrcbhukny .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rhrcbhukny .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rhrcbhukny .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rhrcbhukny .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rhrcbhukny .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rhrcbhukny .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rhrcbhukny .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rhrcbhukny .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rhrcbhukny .gt_spanner_row {
  border-bottom-style: hidden;
}

#rhrcbhukny .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rhrcbhukny .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rhrcbhukny .gt_from_md > :first-child {
  margin-top: 0;
}

#rhrcbhukny .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rhrcbhukny .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rhrcbhukny .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rhrcbhukny .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rhrcbhukny .gt_row_group_first td {
  border-top-width: 2px;
}

#rhrcbhukny .gt_row_group_first th {
  border-top-width: 2px;
}

#rhrcbhukny .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhrcbhukny .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rhrcbhukny .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rhrcbhukny .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rhrcbhukny .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhrcbhukny .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rhrcbhukny .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rhrcbhukny .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rhrcbhukny .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rhrcbhukny .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rhrcbhukny .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhrcbhukny .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rhrcbhukny .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhrcbhukny .gt_left {
  text-align: left;
}

#rhrcbhukny .gt_center {
  text-align: center;
}

#rhrcbhukny .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rhrcbhukny .gt_font_normal {
  font-weight: normal;
}

#rhrcbhukny .gt_font_bold {
  font-weight: bold;
}

#rhrcbhukny .gt_font_italic {
  font-style: italic;
}

#rhrcbhukny .gt_super {
  font-size: 65%;
}

#rhrcbhukny .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rhrcbhukny .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rhrcbhukny .gt_indent_1 {
  text-indent: 5px;
}

#rhrcbhukny .gt_indent_2 {
  text-indent: 10px;
}

#rhrcbhukny .gt_indent_3 {
  text-indent: 15px;
}

#rhrcbhukny .gt_indent_4 {
  text-indent: 20px;
}

#rhrcbhukny .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="<strong>Characteristic</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="<strong>Informative.Teens_Informative</strong>, N = 1,337<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>Informative.Teens_Informative</strong>, N = 1,337<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>Spoken.BNC2014_Conversation</strong>, N = 1,250<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>Spoken.BNC2014_Conversation</strong>, N = 1,250<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>Textbook.English_Conversation</strong>, N = 565<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>Textbook.English_Conversation</strong>, N = 565<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>Textbook.English_Fiction</strong>, N = 285<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>Textbook.English_Fiction</strong>, N = 285<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>Textbook.English_Informative</strong>, N = 352<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>Textbook.English_Informative</strong>, N = 352<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>Youth.Fiction_Fiction</strong>, N = 1,191<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>Youth.Fiction_Fiction</strong>, N = 1,191<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">PC1</td>
<td class="gt_row gt_center" headers="stat_1">-3.06 (1.09)</td>
<td class="gt_row gt_center" headers="stat_2">3.71 (0.49)</td>
<td class="gt_row gt_center" headers="stat_3">1.56 (1.25)</td>
<td class="gt_row gt_center" headers="stat_4">-0.43 (1.05)</td>
<td class="gt_row gt_center" headers="stat_5">-2.05 (1.04)</td>
<td class="gt_row gt_center" headers="stat_6">-0.49 (0.90)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">PC2</td>
<td class="gt_row gt_center" headers="stat_1">-0.96 (1.19)</td>
<td class="gt_row gt_center" headers="stat_2">-0.52 (0.47)</td>
<td class="gt_row gt_center" headers="stat_3">-0.57 (0.74)</td>
<td class="gt_row gt_center" headers="stat_4">1.25 (0.84)</td>
<td class="gt_row gt_center" headers="stat_5">-0.52 (0.96)</td>
<td class="gt_row gt_center" headers="stat_6">1.75 (0.52)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">PC3</td>
<td class="gt_row gt_center" headers="stat_1">-0.23 (0.88)</td>
<td class="gt_row gt_center" headers="stat_2">-0.64 (0.76)</td>
<td class="gt_row gt_center" headers="stat_3">1.71 (1.43)</td>
<td class="gt_row gt_center" headers="stat_4">0.96 (1.22)</td>
<td class="gt_row gt_center" headers="stat_5">0.31 (1.10)</td>
<td class="gt_row gt_center" headers="stat_6">-0.21 (0.88)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">PC4</td>
<td class="gt_row gt_center" headers="stat_1">-0.15 (1.19)</td>
<td class="gt_row gt_center" headers="stat_2">-0.53 (0.52)</td>
<td class="gt_row gt_center" headers="stat_3">0.61 (0.86)</td>
<td class="gt_row gt_center" headers="stat_4">0.02 (0.64)</td>
<td class="gt_row gt_center" headers="stat_5">0.05 (0.98)</td>
<td class="gt_row gt_center" headers="stat_6">0.41 (0.52)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="odd">
<td colspan="7" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean (SD)</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Register</span>, <span class="va">Level</span>, <span class="va">PC4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Register</span>, <span class="va">Level</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Median <span class="op">=</span> <span class="va">median</span>, MAD <span class="op">=</span> <span class="va">mad</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Register</th>
<th style="text-align: left;">Level</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">0.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">Ref.</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">-0.39</td>
<td style="text-align: right;">0.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">Ref.</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">1.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">1.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">Ref.</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">1.21</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The following chunk can be used to search for example texts that are located in specific areas of the biplots. For example, we can search for texts that have high scores on Dim3 and low ones on Dim2 to proceed with a qualitative comparison and analysis of these texts.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Search for example texts to illustrate results</span></span>
<span><span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">PC3</span> <span class="op">&gt;</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">PC2</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">#filter(Register=="Conversation") |&gt; </span></span>
<span>  <span class="co">#filter(Level == "B") |&gt; </span></span>
<span>  <span class="co">#filter(PC1 &gt; 4.7) |&gt; </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Filename</span>, <span class="va">PC1</span>, <span class="va">PC2</span>, <span class="va">PC3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Filename</th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NGL_1_Spoken_0002.txt</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">-2.27</td>
<td style="text-align: right;">4.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">HT_5_ELF_Spoken_0003.txt</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">-2.30</td>
<td style="text-align: right;">3.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HT_6_Informative_0001.txt</td>
<td style="text-align: right;">-2.19</td>
<td style="text-align: right;">-2.36</td>
<td style="text-align: right;">3.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10383721_typesofrobots.txt</td>
<td style="text-align: right;">-3.09</td>
<td style="text-align: right;">-2.62</td>
<td style="text-align: right;">2.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">History_Kids_BBC_10402894_go_furthers.txt</td>
<td style="text-align: right;">-4.26</td>
<td style="text-align: right;">-2.07</td>
<td style="text-align: right;">2.08</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="raincloud-plots-visualising-dimension-scores" class="level2" data-number="H.9"><h2 data-number="H.9" class="anchored" data-anchor-id="raincloud-plots-visualising-dimension-scores">
<span class="header-section-number">H.9</span> Raincloud plots visualising dimension scores</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res.ind</span><span class="op">$</span><span class="va">Subcorpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">res.ind</span><span class="op">$</span><span class="va">Subcorpus</span>, <span class="st">"Spoken BNC2014 Ref."</span>, <span class="st">"Textbook Conversation"</span>, <span class="st">"Youth Fiction Ref."</span>, <span class="st">"Textbook Fiction"</span>, <span class="st">"Info Teens Ref."</span>, <span class="st">"Textbook Informative"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># colours &lt;- suf_palette(name = "london", n = 6, type = "continuous")</span></span>
<span><span class="co"># colours2 &lt;- suf_palette(name = "classic", n = 5, type = "continuous")</span></span>
<span><span class="co"># colours &lt;- c(colours, colours2[c(2:4)]) # Nine colours range</span></span>
<span><span class="co"># palette &lt;- colours[c(1,5,6,2,3,8,7,4,9)] # Good order for PCA</span></span>
<span><span class="co"># colours &lt;- palette[c(1,8,9,2,7,3)]</span></span>
<span></span>
<span><span class="co"># This translates as:</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#BD241E"</span>, <span class="st">"#A18A33"</span>, <span class="st">"#15274D"</span>, <span class="st">"#D54E1E"</span>, <span class="st">"#EA7E1E"</span>, <span class="st">"#4C4C4C"</span>, <span class="st">"#722672"</span>, <span class="st">"#F9B921"</span>, <span class="st">"#267226"</span><span class="op">)</span></span>
<span><span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#BD241E"</span>, <span class="st">"#F9B921"</span>, <span class="st">"#267226"</span>, <span class="st">"#A18A33"</span>, <span class="st">"#722672"</span>,<span class="st">"#15274D"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res.ind</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Subcorpus</span>,y<span class="op">=</span><span class="va">PC1</span>, fill <span class="op">=</span> <span class="va">Subcorpus</span>, colour <span class="op">=</span> <span class="va">Subcorpus</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># Or leave out "colour = Register" to keep the dots in black</span></span>
<span>  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.25</span>, y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,adjust <span class="op">=</span> <span class="fl">2</span>, trim <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="co"># note that here we need to set the x-variable to a numeric variable and bump it to get the boxplots to line up with the rainclouds. </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Subcorpus</span><span class="op">)</span><span class="op">+</span><span class="fl">0.25</span>, y <span class="op">=</span> <span class="va">PC1</span><span class="op">)</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, width <span class="op">=</span> <span class="fl">.15</span>, colour <span class="op">=</span> <span class="st">"BLACK"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'PC1'</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, colour <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colours</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colours</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">7</span>, label <span class="op">=</span> <span class="st">"Conversation"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">0.7</span>, xend <span class="op">=</span> <span class="fl">2.5</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span>, yend <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">7</span>, label <span class="op">=</span> <span class="st">"Fiction"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">2.7</span>, xend <span class="op">=</span> <span class="fl">4.5</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span>, yend <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.7</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">7</span>, label <span class="op">=</span> <span class="st">"Informative"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">4.7</span>, xend <span class="op">=</span> <span class="fl">6.5</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span>, yend <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Reference"</span>, <span class="st">"Textbook"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html">dup_axis</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">6</span>, to <span class="op">=</span> <span class="fl">5</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/rainplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="AppendixH_files/figure-html/rainplots-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "PC1_3RegComparison.svg"), width = 13, height = 8)</span></span>
<span><span class="co">#ggsave(here("plots", "PC1_3RegComparison.png"), width = 20, height = 15, units = "cm", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="computing-mixed-effects-models-of-the-dimension-scores" class="level2" data-number="H.10"><h2 data-number="H.10" class="anchored" data-anchor-id="computing-mixed-effects-models-of-the-dimension-scores">
<span class="header-section-number">H.10</span> Computing mixed-effects models of the dimension scores</h2>
<section id="data-preparation" class="level3" data-number="H.10.1"><h3 data-number="H.10.1" class="anchored" data-anchor-id="data-preparation">
<span class="header-section-number">H.10.1</span> Data preparation</h3>
<p>In this chunk, we add a <code>Source</code> variable to be used as a random effect variable in the following mixed-effects models (see 5.3.8 for details).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res.ind</span> <span class="op">&lt;-</span> <span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Source <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>  <span class="va">Corpus</span><span class="op">==</span><span class="st">"Youth.Fiction"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Book"</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">Filename</span>, <span class="st">"[0-9]{1,3}"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>  <span class="va">Corpus</span><span class="op">==</span><span class="st">"Spoken.BNC2014"</span> <span class="op">~</span> <span class="st">"Spoken.BNC2014"</span>,</span>
<span>  <span class="va">Corpus</span><span class="op">==</span><span class="st">"Textbook.English"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">Series</span><span class="op">)</span>,</span>
<span>  <span class="va">Corpus</span><span class="op">==</span><span class="st">"Informative.Teens"</span> <span class="op">~</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">Filename</span>, <span class="st">"BBC|Science_Tech"</span><span class="op">)</span>,</span>
<span>  <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Source <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>  <span class="va">Corpus</span><span class="op">==</span><span class="st">"Informative.Teens"</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Source</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">Filename</span>, <span class="st">"_.*"</span><span class="op">)</span>,</span>
<span>  <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">Source</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Source</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Corpus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">Corpus</span><span class="op">==</span><span class="st">"Textbook.English"</span> <span class="op">~</span> <span class="st">"Textbook"</span>,</span>
<span>    <span class="va">Corpus</span><span class="op">==</span><span class="st">"Informative.Teens"</span> <span class="op">~</span> <span class="st">"Reference"</span>,</span>
<span>    <span class="va">Corpus</span><span class="op">==</span><span class="st">"Spoken.BNC2014"</span> <span class="op">~</span> <span class="st">"Reference"</span>,</span>
<span>    <span class="va">Corpus</span><span class="op">==</span><span class="st">"Youth.Fiction"</span> <span class="op">~</span> <span class="st">"Reference"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Corpus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Corpus</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change the reference levels to theoretically more meaningful levels and one that is better populated (see, e.g., https://stats.stackexchange.com/questions/430770/in-a-multilevel-linear-regression-how-does-the-reference-level-affect-other-lev)</span></span>
<span><span class="co"># summary(res.ind$Corpus)</span></span>
<span><span class="va">res.ind</span><span class="op">$</span><span class="va">Corpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">res.ind</span><span class="op">$</span><span class="va">Corpus</span>, <span class="st">"Reference"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary(res.ind$Subcorpus)</span></span>
<span><span class="va">res.ind</span><span class="op">$</span><span class="va">Subcorpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">res.ind</span><span class="op">$</span><span class="va">Subcorpus</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Spoken BNC2014 Ref."</span>, <span class="st">"Textbook Conversation"</span>, <span class="st">"Youth Fiction Ref."</span>, <span class="st">"Textbook Fiction"</span>, <span class="st">"Info Teens Ref."</span>, <span class="st">"Textbook Informative"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary(res.ind$Level)</span></span>
<span><span class="va">res.ind</span><span class="op">$</span><span class="va">Level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">res.ind</span><span class="op">$</span><span class="va">Level</span>, <span class="st">"Ref."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="dimension-1-spontaneous-interactional-vs.-edited-informational" class="level3" data-number="H.10.2"><h3 data-number="H.10.2" class="anchored" data-anchor-id="dimension-1-spontaneous-interactional-vs.-edited-informational">
<span class="header-section-number">H.10.2</span> Dimension 1: ‘Spontaneous interactional vs.&nbsp;Edited informational’</h3>
<p>We first compare various models and then present a tabular summary of the best-fitting one.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">md_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC1</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">Register</span><span class="op">|</span><span class="va">Source</span><span class="op">)</span>, <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="va">md_corpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_source</span>, <span class="va">.</span><span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">Level</span><span class="op">)</span> <span class="co"># Failed to converge</span></span>
<span><span class="va">md_register</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_source</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Register</span><span class="op">)</span></span>
<span><span class="va">md_both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_corpus</span>, <span class="va">.</span><span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">Register</span><span class="op">)</span></span>
<span><span class="va">md_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_both</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Level</span><span class="op">:</span><span class="va">Register</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">md_source</span>, <span class="va">md_corpus</span>, <span class="va">md_register</span>, <span class="va">md_both</span>, <span class="va">md_interaction</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: res.ind
Models:
md_source: PC1 ~ 1 + (Register | Source)
md_register: PC1 ~ (Register | Source) + Register
md_corpus: PC1 ~ (Register | Source) + Level
md_both: PC1 ~ (Register | Source) + Level + Register
md_interaction: PC1 ~ (Register | Source) + Level + Register + Level:Register
               npar   AIC   BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    
md_source         8 12421 12473 -6202.5    12405                          
md_register      10 12357 12422 -6168.4    12337  68.106  2  1.625e-15 ***
md_corpus        13 12181 12266 -6077.5    12155 181.996  3  &lt; 2.2e-16 ***
md_both          15 12117 12215 -6043.5    12087  67.843  2  1.854e-15 ***
md_interaction   25 12098 12261 -6024.0    12048  39.104 10  2.435e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">md_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC1</span> <span class="op">~</span> <span class="va">Level</span> <span class="op">+</span> <span class="va">Register</span> <span class="op">+</span> <span class="va">Level</span><span class="op">*</span><span class="va">Register</span> <span class="op">+</span> <span class="op">(</span><span class="va">Register</span><span class="op">|</span><span class="va">Source</span><span class="op">)</span>, <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md_interaction</span>, wrap.labels <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="co"># R2 = 0.870 / 0.923</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.46&nbsp;–&nbsp;4.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.06&nbsp;–&nbsp;-0.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.011</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.97&nbsp;–&nbsp;-0.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.015</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.40&nbsp;–&nbsp;-0.76</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.002</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.80&nbsp;–&nbsp;-1.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.06&nbsp;–&nbsp;-1.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-4.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-5.45&nbsp;–&nbsp;-2.95</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-6.75</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-8.03&nbsp;–&nbsp;-5.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.86&nbsp;–&nbsp;3.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.41&nbsp;–&nbsp;3.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.010</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.83&nbsp;–&nbsp;3.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.64&nbsp;–&nbsp;3.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.003</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.41</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.10&nbsp;–&nbsp;3.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.01&nbsp;–&nbsp;4.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.83&nbsp;–&nbsp;4.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.90&nbsp;–&nbsp;4.57</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.87&nbsp;–&nbsp;4.53</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.80&nbsp;–&nbsp;4.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.59</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.41</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub><sub>Source.RegisterFiction</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.12</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>11</sub><sub>Source.RegisterInformative</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.20</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ρ<sub>01</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">-0.05</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">-0.48</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.41</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">325</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">4980</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.870 / 0.923</td>
</tr>
</tbody></table>
</div>
</div>
<p>Its estimated coefficients are visualised in the plot below.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Tweak plot aesthetics with: https://cran.r-project.org/web/packages/sjPlot/vignettes/custplot.html</span></span>
<span><span class="co"># Colour customisation trick from: https://stackoverflow.com/questions/55598920/different-line-colors-in-forest-plot-output-from-sjplot-r-package</span></span>
<span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md_interaction</span>, </span>
<span>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>           title<span class="op">=</span><span class="st">"Fixed effects"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC1 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim1fixed-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="AppendixH_files/figure-html/Dim1fixed-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC1_lmer_fixed.svg"), height = 6, width = 9)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>visreg</code> function is used to visualise the distributions of the modelled Dim1 scores:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC1_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md_interaction</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Register"</span>, </span>
<span>       <span class="co">#type = "contrast",</span></span>
<span>       type <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, </span>
<span>       points<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, ylab <span class="op">=</span> <span class="st">"PC1"</span>,</span>
<span>       layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim1estimateplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="AppendixH_files/figure-html/Dim1estimateplots-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For PC2 to PC4, the models with random intercepts and slopes failed to converge, which is why only slopes are included in the following models.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Function to avoid repeating model fitting and comparison process for each PC.</span></span>
<span><span class="va">run_anova</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">response_var</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Fit the initial model</span></span>
<span>  <span class="va">md_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">response_var</span>, <span class="st">"~ 1 + (1|Source)"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Update models</span></span>
<span>  <span class="va">md_corpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_source</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Level</span><span class="op">)</span></span>
<span>  <span class="va">md_register</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_source</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Register</span><span class="op">)</span></span>
<span>  <span class="va">md_both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_corpus</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Register</span><span class="op">)</span></span>
<span>  <span class="va">md_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">md_both</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Level</span><span class="op">:</span><span class="va">Register</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Perform ANOVA</span></span>
<span>  <span class="va">anova_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">md_source</span>, <span class="va">md_corpus</span>, <span class="va">md_register</span>, <span class="va">md_both</span>, <span class="va">md_interaction</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Print ANOVA results</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">anova_results</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Save model object with appropriate name</span></span>
<span>  <span class="va">pc_number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="st">""</span>, <span class="va">response_var</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"md_interaction_PC"</span>, <span class="va">pc_number</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="va">md_interaction</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Return tabulated model</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">md_interaction</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="dimension-2-narrative-vs.-non-narrative" class="level3" data-number="H.10.3"><h3 data-number="H.10.3" class="anchored" data-anchor-id="dimension-2-narrative-vs.-non-narrative">
<span class="header-section-number">H.10.3</span> Dimension 2: ‘Narrative vs.&nbsp;Non-narrative’</h3>
<p>We first compare various models and then present a tabular summary of the best-fitting one.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PC2_models</span> <span class="op">&lt;-</span> <span class="fu">run_anova</span><span class="op">(</span><span class="st">"PC2"</span>, <span class="va">res.ind</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: data
Models:
md_source: PC2 ~ 1 + (1 | Source)
md_register: PC2 ~ (1 | Source) + Register
md_corpus: PC2 ~ (1 | Source) + Level
md_both: PC2 ~ (1 | Source) + Level + Register
md_interaction: PC2 ~ (1 | Source) + Level + Register + Level:Register
               npar   AIC   BIC  logLik deviance    Chisq Df Pr(&gt;Chisq)    
md_source         3 12281 12301 -6137.6    12275                           
md_register       5 10761 10794 -5375.7    10751 1523.882  2  &lt; 2.2e-16 ***
md_corpus         8 12138 12190 -6061.1    12122    0.000  3          1    
md_both          10 10616 10681 -5298.1    10596 1525.963  2  &lt; 2.2e-16 ***
md_interaction   20 10550 10680 -5254.9    10510   86.436 10  2.718e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md_interaction_PC2</span><span class="op">)</span> <span class="co"># R2 = 0.671 / 0.753</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.27&nbsp;–&nbsp;0.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.183</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.54</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.35&nbsp;–&nbsp;0.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.195</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.96&nbsp;–&nbsp;0.66</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.721</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.72&nbsp;–&nbsp;0.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.842</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.76&nbsp;–&nbsp;0.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.915</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.75&nbsp;–&nbsp;0.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.866</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.51&nbsp;–&nbsp;3.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.24&nbsp;–&nbsp;0.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.250</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.82&nbsp;–&nbsp;-0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.014</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.04&nbsp;–&nbsp;0.54</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.532</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.00&nbsp;–&nbsp;0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.602</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.41</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.20&nbsp;–&nbsp;0.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.308</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.26&nbsp;–&nbsp;0.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.246</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.34&nbsp;–&nbsp;1.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.246</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.22&nbsp;–&nbsp;1.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.154</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.54&nbsp;–&nbsp;1.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.524</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.26&nbsp;–&nbsp;1.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.183</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.49&nbsp;–&nbsp;1.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.431</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.45</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.15</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.25</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">325</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">4980</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.671 / 0.753</td>
</tr>
</tbody></table>
</div>
</div>
<p>Visualisation of the coefficient estimates of the fixed effects:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md_interaction_PC2</span>, </span>
<span>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>           title<span class="op">=</span><span class="st">"Fixed effects"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC2 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim2fixed-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="AppendixH_files/figure-html/Dim2fixed-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC2_lmer_fixed.svg"), height = 6, width = 9)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Visualisation of the predicted Dim2 scores:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC2_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md_interaction_PC2</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Register"</span>, </span>
<span>       <span class="co">#type = "contrast",</span></span>
<span>       type <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, </span>
<span>       points<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span>,</span>
<span>       layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim2estimateplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="AppendixH_files/figure-html/Dim2estimateplots-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can also explore the random effect structure.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Random effects</span></span>
<span><span class="va">ranef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">md_interaction_PC2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exploring the random effects of the sources of the Info Teens corpus</span></span>
<span><span class="va">ranef</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">grp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TeenVogue"</span>, <span class="st">"BBC"</span>, <span class="st">"Dogo"</span>, <span class="st">"Ducksters"</span>, <span class="st">"Encyclopedia"</span>, <span class="st">"Factmonster"</span>, <span class="st">"History"</span>, <span class="st">"Quatr"</span>, <span class="st">"Revision"</span>, <span class="st">"Science"</span>, <span class="st">"Science_Tech"</span>, <span class="st">"Teen"</span>, <span class="st">"TweenTribute"</span>, <span class="st">"WhyFiles"</span>, <span class="st">"World"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grp</span>, y <span class="op">=</span> <span class="va">condval</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="AppendixH_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Exploring the random effects associated with textbook series</span></span>
<span><span class="va">ranef</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">grp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Series</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grp</span>, y <span class="op">=</span> <span class="va">condval</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/unnamed-chunk-14-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="AppendixH_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="dimension-3-pedagogically-adapted-vs.-natural" class="level3" data-number="H.10.4"><h3 data-number="H.10.4" class="anchored" data-anchor-id="dimension-3-pedagogically-adapted-vs.-natural">
<span class="header-section-number">H.10.4</span> Dimension 3: ‘Pedagogically adapted vs.&nbsp;Natural’</h3>
<p>We first compare various models and then present a tabular summary of the best-fitting one.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PC3_models</span> <span class="op">&lt;-</span> <span class="fu">run_anova</span><span class="op">(</span><span class="st">"PC3"</span>, <span class="va">res.ind</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: data
Models:
md_source: PC3 ~ 1 + (1 | Source)
md_register: PC3 ~ (1 | Source) + Register
md_corpus: PC3 ~ (1 | Source) + Level
md_both: PC3 ~ (1 | Source) + Level + Register
md_interaction: PC3 ~ (1 | Source) + Level + Register + Level:Register
               npar   AIC   BIC  logLik deviance    Chisq Df Pr(&gt;Chisq)    
md_source         3 13523 13542 -6758.3    13517                           
md_register       5 12988 13020 -6489.0    12978  538.750  2  &lt; 2.2e-16 ***
md_corpus         8 11928 11981 -5956.2    11912 1065.455  3  &lt; 2.2e-16 ***
md_both          10 11466 11531 -5722.8    11446  466.870  2  &lt; 2.2e-16 ***
md_interaction   20 11461 11592 -5710.7    11421   24.264 10   0.006929 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md_interaction_PC3</span><span class="op">)</span> <span class="co"># R2 = 0.425 / 0.700</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 3</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.99&nbsp;–&nbsp;0.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.354</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.82&nbsp;–&nbsp;5.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.66&nbsp;–&nbsp;4.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.69&nbsp;–&nbsp;3.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.004</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.21&nbsp;–&nbsp;3.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.024</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.15&nbsp;–&nbsp;2.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.078</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.92&nbsp;–&nbsp;1.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.533</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.96&nbsp;–&nbsp;1.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.544</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.50</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.89&nbsp;–&nbsp;-0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.033</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.76&nbsp;–&nbsp;-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.048</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.71&nbsp;–&nbsp;0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.056</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.72&nbsp;–&nbsp;0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.055</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.41&nbsp;–&nbsp;0.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.142</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.92</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.35&nbsp;–&nbsp;-0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.009</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.86&nbsp;–&nbsp;-0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.045</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.77&nbsp;–&nbsp;0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.058</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.84&nbsp;–&nbsp;-0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.047</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.53</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.95&nbsp;–&nbsp;-0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.034</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.52</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.48</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.48</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">325</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">4980</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.425 / 0.700</td>
</tr>
</tbody></table>
</div>
</div>
<p>Visualisation of the coefficient estimates of the fixed effects:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md_interaction_PC3</span>, </span>
<span>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>           title<span class="op">=</span><span class="st">"Fixed effects"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC3 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim3fixed-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="AppendixH_files/figure-html/Dim3fixed-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC3_lmer_fixed.svg"), height = 6, width = 9)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Visualisation of the predicted Dim3 scores:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC3_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md_interaction_PC3</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Register"</span>, </span>
<span>       <span class="co">#type = "contrast",</span></span>
<span>       type <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, </span>
<span>       points<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, ylab <span class="op">=</span> <span class="st">"PC3"</span>,</span>
<span>       layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim3estimateplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="AppendixH_files/figure-html/Dim3estimateplots-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can also explore the random effect structure.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Random effects</span></span>
<span><span class="va">ranef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">md_interaction_PC3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exploring the random effects of the sources of the Info Teens corpus</span></span>
<span><span class="va">ranef</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">grp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TeenVogue"</span>, <span class="st">"BBC"</span>, <span class="st">"Dogo"</span>, <span class="st">"Ducksters"</span>, <span class="st">"Encyclopedia"</span>, <span class="st">"Factmonster"</span>, <span class="st">"History"</span>, <span class="st">"Quatr"</span>, <span class="st">"Revision"</span>, <span class="st">"Science"</span>, <span class="st">"Science_Tech"</span>, <span class="st">"Teen"</span>, <span class="st">"TweenTribute"</span>, <span class="st">"WhyFiles"</span>, <span class="st">"World"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grp</span>, y <span class="op">=</span> <span class="va">condval</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="AppendixH_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Exploring the random effects associated with textbook series</span></span>
<span><span class="va">ranef</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">grp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Series</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grp</span>, y <span class="op">=</span> <span class="va">condval</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/unnamed-chunk-17-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="AppendixH_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="dimension-4-factual-vs.-speculative-simple-vs.-complex-verb-forms" class="level3" data-number="H.10.5"><h3 data-number="H.10.5" class="anchored" data-anchor-id="dimension-4-factual-vs.-speculative-simple-vs.-complex-verb-forms">
<span class="header-section-number">H.10.5</span> Dimension 4: ‘Factual vs.&nbsp;Speculative’ / ‘Simple vs.&nbsp;complex verb forms’?</h3>
<p>We first compare various models and then present a tabular summary of the best-fitting one.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PC4_models</span> <span class="op">&lt;-</span> <span class="fu">run_anova</span><span class="op">(</span><span class="st">"PC4"</span>, <span class="va">res.ind</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: data
Models:
md_source: PC4 ~ 1 + (1 | Source)
md_register: PC4 ~ (1 | Source) + Register
md_corpus: PC4 ~ (1 | Source) + Level
md_both: PC4 ~ (1 | Source) + Level + Register
md_interaction: PC4 ~ (1 | Source) + Level + Register + Level:Register
               npar   AIC   BIC  logLik deviance    Chisq Df Pr(&gt;Chisq)    
md_source         3 11019 11039 -5506.5    11013                           
md_register       5 10825 10857 -5407.4    10815 198.2593  2    &lt; 2e-16 ***
md_corpus         8 10827 10879 -5405.3    10811   4.0956  3     0.2513    
md_both          10 10563 10628 -5271.6    10543 267.5805  2    &lt; 2e-16 ***
md_interaction   20 10527 10657 -5243.3    10487  56.4370 10    1.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md_interaction_PC4</span><span class="op">)</span> <span class="co"># R2 = 0.234 / 0.434</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 4</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.53</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.31&nbsp;–&nbsp;0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.187</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.47&nbsp;–&nbsp;1.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.392</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08&nbsp;–&nbsp;1.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.033</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.45&nbsp;–&nbsp;2.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.003</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.62&nbsp;–&nbsp;2.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.64</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.80&nbsp;–&nbsp;2.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.15&nbsp;–&nbsp;1.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.019</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.43&nbsp;–&nbsp;1.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.358</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.94&nbsp;–&nbsp;-0.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.008</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.48&nbsp;–&nbsp;-0.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.40&nbsp;–&nbsp;-0.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.75</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.55&nbsp;–&nbsp;-0.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register<br>[Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.86</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.67&nbsp;–&nbsp;-1.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [A] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.92</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.78&nbsp;–&nbsp;-0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.034</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.85&nbsp;–&nbsp;-0.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.016</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.83&nbsp;–&nbsp;-0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.017</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.03&nbsp;–&nbsp;-0.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.004</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E] × Register<br>[Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.99&nbsp;–&nbsp;-0.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.007</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.45</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.16</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.26</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Source</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">325</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">4980</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.234 / 0.434</td>
</tr>
</tbody></table>
</div>
</div>
<p>Visualisation of the coefficient estimates of the fixed effects:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md_interaction_PC4</span>, </span>
<span>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>           title<span class="op">=</span><span class="st">"Fixed effects"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC4 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim4fixed-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="AppendixH_files/figure-html/Dim4fixed-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC4_lmer_fixed.svg"), height = 6, width = 9)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Visualisation of the predicted Dim4 scores:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC4_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md_interaction_PC4</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Register"</span>, </span>
<span>       <span class="co">#type = "contrast",</span></span>
<span>       type <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, </span>
<span>       points<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, ylab <span class="op">=</span> <span class="st">"PC4"</span>,</span>
<span>       layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/Dim4estimateplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="AppendixH_files/figure-html/Dim4estimateplots-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can also explore the random effect structure.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Random effects</span></span>
<span><span class="va">ranef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">md_interaction_PC4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exploring the random effects of the sources of the Info Teens corpus</span></span>
<span><span class="va">ranef</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">grp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TeenVogue"</span>, <span class="st">"BBC"</span>, <span class="st">"Dogo"</span>, <span class="st">"Ducksters"</span>, <span class="st">"Encyclopedia"</span>, <span class="st">"Factmonster"</span>, <span class="st">"History"</span>, <span class="st">"Quatr"</span>, <span class="st">"Revision"</span>, <span class="st">"Science"</span>, <span class="st">"Science_Tech"</span>, <span class="st">"Teen"</span>, <span class="st">"TweenTribute"</span>, <span class="st">"WhyFiles"</span>, <span class="st">"World"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grp</span>, y <span class="op">=</span> <span class="va">condval</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="AppendixH_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Exploring the random effects associated with textbook series</span></span>
<span><span class="va">ranef</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">grp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Series</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grp</span>, y <span class="op">=</span> <span class="va">condval</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/unnamed-chunk-20-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="AppendixH_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="testing-model-assumptions" class="level3" data-number="H.10.6"><h3 data-number="H.10.6" class="anchored" data-anchor-id="testing-model-assumptions">
<span class="header-section-number">H.10.6</span> Testing model assumptions</h3>
<p>This chunk can be used to check the assumptions of all of the models computed above. In the following example, we examine the final model selected to predict Dim2 scores.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model2test</span> <span class="op">&lt;-</span> <span class="va">md_interaction_PC2</span></span>
<span></span>
<span><span class="co"># check distribution of residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model2test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/lmer-diagnostics-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="AppendixH_files/figure-html/lmer-diagnostics-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># scale-location plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model2test</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p"</span>,<span class="st">"smooth"</span><span class="op">)</span>, col.line<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/lmer-diagnostics-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="AppendixH_files/figure-html/lmer-diagnostics-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Q-Q plot</span></span>
<span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/qqmath.html">qqmath</a></span><span class="op">(</span><span class="va">model2test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixH_files/figure-html/lmer-diagnostics-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="AppendixH_files/figure-html/lmer-diagnostics-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-lefoll" class="csl-entry" role="listitem">
Le Foll, Elen. <span><em>Schulenglisch</em></span>: A multi-dimensional model of the variety of <span>English</span> taught in german secondary schools. <em>AAA: Arbeiten aus Anglistik und Amerikanistik</em> 49.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/elenlefoll\.github\.io\/TextbookMDA\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./AppendixG.html" class="pagination-link" aria-label="Data Preparation for the Model of Textbook English vs. ‘real-world’ English">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Analysis for the Model of Textbook English vs. ‘real-world’ English</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>This script documents the analysis of data from the TEC and reference corpus data (as pre-processed in Appendix F) to arrive at the multi-dimensional model of Textbook Englisch vs. 'real-world' English described in Chapter 7. It generates all of the statistics and plots included in the book, as well as many others that were used in the analysis, but were not included in the book for reasons of space.</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages required</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>The following packages must be installed and loaded to process the data.</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: set-up</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original thesis.</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># For its confusion matrix function</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># For its plot themes</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools) <span class="co"># For 95% CI</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co"># For the emmeans function</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co"># For circular graphs of variables</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary) <span class="co"># For nice table of summary statistics (optional)</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># For Fig. 35</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># For dynamic file paths</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes) <span class="co"># For theme of factoextra plots</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># For linear regression modelling</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># To create figures with more than one plot</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="co">#library(pca3d) # For 3-D plots (not rendered in exports)</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PCAtools) <span class="co"># For nice biplots of PCA results</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co"># For various useful stats function</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># For model plots and tables</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># For data wrangling</span></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg) <span class="co"># For plots of interaction effects</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R_rainclouds.R"</span>)) <span class="co"># For geom_flat_violin rainplots</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conducting the PCA</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>We first import the full dataset (see Appendix F for data preparation steps).</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r import-data}</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- readRDS(here("data", "processed", "dataforPCA.rds")) </span></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>The following chunks can be used to perform the MDA on various subsets of the data (see also Section 10.1.1 in the book).</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>i.  Subset of the data that excludes the lower-level textbooks:</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- readRDS(here("processed_data", "dataforPCA.rds")) |&gt;</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Level !="A" &amp; Level != "B") |&gt;</span></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a><span class="in">  droplevels()</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a><span class="in">summary(data$Level)</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>i.  Subset of the data that includes only one <span class="in">`Country`</span><span class="sc">\`</span> subcorpus of the TEC (note that a detailed analysis of the German subcorpus can be found in <span class="co">[</span><span class="ot">@lefoll</span><span class="co">]</span>):</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- readRDS(here("processed_data", "dataforPCA.rds")) |&gt;</span></span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a><span class="in">  #filter(Country != "France" &amp; Country != "Germany") |&gt; # Spain only</span></span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a><span class="in">  #filter(Country != "France" &amp; Country != "Spain") |&gt; # Germany only</span></span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Country != "Spain" &amp; Country != "Germany") |&gt; # France only</span></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a><span class="in">  droplevels()</span></span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a><span class="in">summary(data$Country)</span></span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a>i. Random subsets of the data to test the stability of the model proposed in Chapter 7. Re-running this line will generate a new subset of 2/3 of the texts randomly sampled. <span class="in">`set.seed(13)`</span> was used for the analyses reported on in Section 10.1.1.</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(13) </span></span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- readRDS(here("processed_data", "dataforPCA.rds")) |&gt;</span></span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a><span class="in">  slice_sample(n = 4980*0.6, replace = FALSE)</span></span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a><span class="in">nrow(data)</span></span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a><span class="in">data$Filename[1:4]</span></span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a><span class="in">#Using the set.seed(13), these should be:</span></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a><span class="in">#[1] HT_4_Spoken_0009.txt                       </span></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a><span class="in">#[2] Solutions_Intermediate_Plus_Spoken_0020.txt</span></span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a><span class="in">#[3] 141_PRATCHETT1992DW13GODS_4.txt            </span></span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a><span class="in">#[4] Achievers_B2_Informative_0004.txt</span></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plotting PCA results</span></span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3D plots</span></span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a>The following chunk can be used to create projections of TEC texts on three dimensions of the model. These plots cannot be rendered in two dimensions and are therefore not generated in the present document. For more information on the <span class="in">`pca3d`</span> library, see: <span class="ot">&lt;https://cran.r-project.org/web/packages/pca3d/vignettes/pca3d.pdf&gt;</span>.</span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 3D-colours, include=FALSE}</span></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a><span class="in"># These lines create a beautiful feminist colour palette based on banners from the suffragette mouvement: https://github.com/alburezg/suffrager</span></span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a><span class="in"># devtools::install_github("alburezg/suffrager")</span></span>
<span id="cb68-98"><a href="#cb68-98" aria-hidden="true" tabindex="-1"></a><span class="in"># library(suffrager)</span></span>
<span id="cb68-99"><a href="#cb68-99" aria-hidden="true" tabindex="-1"></a><span class="in">#colours &lt;- suf_palette(name = "london", n = 6, type = "continuous") </span></span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a><span class="in">#colours2 &lt;- suf_palette(name = "classic", n = 5, type = "continuous") #colours &lt;- c(colours, colours2[c(2:4)]) # Nine colours range</span></span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a><span class="in">#col6 &lt;- colours[c(6,5,4,7,9,2)] # Good order for PCA</span></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a><span class="in">#scales::show_col(col6)</span></span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a><span class="in"># This corresponds to these colours in hex codes:</span></span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a><span class="in">col6 &lt;- c("#F9B921", "#A18A33", "#722672", "#BD241E", "#267226", "#15274D")</span></span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a><span class="in">names(col6) &lt;- c("Textbook Conversation", "Textbook Fiction", "Textbook Informative", "Spoken BNC2014 Ref.", "Youth Fiction Ref.", "Info Teens Ref.")</span></span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a><span class="in">shapes6 &lt;- c(rep("cube", 3),rep("sphere", 3))</span></span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a><span class="in">names(shapes6) &lt;- c("Textbook Conversation", "Textbook Fiction", "Textbook Informative", "Spoken BNC2014 Ref.", "Youth Fiction Ref.", "Info Teens Ref.")</span></span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a><span class="in"># This subset is used when all TEC texts are to be displayed in orange</span></span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a><span class="in">#col4 &lt;- colours[c(1,3,7,9)]</span></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a><span class="in">col4 &lt;- c("#EA7E1E", "#15274D", "#BD241E", "#267226")</span></span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a><span class="in">names(col4) &lt;- c("Textbook.English", "Informative.Teens", "Spoken.BNC2014", "Youth.Fiction")</span></span>
<span id="cb68-114"><a href="#cb68-114" aria-hidden="true" tabindex="-1"></a><span class="in">shapes4 &lt;- c("cube", rep("sphere", 3))</span></span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a><span class="in">names(shapes4) &lt;- c("Textbook.English", "Informative.Teens", "Spoken.BNC2014", "Youth.Fiction")</span></span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pca3d, eval=FALSE}</span></span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a><span class="in"># Data preparation for 3D plots</span></span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(data) # Checking that the features start at the 9th column</span></span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a><span class="in">pca &lt;- prcomp(data[,9:ncol(data)], scale.=FALSE) # All quantitative variables that contribute to the model</span></span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a><span class="in">register &lt;- factor(data[,"Register"]) </span></span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a><span class="in">corpus &lt;- factor(data[,"Corpus"])</span></span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a><span class="in">subcorpus &lt;- factor(data[,"Subcorpus"])</span></span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a><span class="in">library(pca3d)</span></span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a><span class="in">pca3d(pca, group = subcorpus,</span></span>
<span id="cb68-131"><a href="#cb68-131" aria-hidden="true" tabindex="-1"></a><span class="in">       components = 1:3,</span></span>
<span id="cb68-132"><a href="#cb68-132" aria-hidden="true" tabindex="-1"></a><span class="in">       components = 4:6,</span></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a><span class="in">       show.plane=FALSE,</span></span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a><span class="in">       col = col6,</span></span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a><span class="in">       shape = shapes6,</span></span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a><span class="in">       radius = 0.7,</span></span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a><span class="in">       legend = "right")</span></span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a><span class="in">snapshotPCA3d(here("plots", "PCA_TxB_3Ref_3Dsnapshot.png"))</span></span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a><span class="in"># Alternative visualisation, looking at all three Textbook English registers in one colour</span></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a><span class="in">pca3d(pca, group = corpus, </span></span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a><span class="in">      show.plane=FALSE,</span></span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a><span class="in">      components = 1:3,</span></span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a><span class="in">      col = col4,</span></span>
<span id="cb68-147"><a href="#cb68-147" aria-hidden="true" tabindex="-1"></a><span class="in">      shape = shapes4,</span></span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a><span class="in">      radius = 0.7,</span></span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a><span class="in">      legend = "right")</span></span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two-dimensional plots (biplots)</span></span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a>These plots were generated using the <span class="in">`PCAtools`</span> package, which requires the data to be formatted in a rather unconventional way so it needs to wrangled first.</span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data wrangling for PCAtools</span></span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCAtools-biplots}</span></span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a><span class="in"># Data wrangling</span></span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a><span class="in">data2 &lt;- data |&gt; </span></span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Source = recode_factor(Corpus, Textbook.English = "Textbook English (TEC)", Informative.Teens = "Reference corpora", Spoken.BNC2014 = "Reference corpora", Youth.Fiction = "Reference corpora")) |&gt; </span></span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Corpus = fct_relevel(Subcorpus, "Info Teens Ref.", after = 9)) |&gt;</span></span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="in">  relocate(Source, .after = "Corpus") |&gt; </span></span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a><span class="in">  droplevels()</span></span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a><span class="in"># colnames(data2)</span></span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a><span class="in">data2meta &lt;- data2[,1:9]</span></span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(data2meta) &lt;- data2meta$Filename</span></span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a><span class="in">data2meta &lt;- data2meta |&gt; select(-Filename)</span></span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a><span class="in"># head(data2meta)</span></span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(data2) &lt;- data2$Filename</span></span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a><span class="in">data2num &lt;- as.data.frame(base::t(data2[,10:ncol(data2)]))</span></span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a><span class="in"># data2num[1:5,1:5] # Check data frame format is correct by comparing to output of head(data2meta) above</span></span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- PCAtools::pca(data2num, </span></span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a><span class="in">         metadata = data2meta,</span></span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a><span class="in">         scale = FALSE)</span></span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a>The cumulative proportion of variance in the dataset explained the first four components explain <span class="in">`{r} sum(p$variance[1:4]) |&gt; round(2)`</span>%.</span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pairs plot</span></span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a>This chunk produces a scatterplot matrix of combinations of the four dimensions of the model of Textbook English vs. ‘real-world’ English. Note that the number before the comma on each axis label shows which principal component is plotted on that axis; this is followed by the percentage of the total variance explained by that particular component. The colours correspond to the text registers.</span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCAtools-pairsplots-TxB</span></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 13</span></span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a><span class="co"># For five TEC registers</span></span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a><span class="co"># colkey = c(`Spoken BNC2014 Ref.`="#BD241E", `Info Teens Ref.`="#15274D", `Youth Fiction Ref.`="#267226", `Textbook Fiction`="#A18A33", `Textbook Conversation`="#F9B921", `Textbook Informative` = "#722672", `Textbook Instructional` = "grey", `Textbook Personal` = "black")</span></span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a><span class="co"># For three TEC registers</span></span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(data2$Corpus)</span></span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a>colkey <span class="ot">=</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Spoken BNC2014 Ref.</span><span class="st">`</span><span class="ot">=</span><span class="st">"#BD241E"</span>, <span class="st">`</span><span class="at">Info Teens Ref.</span><span class="st">`</span><span class="ot">=</span><span class="st">"#15274D"</span>, <span class="st">`</span><span class="at">Youth Fiction Ref.</span><span class="st">`</span><span class="ot">=</span><span class="st">"#267226"</span>, <span class="st">`</span><span class="at">Textbook Fiction</span><span class="st">`</span><span class="ot">=</span><span class="st">"#A18A33"</span>, <span class="st">`</span><span class="at">Textbook Conversation</span><span class="st">`</span><span class="ot">=</span><span class="st">"#F9B921"</span>, <span class="st">`</span><span class="at">Textbook Informative</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"#722672"</span>)</span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(data2$Source)</span></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a><span class="co">#shapekey = c(`Textbook English (TEC)`=6, `Reference corpora`=1)</span></span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(data2$Level)</span></span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a>shapekey <span class="ot">=</span> <span class="fu">c</span>(<span class="at">A=</span><span class="dv">1</span>, <span class="at">B=</span><span class="dv">2</span>, <span class="at">C=</span><span class="dv">6</span>, <span class="at">D=</span><span class="dv">0</span>, <span class="at">E=</span><span class="dv">5</span>, <span class="st">`</span><span class="at">Ref.</span><span class="st">`</span><span class="ot">=</span><span class="dv">4</span>)</span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: this can be very slow! Open in extra zoomed out window!</span></span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a><span class="co">#png(here("plots", "PCA_3Ref_pairsplot.png"), width = 12, height= 19, units = "cm", res = 300)</span></span>
<span id="cb68-215"><a href="#cb68-215" aria-hidden="true" tabindex="-1"></a>PCAtools<span class="sc">::</span><span class="fu">pairsplot</span>(p,</span>
<span id="cb68-216"><a href="#cb68-216" aria-hidden="true" tabindex="-1"></a>                 <span class="at">triangle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a>                 <span class="at">components =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="fl">0.6</span>,</span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Corpus"</span>,</span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">"none"</span>,</span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a>                 <span class="at">margingaps =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="st">"cm"</span>),</span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey)</span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_pairsplot.svg"), width = 6, height = 10)</span></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the legend has to be added manually (it was taken from the biplot code below).</span></span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bi-plots</span></span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a>Biplots are used to more closely examine the position of texts on just two dimensions.</span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCAtools-biplots-TxB</span></span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 13</span></span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a><span class="co"># These settings (with legendPosition = "top") were used to generate the legend for the scatterplot matrix above:</span></span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a><span class="co">#png(here("plots", "PCA_3Ref_Biplot_PC1_PC2test.png"), width = 40, height= 25, units = "cm", res = 300) </span></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a>PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC1"</span>,</span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC2"</span>,</span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Corpus"</span>,</span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="fl">1.3</span>,</span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey,</span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC1"</span>]), <span class="fu">max</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC1"</span>])),</span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC2"</span>]), <span class="fu">max</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC2"</span>])),</span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisLabSize =</span> <span class="dv">18</span>,</span>
<span id="cb68-262"><a href="#cb68-262" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb68-263"><a href="#cb68-263" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">18</span>,</span>
<span id="cb68-264"><a href="#cb68-264" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">14</span>, </span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_Ref3TxB_BiplotPC1_PC2.svg"), width = 12, height = 8)</span></span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplots to examine components more carefully</span></span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a>PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC3"</span>,</span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC4"</span>,</span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Corpus"</span>,</span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="fl">1.2</span>,</span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey,</span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb68-279"><a href="#cb68-279" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb68-280"><a href="#cb68-280" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC3"</span>]), <span class="fu">max</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC3"</span>])),</span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC4"</span>]), <span class="fu">max</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC4"</span>])),</span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisLabSize =</span> <span class="dv">18</span>,</span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">18</span>,</span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">14</span>, </span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-291"><a href="#cb68-291" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_Ref3TxB_BiplotPC3_PC4.svg"), width = 12, height = 8)</span></span>
<span id="cb68-292"><a href="#cb68-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-293"><a href="#cb68-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a>The colours and corresponding ellipses can be used to visualise different clusters and patterns. In the following, we change the colour of the points and the ellipses to represent the texts' target proficiency levels instead of the register, allowing for a different interpretation of the model.</span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-299"><a href="#cb68-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCAtools-biplots-TxB-Levels</span></span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 13</span></span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-305"><a href="#cb68-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplot with ellipses for Level rather than Register</span></span>
<span id="cb68-306"><a href="#cb68-306" aria-hidden="true" tabindex="-1"></a>colkeyLevels <span class="ot">=</span> <span class="fu">c</span>(<span class="at">A=</span><span class="st">"#F9B921"</span>, <span class="at">B=</span><span class="st">"#A18A33"</span>, <span class="at">C=</span><span class="st">"#BD241E"</span>, <span class="at">D=</span><span class="st">"#722672"</span>, <span class="at">E=</span><span class="st">"#15274D"</span>, <span class="st">`</span><span class="at">Ref. data</span><span class="st">`</span><span class="ot">=</span> <span class="st">"darkgrey"</span>)</span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a>shapekeyLevels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Spoken BNC2014 Ref.</span><span class="st">`</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">`</span><span class="at">Info Teens Ref.</span><span class="st">`</span><span class="ot">=</span><span class="dv">17</span>, <span class="st">`</span><span class="at">Youth Fiction Ref.</span><span class="st">`</span><span class="ot">=</span><span class="dv">15</span>, <span class="st">`</span><span class="at">Textbook Fiction</span><span class="st">`</span><span class="ot">=</span><span class="dv">0</span>, <span class="st">`</span><span class="at">Textbook Conversation</span><span class="st">`</span><span class="ot">=</span><span class="dv">1</span>, <span class="st">`</span><span class="at">Textbook Informative</span><span class="st">`</span><span class="ot">=</span><span class="dv">2</span>)</span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a>PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC3"</span>,</span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC4"</span>,</span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb68-313"><a href="#cb68-313" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Level"</span>,</span>
<span id="cb68-314"><a href="#cb68-314" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="fl">1.3</span>,</span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkeyLevels,</span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Corpus"</span>,</span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekeyLevels,</span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC3"</span>]), <span class="fu">max</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC3"</span>])),</span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC4"</span>]), <span class="fu">max</span>(p<span class="sc">$</span>rotated[, <span class="st">"PC4"</span>])),</span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisLabSize =</span> <span class="dv">18</span>,</span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">18</span>,</span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">14</span>, </span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb68-328"><a href="#cb68-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-329"><a href="#cb68-329" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_Ref3TxB_BiplotPC3_PC4_levels.svg"), width = 12, height = 8)</span></span>
<span id="cb68-330"><a href="#cb68-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-331"><a href="#cb68-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature contributions (loadings) on each component</span></span>
<span id="cb68-334"><a href="#cb68-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: loadings</span></span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- readRDS(here("processed_data", "dataforPCA.rds")) </span></span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(data)], <span class="at">scale.=</span><span class="cn">FALSE</span>) <span class="co"># All quantitative variables to be included in the model</span></span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a><span class="co"># The rotated data that represents the observations / samples is stored in rotated, while the variable loadings are stored in loadings</span></span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>rotation[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-347"><a href="#cb68-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of loadings with no minimum threshold applied</span></span>
<span id="cb68-348"><a href="#cb68-348" aria-hidden="true" tabindex="-1"></a>loadings <span class="sc">|&gt;</span> </span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span>
<span id="cb68-351"><a href="#cb68-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-352"><a href="#cb68-352" aria-hidden="true" tabindex="-1"></a><span class="co">#clipr::write_last_clip()</span></span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-354"><a href="#cb68-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-355"><a href="#cb68-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graphs of features of that contribute most to each component/dimension</span></span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-357"><a href="#cb68-357" aria-hidden="true" tabindex="-1"></a>Graphs of features display the features with the strongest contributions to any two dimensions of the model of intra-textbook variation. They are created using the <span class="in">`factoextra::fviz_pca_var`</span> function.</span>
<span id="cb68-358"><a href="#cb68-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-359"><a href="#cb68-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r graphs-of-variables}</span></span>
<span id="cb68-360"><a href="#cb68-360" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-361"><a href="#cb68-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_var(pca,</span></span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a><span class="in">             axes = c(1,2),</span></span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a><span class="in">             select.var = list(contrib = 25),</span></span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a><span class="in">             col.var = "contrib", # Colour by contributions to the PC</span></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a><span class="in">             gradient.cols = c("#F9B921", "#DB241E", "#722672"),</span></span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a><span class="in">             title = "",</span></span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a><span class="in">             repel = TRUE, # Try to avoid too much text overlapping</span></span>
<span id="cb68-369"><a href="#cb68-369" aria-hidden="true" tabindex="-1"></a><span class="in">             ggtheme = ggthemes::theme_few())</span></span>
<span id="cb68-370"><a href="#cb68-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "fviz_pca_var_PC1_PC2_Ref3Reg.svg"), width = 9, height = 7)</span></span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_var(pca,</span></span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a><span class="in">             axes = c(3,2),</span></span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a><span class="in">             select.var = list(contrib = 30),</span></span>
<span id="cb68-376"><a href="#cb68-376" aria-hidden="true" tabindex="-1"></a><span class="in">             col.var = "contrib", # Colour by contributions to the PC</span></span>
<span id="cb68-377"><a href="#cb68-377" aria-hidden="true" tabindex="-1"></a><span class="in">             gradient.cols = c("#F9B921", "#DB241E", "#722672"),</span></span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a><span class="in">             title = "",</span></span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a><span class="in">             repel = TRUE, # Try to avoid too much text overlapping</span></span>
<span id="cb68-380"><a href="#cb68-380" aria-hidden="true" tabindex="-1"></a><span class="in">             ggtheme = ggthemes::theme_few())</span></span>
<span id="cb68-381"><a href="#cb68-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "fviz_pca_var_PC3_PC2_Ref3Reg.svg"), width = 9, height = 8)</span></span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_var(pca,</span></span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a><span class="in">             axes = c(3,4),</span></span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a><span class="in">             select.var = list(contrib = 30),</span></span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a><span class="in">             col.var = "contrib", # Colour by contributions to the PC</span></span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a><span class="in">             gradient.cols = c("#F9B921", "#DB241E", "#722672"),</span></span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a><span class="in">             title = "",</span></span>
<span id="cb68-390"><a href="#cb68-390" aria-hidden="true" tabindex="-1"></a><span class="in">             repel = TRUE, # Try to avoid too much text overlapping</span></span>
<span id="cb68-391"><a href="#cb68-391" aria-hidden="true" tabindex="-1"></a><span class="in">             ggtheme = ggthemes::theme_few())</span></span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "fviz_pca_var_PC3_PC4_Ref3Reg.svg"), width = 9, height = 8)</span></span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploring feature contributions in terms of normalised frequencies</span></span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a>We can go back to the normalised frequencies of the individual features to compare them across different registers and levels, e.g.,:</span>
<span id="cb68-400"><a href="#cb68-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-401"><a href="#cb68-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r feature-contributions}</span></span>
<span id="cb68-402"><a href="#cb68-402" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts &lt;- readRDS(here("data", "processed", "ncounts3_3Reg.rds"))</span></span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts |&gt; </span></span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Register=="Informative") |&gt; </span></span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a><span class="in">  #filter(Level %in% c("C", "D", "E")) |&gt; </span></span>
<span id="cb68-409"><a href="#cb68-409" aria-hidden="true" tabindex="-1"></a><span class="in">  select(Level, VBD, PEAS) |&gt; </span></span>
<span id="cb68-410"><a href="#cb68-410" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Level) |&gt; </span></span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise_if(is.numeric, mean) |&gt; </span></span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a><span class="in">  kable(digits=2)</span></span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a>The following chunk produces Figure 35 which shows normalised counts of selected features with salient loadings on PC1 in the Textbook Informative subcorpus (Levels A to E) and the reference Info Teens corpus (Ref.). This plots visualises the observed normalised frequencies as they were extracted using the MFTE Perl (see Appendices C and F). </span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-417"><a href="#cb68-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r boxplots}</span></span>
<span id="cb68-418"><a href="#cb68-418" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-419"><a href="#cb68-419" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 10</span></span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 15</span></span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a><span class="in">cols = c("#F9B921", "#A18A33", "#BD241E", "#722672", "#15274D", "darkgrey")</span></span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a><span class="in">boxfeature &lt;- ncounts |&gt; </span></span>
<span id="cb68-425"><a href="#cb68-425" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Register=="Informative") |&gt; </span></span>
<span id="cb68-426"><a href="#cb68-426" aria-hidden="true" tabindex="-1"></a><span class="in">  #filter(Level %in% c("C", "D", "E")) |&gt; </span></span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a><span class="in">  select(Level, FPP1S, SPP2, CONT, EXIST, AWL, XX0, PASS, VBN) |&gt; </span></span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = Level, y = CONT, colour = Level, fill = Level)) +</span></span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(size=0.7, alpha=.7) +</span></span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.shape = NA, fatten = 2, fill = "white", alpha = 0.3) +</span></span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_colour_manual(values = cols) +</span></span>
<span id="cb68-432"><a href="#cb68-432" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb68-433"><a href="#cb68-433" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") +</span></span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("")</span></span>
<span id="cb68-435"><a href="#cb68-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-436"><a href="#cb68-436" aria-hidden="true" tabindex="-1"></a><span class="in">CONT = boxfeature</span></span>
<span id="cb68-437"><a href="#cb68-437" aria-hidden="true" tabindex="-1"></a><span class="in">SPP2 &lt;- boxfeature + aes(y = SPP2) </span></span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a><span class="in">EXIST &lt;- boxfeature + aes(y = EXIST) + ylim(c(0,25)) # These y-axis limits remove individual outliers that overextend the scales and make the existing differences invisible to the naked eye. They can be removed to visualise all data points.</span></span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a><span class="in">FFP1 &lt;- boxfeature + aes(y = FPP1S) + ylim(c(0,60))  </span></span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a><span class="in">AWL &lt;- boxfeature + aes(y = AWL)</span></span>
<span id="cb68-441"><a href="#cb68-441" aria-hidden="true" tabindex="-1"></a><span class="in">XX0 &lt;- boxfeature + aes(y = XX0) + ylim(c(0,25))</span></span>
<span id="cb68-442"><a href="#cb68-442" aria-hidden="true" tabindex="-1"></a><span class="in">PASS &lt;- boxfeature + aes(y = PASS)</span></span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a><span class="in">VBN &lt;- boxfeature + aes(y = VBN) + ylim(c(0,40))</span></span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a><span class="in">boxplots &lt;- gridExtra::grid.arrange(PASS, VBN, AWL, EXIST, FFP1, SPP2, CONT, XX0, ncol=2, nrow=4)</span></span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "BoxplotsInformativeFeatures.svg"), plot = boxplots, dpi = 300, width = 9, height = 11)</span></span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-450"><a href="#cb68-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-451"><a href="#cb68-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploring the dimensions of the model</span></span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-453"><a href="#cb68-453" aria-hidden="true" tabindex="-1"></a>We begin with some descriptive statistics of the dimension scores.</span>
<span id="cb68-454"><a href="#cb68-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-455"><a href="#cb68-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCA-numerical-results}</span></span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a><span class="in">#data &lt;- readRDS(here("data", "processed", "dataforPCA.rds")) </span></span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a><span class="in">#colnames(data)</span></span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a><span class="in">pca &lt;- prcomp(data[,9:ncol(data)], scale.=FALSE) # All quantitative variables</span></span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a><span class="in">## Access to the PCA results</span></span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a><span class="in">#colnames(data)</span></span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind &lt;- cbind(data[,1:8], as.data.frame(pca$x)[,1:4])</span></span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a><span class="in">## Summary statistics</span></span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind |&gt; </span></span>
<span id="cb68-468"><a href="#cb68-468" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Subcorpus, Level) |&gt; </span></span>
<span id="cb68-469"><a href="#cb68-469" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise_if(is.numeric, c(mean = mean, sd = sd)) |&gt; </span></span>
<span id="cb68-470"><a href="#cb68-470" aria-hidden="true" tabindex="-1"></a><span class="in">  kable(digits = 2)  </span></span>
<span id="cb68-471"><a href="#cb68-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind &lt;- res.ind |&gt; </span></span>
<span id="cb68-473"><a href="#cb68-473" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Subsubcorpus = paste(Corpus, Register, sep = "_")) |&gt; </span></span>
<span id="cb68-474"><a href="#cb68-474" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Subsubcorpus = as.factor(Subsubcorpus))</span></span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-476"><a href="#cb68-476" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind |&gt; </span></span>
<span id="cb68-477"><a href="#cb68-477" aria-hidden="true" tabindex="-1"></a><span class="in">  select(PC1, PC2, PC3, PC4, Subsubcorpus) |&gt; </span></span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a><span class="in">  tbl_summary(by = Subsubcorpus,</span></span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a><span class="in">              digits = list(all_continuous() ~ c(2, 2)),</span></span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a><span class="in">              statistic = all_continuous() ~  "{mean} ({sd})")</span></span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind |&gt; </span></span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a><span class="in">  select(Register, Level, PC4) |&gt; </span></span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Register, Level) |&gt; </span></span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise_if(is.numeric, c(Median = median, MAD = mad)) |&gt; </span></span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a><span class="in">  kable(digits = 2)  </span></span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-489"><a href="#cb68-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-490"><a href="#cb68-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a>The following chunk can be used to search for example texts that are located in specific areas of the biplots. For example, we can search for texts that have high scores on Dim3 and low ones on Dim2 to proceed with a qualitative comparison and analysis of these texts.</span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-495"><a href="#cb68-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-496"><a href="#cb68-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: example-texts</span></span>
<span id="cb68-497"><a href="#cb68-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-498"><a href="#cb68-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-499"><a href="#cb68-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for example texts to illustrate results</span></span>
<span id="cb68-500"><a href="#cb68-500" aria-hidden="true" tabindex="-1"></a>res.ind <span class="sc">|&gt;</span> </span>
<span id="cb68-501"><a href="#cb68-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PC3 <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> PC2 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb68-502"><a href="#cb68-502" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(Register=="Conversation") |&gt; </span></span>
<span id="cb68-503"><a href="#cb68-503" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(Level == "B") |&gt; </span></span>
<span id="cb68-504"><a href="#cb68-504" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(PC1 &gt; 4.7) |&gt; </span></span>
<span id="cb68-505"><a href="#cb68-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Filename, PC1, PC2, PC3) <span class="sc">|&gt;</span> </span>
<span id="cb68-506"><a href="#cb68-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb68-507"><a href="#cb68-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-508"><a href="#cb68-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-509"><a href="#cb68-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-510"><a href="#cb68-510" aria-hidden="true" tabindex="-1"></a><span class="fu">## Raincloud plots visualising dimension scores</span></span>
<span id="cb68-511"><a href="#cb68-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-512"><a href="#cb68-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rainplots}</span></span>
<span id="cb68-513"><a href="#cb68-513" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-514"><a href="#cb68-514" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 8</span></span>
<span id="cb68-515"><a href="#cb68-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-516"><a href="#cb68-516" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind$Subcorpus &lt;- fct_relevel(res.ind$Subcorpus, "Spoken BNC2014 Ref.", "Textbook Conversation", "Youth Fiction Ref.", "Textbook Fiction", "Info Teens Ref.", "Textbook Informative")</span></span>
<span id="cb68-517"><a href="#cb68-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-518"><a href="#cb68-518" aria-hidden="true" tabindex="-1"></a><span class="in"># colours &lt;- suf_palette(name = "london", n = 6, type = "continuous")</span></span>
<span id="cb68-519"><a href="#cb68-519" aria-hidden="true" tabindex="-1"></a><span class="in"># colours2 &lt;- suf_palette(name = "classic", n = 5, type = "continuous")</span></span>
<span id="cb68-520"><a href="#cb68-520" aria-hidden="true" tabindex="-1"></a><span class="in"># colours &lt;- c(colours, colours2[c(2:4)]) # Nine colours range</span></span>
<span id="cb68-521"><a href="#cb68-521" aria-hidden="true" tabindex="-1"></a><span class="in"># palette &lt;- colours[c(1,5,6,2,3,8,7,4,9)] # Good order for PCA</span></span>
<span id="cb68-522"><a href="#cb68-522" aria-hidden="true" tabindex="-1"></a><span class="in"># colours &lt;- palette[c(1,8,9,2,7,3)]</span></span>
<span id="cb68-523"><a href="#cb68-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-524"><a href="#cb68-524" aria-hidden="true" tabindex="-1"></a><span class="in"># This translates as:</span></span>
<span id="cb68-525"><a href="#cb68-525" aria-hidden="true" tabindex="-1"></a><span class="in">palette &lt;- c("#BD241E", "#A18A33", "#15274D", "#D54E1E", "#EA7E1E", "#4C4C4C", "#722672", "#F9B921", "#267226")</span></span>
<span id="cb68-526"><a href="#cb68-526" aria-hidden="true" tabindex="-1"></a><span class="in">colours &lt;- c("#BD241E", "#F9B921", "#267226", "#A18A33", "#722672","#15274D")</span></span>
<span id="cb68-527"><a href="#cb68-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-528"><a href="#cb68-528" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(res.ind, aes(x=Subcorpus,y=PC1, fill = Subcorpus, colour = Subcorpus))+ # Or leave out "colour = Register" to keep the dots in black</span></span>
<span id="cb68-529"><a href="#cb68-529" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 2, trim = FALSE)+</span></span>
<span id="cb68-530"><a href="#cb68-530" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(position = position_jitter(width = .15), size = .25)+</span></span>
<span id="cb68-531"><a href="#cb68-531" aria-hidden="true" tabindex="-1"></a><span class="in"># note that here we need to set the x-variable to a numeric variable and bump it to get the boxplots to line up with the rainclouds. </span></span>
<span id="cb68-532"><a href="#cb68-532" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(x = as.numeric(Subcorpus)+0.25, y = PC1), outlier.shape = NA, alpha = 0.3, width = .15, colour = "BLACK") +</span></span>
<span id="cb68-533"><a href="#cb68-533" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab('PC1')+ </span></span>
<span id="cb68-534"><a href="#cb68-534" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_cowplot()+</span></span>
<span id="cb68-535"><a href="#cb68-535" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.title.x=element_blank())+</span></span>
<span id="cb68-536"><a href="#cb68-536" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(fill = "none", colour = "none") +</span></span>
<span id="cb68-537"><a href="#cb68-537" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_colour_manual(values = colours)+</span></span>
<span id="cb68-538"><a href="#cb68-538" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = colours) +</span></span>
<span id="cb68-539"><a href="#cb68-539" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "text", x = 1.5, y = -7, label = "Conversation", size = 5) +</span></span>
<span id="cb68-540"><a href="#cb68-540" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "segment", x = 0.7, xend = 2.5, y = -6.5, yend = -6.5) +</span></span>
<span id="cb68-541"><a href="#cb68-541" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "text", x = 3.5, y = -7, label = "Fiction", size = 5) +</span></span>
<span id="cb68-542"><a href="#cb68-542" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "segment", x = 2.7, xend = 4.5, y = -6.5, yend = -6.5) +</span></span>
<span id="cb68-543"><a href="#cb68-543" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "text", x = 5.7, y = -7, label = "Informative", size = 5) +</span></span>
<span id="cb68-544"><a href="#cb68-544" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "segment", x = 4.7, xend = 6.5, y = -6.5, yend = -6.5) +</span></span>
<span id="cb68-545"><a href="#cb68-545" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels=rep(c("Reference", "Textbook"), 3))+</span></span>
<span id="cb68-546"><a href="#cb68-546" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(sec.axis = dup_axis(name=NULL), breaks = seq(from = -6, to = 5, by = 1))</span></span>
<span id="cb68-547"><a href="#cb68-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-548"><a href="#cb68-548" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "PC1_3RegComparison.svg"), width = 13, height = 8)</span></span>
<span id="cb68-549"><a href="#cb68-549" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "PC1_3RegComparison.png"), width = 20, height = 15, units = "cm", dpi = 300)</span></span>
<span id="cb68-550"><a href="#cb68-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-551"><a href="#cb68-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-552"><a href="#cb68-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-553"><a href="#cb68-553" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computing mixed-effects models of the dimension scores</span></span>
<span id="cb68-554"><a href="#cb68-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-555"><a href="#cb68-555" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data preparation</span></span>
<span id="cb68-556"><a href="#cb68-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-557"><a href="#cb68-557" aria-hidden="true" tabindex="-1"></a>In this chunk, we add a <span class="in">`Source`</span> variable to be used as a random effect variable in the following mixed-effects models (see 5.3.8 for details).</span>
<span id="cb68-558"><a href="#cb68-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-559"><a href="#cb68-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r source-variable}</span></span>
<span id="cb68-560"><a href="#cb68-560" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-561"><a href="#cb68-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-562"><a href="#cb68-562" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind &lt;- res.ind |&gt; </span></span>
<span id="cb68-563"><a href="#cb68-563" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Source = case_when(</span></span>
<span id="cb68-564"><a href="#cb68-564" aria-hidden="true" tabindex="-1"></a><span class="in">  Corpus=="Youth.Fiction" ~ paste("Book", str_extract(Filename, "[0-9]{1,3}"), sep = ""),</span></span>
<span id="cb68-565"><a href="#cb68-565" aria-hidden="true" tabindex="-1"></a><span class="in">  Corpus=="Spoken.BNC2014" ~ "Spoken.BNC2014",</span></span>
<span id="cb68-566"><a href="#cb68-566" aria-hidden="true" tabindex="-1"></a><span class="in">  Corpus=="Textbook.English" ~ as.character(Series),</span></span>
<span id="cb68-567"><a href="#cb68-567" aria-hidden="true" tabindex="-1"></a><span class="in">  Corpus=="Informative.Teens" ~ str_extract(Filename, "BBC|Science_Tech"),</span></span>
<span id="cb68-568"><a href="#cb68-568" aria-hidden="true" tabindex="-1"></a><span class="in">  TRUE ~ "NA")) |&gt; </span></span>
<span id="cb68-569"><a href="#cb68-569" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Source = case_when(</span></span>
<span id="cb68-570"><a href="#cb68-570" aria-hidden="true" tabindex="-1"></a><span class="in">  Corpus=="Informative.Teens" &amp; is.na(Source) ~ str_remove(Filename, "_.*"),</span></span>
<span id="cb68-571"><a href="#cb68-571" aria-hidden="true" tabindex="-1"></a><span class="in">  TRUE ~ as.character(Source))) |&gt; </span></span>
<span id="cb68-572"><a href="#cb68-572" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Source = as.factor(Source)) |&gt; </span></span>
<span id="cb68-573"><a href="#cb68-573" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Corpus = case_when(</span></span>
<span id="cb68-574"><a href="#cb68-574" aria-hidden="true" tabindex="-1"></a><span class="in">    Corpus=="Textbook.English" ~ "Textbook",</span></span>
<span id="cb68-575"><a href="#cb68-575" aria-hidden="true" tabindex="-1"></a><span class="in">    Corpus=="Informative.Teens" ~ "Reference",</span></span>
<span id="cb68-576"><a href="#cb68-576" aria-hidden="true" tabindex="-1"></a><span class="in">    Corpus=="Spoken.BNC2014" ~ "Reference",</span></span>
<span id="cb68-577"><a href="#cb68-577" aria-hidden="true" tabindex="-1"></a><span class="in">    Corpus=="Youth.Fiction" ~ "Reference"</span></span>
<span id="cb68-578"><a href="#cb68-578" aria-hidden="true" tabindex="-1"></a><span class="in">  )) |&gt; </span></span>
<span id="cb68-579"><a href="#cb68-579" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Corpus = as.factor(Corpus))</span></span>
<span id="cb68-580"><a href="#cb68-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-581"><a href="#cb68-581" aria-hidden="true" tabindex="-1"></a><span class="in"># Change the reference levels to theoretically more meaningful levels and one that is better populated (see, e.g., https://stats.stackexchange.com/questions/430770/in-a-multilevel-linear-regression-how-does-the-reference-level-affect-other-lev)</span></span>
<span id="cb68-582"><a href="#cb68-582" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(res.ind$Corpus)</span></span>
<span id="cb68-583"><a href="#cb68-583" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind$Corpus &lt;- relevel(res.ind$Corpus, "Reference")</span></span>
<span id="cb68-584"><a href="#cb68-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-585"><a href="#cb68-585" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(res.ind$Subcorpus)</span></span>
<span id="cb68-586"><a href="#cb68-586" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind$Subcorpus &lt;- factor(res.ind$Subcorpus, levels = c("Spoken BNC2014 Ref.", "Textbook Conversation", "Youth Fiction Ref.", "Textbook Fiction", "Info Teens Ref.", "Textbook Informative"))</span></span>
<span id="cb68-587"><a href="#cb68-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-588"><a href="#cb68-588" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(res.ind$Level)</span></span>
<span id="cb68-589"><a href="#cb68-589" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind$Level &lt;- relevel(res.ind$Level, "Ref.")</span></span>
<span id="cb68-590"><a href="#cb68-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-591"><a href="#cb68-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-592"><a href="#cb68-592" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 1: 'Spontaneous interactional vs. Edited informational'</span></span>
<span id="cb68-593"><a href="#cb68-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-594"><a href="#cb68-594" aria-hidden="true" tabindex="-1"></a>We first compare various models and then present a tabular summary of the best-fitting one.</span>
<span id="cb68-595"><a href="#cb68-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-596"><a href="#cb68-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PC1-models}</span></span>
<span id="cb68-597"><a href="#cb68-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-598"><a href="#cb68-598" aria-hidden="true" tabindex="-1"></a><span class="in">md_source &lt;- lmer(PC1 ~ 1 + (Register|Source), res.ind, REML = FALSE) </span></span>
<span id="cb68-599"><a href="#cb68-599" aria-hidden="true" tabindex="-1"></a><span class="in">md_corpus &lt;- update(md_source, .~. + Level) # Failed to converge</span></span>
<span id="cb68-600"><a href="#cb68-600" aria-hidden="true" tabindex="-1"></a><span class="in">md_register &lt;- update(md_source, . ~ . + Register)</span></span>
<span id="cb68-601"><a href="#cb68-601" aria-hidden="true" tabindex="-1"></a><span class="in">md_both &lt;- update(md_corpus, .~. + Register)</span></span>
<span id="cb68-602"><a href="#cb68-602" aria-hidden="true" tabindex="-1"></a><span class="in">md_interaction &lt;- update(md_both, . ~ . + Level:Register)</span></span>
<span id="cb68-603"><a href="#cb68-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-604"><a href="#cb68-604" aria-hidden="true" tabindex="-1"></a><span class="in">anova(md_source, md_corpus, md_register, md_both, md_interaction)</span></span>
<span id="cb68-605"><a href="#cb68-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-606"><a href="#cb68-606" aria-hidden="true" tabindex="-1"></a><span class="in">md_interaction &lt;- lmer(PC1 ~ Level + Register + Level*Register + (Register|Source), res.ind, REML = FALSE) </span></span>
<span id="cb68-607"><a href="#cb68-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-608"><a href="#cb68-608" aria-hidden="true" tabindex="-1"></a><span class="in">tab_model(md_interaction, wrap.labels = 200) # R2 = 0.870 / 0.923</span></span>
<span id="cb68-609"><a href="#cb68-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-610"><a href="#cb68-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-611"><a href="#cb68-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-612"><a href="#cb68-612" aria-hidden="true" tabindex="-1"></a>Its estimated coefficients are visualised in the plot below.</span>
<span id="cb68-613"><a href="#cb68-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-616"><a href="#cb68-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-617"><a href="#cb68-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim1fixed</span></span>
<span id="cb68-618"><a href="#cb68-618" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-619"><a href="#cb68-619" aria-hidden="true" tabindex="-1"></a><span class="co"># Tweak plot aesthetics with: https://cran.r-project.org/web/packages/sjPlot/vignettes/custplot.html</span></span>
<span id="cb68-620"><a href="#cb68-620" aria-hidden="true" tabindex="-1"></a><span class="co"># Colour customisation trick from: https://stackoverflow.com/questions/55598920/different-line-colors-in-forest-plot-output-from-sjplot-r-package</span></span>
<span id="cb68-621"><a href="#cb68-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-622"><a href="#cb68-622" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md_interaction, </span>
<span id="cb68-623"><a href="#cb68-623" aria-hidden="true" tabindex="-1"></a>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span id="cb68-624"><a href="#cb68-624" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-625"><a href="#cb68-625" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb68-626"><a href="#cb68-626" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb68-627"><a href="#cb68-627" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb68-628"><a href="#cb68-628" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb68-629"><a href="#cb68-629" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)],</span>
<span id="cb68-630"><a href="#cb68-630" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb68-631"><a href="#cb68-631" aria-hidden="true" tabindex="-1"></a>           <span class="at">title=</span><span class="st">"Fixed effects"</span>,</span>
<span id="cb68-632"><a href="#cb68-632" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb68-633"><a href="#cb68-633" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC1 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb68-634"><a href="#cb68-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb68-635"><a href="#cb68-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-636"><a href="#cb68-636" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC1_lmer_fixed.svg"), height = 6, width = 9)</span></span>
<span id="cb68-637"><a href="#cb68-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-638"><a href="#cb68-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-639"><a href="#cb68-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-640"><a href="#cb68-640" aria-hidden="true" tabindex="-1"></a>The <span class="in">`visreg`</span> function is used to visualise the distributions of the modelled Dim1 scores:</span>
<span id="cb68-641"><a href="#cb68-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-644"><a href="#cb68-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-645"><a href="#cb68-645" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim1estimateplots</span></span>
<span id="cb68-646"><a href="#cb68-646" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-647"><a href="#cb68-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb68-648"><a href="#cb68-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb68-649"><a href="#cb68-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-650"><a href="#cb68-650" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC1_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span id="cb68-651"><a href="#cb68-651" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md_interaction, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Register"</span>, </span>
<span id="cb68-652"><a href="#cb68-652" aria-hidden="true" tabindex="-1"></a>       <span class="co">#type = "contrast",</span></span>
<span id="cb68-653"><a href="#cb68-653" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">"conditional"</span>,</span>
<span id="cb68-654"><a href="#cb68-654" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), </span>
<span id="cb68-655"><a href="#cb68-655" aria-hidden="true" tabindex="-1"></a>       <span class="at">points=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.3</span>),</span>
<span id="cb68-656"><a href="#cb68-656" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, <span class="at">ylab =</span> <span class="st">"PC1"</span>,</span>
<span id="cb68-657"><a href="#cb68-657" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb68-658"><a href="#cb68-658" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-659"><a href="#cb68-659" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb68-660"><a href="#cb68-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-661"><a href="#cb68-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-662"><a href="#cb68-662" aria-hidden="true" tabindex="-1"></a>For PC2 to PC4, the models with random intercepts and slopes failed to converge, which is why only slopes are included in the following models.</span>
<span id="cb68-663"><a href="#cb68-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-664"><a href="#cb68-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model-comparison-function}</span></span>
<span id="cb68-665"><a href="#cb68-665" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-666"><a href="#cb68-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-667"><a href="#cb68-667" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to avoid repeating model fitting and comparison process for each PC.</span></span>
<span id="cb68-668"><a href="#cb68-668" aria-hidden="true" tabindex="-1"></a><span class="in">run_anova &lt;- function(response_var, data) {</span></span>
<span id="cb68-669"><a href="#cb68-669" aria-hidden="true" tabindex="-1"></a><span class="in">  # Fit the initial model</span></span>
<span id="cb68-670"><a href="#cb68-670" aria-hidden="true" tabindex="-1"></a><span class="in">  md_source &lt;- lmer(formula = paste(response_var, "~ 1 + (1|Source)"), data = data, REML = FALSE)</span></span>
<span id="cb68-671"><a href="#cb68-671" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-672"><a href="#cb68-672" aria-hidden="true" tabindex="-1"></a><span class="in">  # Update models</span></span>
<span id="cb68-673"><a href="#cb68-673" aria-hidden="true" tabindex="-1"></a><span class="in">  md_corpus &lt;- update(md_source, . ~ . + Level)</span></span>
<span id="cb68-674"><a href="#cb68-674" aria-hidden="true" tabindex="-1"></a><span class="in">  md_register &lt;- update(md_source, . ~ . + Register)</span></span>
<span id="cb68-675"><a href="#cb68-675" aria-hidden="true" tabindex="-1"></a><span class="in">  md_both &lt;- update(md_corpus, . ~ . + Register)</span></span>
<span id="cb68-676"><a href="#cb68-676" aria-hidden="true" tabindex="-1"></a><span class="in">  md_interaction &lt;- update(md_both, . ~ . + Level:Register)</span></span>
<span id="cb68-677"><a href="#cb68-677" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-678"><a href="#cb68-678" aria-hidden="true" tabindex="-1"></a><span class="in">  # Perform ANOVA</span></span>
<span id="cb68-679"><a href="#cb68-679" aria-hidden="true" tabindex="-1"></a><span class="in">  anova_results &lt;- anova(md_source, md_corpus, md_register, md_both, md_interaction)</span></span>
<span id="cb68-680"><a href="#cb68-680" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-681"><a href="#cb68-681" aria-hidden="true" tabindex="-1"></a><span class="in">  # Print ANOVA results</span></span>
<span id="cb68-682"><a href="#cb68-682" aria-hidden="true" tabindex="-1"></a><span class="in">  print(anova_results)</span></span>
<span id="cb68-683"><a href="#cb68-683" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-684"><a href="#cb68-684" aria-hidden="true" tabindex="-1"></a><span class="in">  # Save model object with appropriate name</span></span>
<span id="cb68-685"><a href="#cb68-685" aria-hidden="true" tabindex="-1"></a><span class="in">  pc_number &lt;- gsub("PC", "", response_var)</span></span>
<span id="cb68-686"><a href="#cb68-686" aria-hidden="true" tabindex="-1"></a><span class="in">  assign(paste("md_interaction_PC", pc_number, sep = ""), md_interaction, envir = .GlobalEnv)</span></span>
<span id="cb68-687"><a href="#cb68-687" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-688"><a href="#cb68-688" aria-hidden="true" tabindex="-1"></a><span class="in">  # Return tabulated model</span></span>
<span id="cb68-689"><a href="#cb68-689" aria-hidden="true" tabindex="-1"></a><span class="in">  return(md_interaction)</span></span>
<span id="cb68-690"><a href="#cb68-690" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb68-691"><a href="#cb68-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-692"><a href="#cb68-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-693"><a href="#cb68-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-694"><a href="#cb68-694" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 2: 'Narrative vs. Non-narrative'</span></span>
<span id="cb68-695"><a href="#cb68-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-696"><a href="#cb68-696" aria-hidden="true" tabindex="-1"></a>We first compare various models and then present a tabular summary of the best-fitting one.</span>
<span id="cb68-697"><a href="#cb68-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-698"><a href="#cb68-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PC2-results-lmer-plots}</span></span>
<span id="cb68-699"><a href="#cb68-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-700"><a href="#cb68-700" aria-hidden="true" tabindex="-1"></a><span class="in">PC2_models &lt;- run_anova("PC2", res.ind)</span></span>
<span id="cb68-701"><a href="#cb68-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-702"><a href="#cb68-702" aria-hidden="true" tabindex="-1"></a><span class="in">tab_model(md_interaction_PC2) # R2 = 0.671 / 0.753</span></span>
<span id="cb68-703"><a href="#cb68-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-704"><a href="#cb68-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-705"><a href="#cb68-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-706"><a href="#cb68-706" aria-hidden="true" tabindex="-1"></a>Visualisation of the coefficient estimates of the fixed effects:</span>
<span id="cb68-707"><a href="#cb68-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-710"><a href="#cb68-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-711"><a href="#cb68-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim2fixed</span></span>
<span id="cb68-712"><a href="#cb68-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-713"><a href="#cb68-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-714"><a href="#cb68-714" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md_interaction_PC2, </span>
<span id="cb68-715"><a href="#cb68-715" aria-hidden="true" tabindex="-1"></a>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span id="cb68-716"><a href="#cb68-716" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-717"><a href="#cb68-717" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb68-718"><a href="#cb68-718" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb68-719"><a href="#cb68-719" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb68-720"><a href="#cb68-720" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb68-721"><a href="#cb68-721" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)],</span>
<span id="cb68-722"><a href="#cb68-722" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb68-723"><a href="#cb68-723" aria-hidden="true" tabindex="-1"></a>           <span class="at">title=</span><span class="st">"Fixed effects"</span>,</span>
<span id="cb68-724"><a href="#cb68-724" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb68-725"><a href="#cb68-725" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC2 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb68-726"><a href="#cb68-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb68-727"><a href="#cb68-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-728"><a href="#cb68-728" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC2_lmer_fixed.svg"), height = 6, width = 9)</span></span>
<span id="cb68-729"><a href="#cb68-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-730"><a href="#cb68-730" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-731"><a href="#cb68-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-732"><a href="#cb68-732" aria-hidden="true" tabindex="-1"></a>Visualisation of the predicted Dim2 scores:</span>
<span id="cb68-733"><a href="#cb68-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-736"><a href="#cb68-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-737"><a href="#cb68-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim2estimateplots</span></span>
<span id="cb68-738"><a href="#cb68-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-739"><a href="#cb68-739" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb68-740"><a href="#cb68-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb68-741"><a href="#cb68-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-742"><a href="#cb68-742" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC2_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span id="cb68-743"><a href="#cb68-743" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md_interaction_PC2, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Register"</span>, </span>
<span id="cb68-744"><a href="#cb68-744" aria-hidden="true" tabindex="-1"></a>       <span class="co">#type = "contrast",</span></span>
<span id="cb68-745"><a href="#cb68-745" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">"conditional"</span>,</span>
<span id="cb68-746"><a href="#cb68-746" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), </span>
<span id="cb68-747"><a href="#cb68-747" aria-hidden="true" tabindex="-1"></a>       <span class="at">points=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.3</span>),</span>
<span id="cb68-748"><a href="#cb68-748" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>,</span>
<span id="cb68-749"><a href="#cb68-749" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb68-750"><a href="#cb68-750" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-751"><a href="#cb68-751" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb68-752"><a href="#cb68-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-753"><a href="#cb68-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-754"><a href="#cb68-754" aria-hidden="true" tabindex="-1"></a>We can also explore the random effect structure.</span>
<span id="cb68-755"><a href="#cb68-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-758"><a href="#cb68-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-759"><a href="#cb68-759" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effects</span></span>
<span id="cb68-760"><a href="#cb68-760" aria-hidden="true" tabindex="-1"></a>ranef <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ranef</span>(md_interaction_PC2))</span>
<span id="cb68-761"><a href="#cb68-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-762"><a href="#cb68-762" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the random effects of the sources of the Info Teens corpus</span></span>
<span id="cb68-763"><a href="#cb68-763" aria-hidden="true" tabindex="-1"></a>ranef <span class="sc">|&gt;</span> </span>
<span id="cb68-764"><a href="#cb68-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"TeenVogue"</span>, <span class="st">"BBC"</span>, <span class="st">"Dogo"</span>, <span class="st">"Ducksters"</span>, <span class="st">"Encyclopedia"</span>, <span class="st">"Factmonster"</span>, <span class="st">"History"</span>, <span class="st">"Quatr"</span>, <span class="st">"Revision"</span>, <span class="st">"Science"</span>, <span class="st">"Science_Tech"</span>, <span class="st">"Teen"</span>, <span class="st">"TweenTribute"</span>, <span class="st">"WhyFiles"</span>, <span class="st">"World"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb68-765"><a href="#cb68-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> condval)) <span class="sc">+</span></span>
<span id="cb68-766"><a href="#cb68-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-767"><a href="#cb68-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb68-768"><a href="#cb68-768" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-769"><a href="#cb68-769" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the random effects associated with textbook series</span></span>
<span id="cb68-770"><a href="#cb68-770" aria-hidden="true" tabindex="-1"></a>ranef <span class="sc">|&gt;</span> </span>
<span id="cb68-771"><a href="#cb68-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">%in%</span> <span class="fu">levels</span>(data<span class="sc">$</span>Series)) <span class="sc">|&gt;</span> </span>
<span id="cb68-772"><a href="#cb68-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> condval)) <span class="sc">+</span></span>
<span id="cb68-773"><a href="#cb68-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-774"><a href="#cb68-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb68-775"><a href="#cb68-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-776"><a href="#cb68-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-777"><a href="#cb68-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-778"><a href="#cb68-778" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 3: 'Pedagogically adapted vs. Natural'</span></span>
<span id="cb68-779"><a href="#cb68-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-780"><a href="#cb68-780" aria-hidden="true" tabindex="-1"></a>We first compare various models and then present a tabular summary of the best-fitting one.</span>
<span id="cb68-781"><a href="#cb68-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-782"><a href="#cb68-782" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PC3-results-lmer-plots}</span></span>
<span id="cb68-783"><a href="#cb68-783" aria-hidden="true" tabindex="-1"></a><span class="in">PC3_models &lt;- run_anova("PC3", res.ind)</span></span>
<span id="cb68-784"><a href="#cb68-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-785"><a href="#cb68-785" aria-hidden="true" tabindex="-1"></a><span class="in">tab_model(md_interaction_PC3) # R2 = 0.425 / 0.700</span></span>
<span id="cb68-786"><a href="#cb68-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-787"><a href="#cb68-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-788"><a href="#cb68-788" aria-hidden="true" tabindex="-1"></a>Visualisation of the coefficient estimates of the fixed effects:</span>
<span id="cb68-789"><a href="#cb68-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-792"><a href="#cb68-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-793"><a href="#cb68-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim3fixed</span></span>
<span id="cb68-794"><a href="#cb68-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-795"><a href="#cb68-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb68-796"><a href="#cb68-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-797"><a href="#cb68-797" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md_interaction_PC3, </span>
<span id="cb68-798"><a href="#cb68-798" aria-hidden="true" tabindex="-1"></a>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span id="cb68-799"><a href="#cb68-799" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-800"><a href="#cb68-800" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb68-801"><a href="#cb68-801" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb68-802"><a href="#cb68-802" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb68-803"><a href="#cb68-803" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb68-804"><a href="#cb68-804" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)],</span>
<span id="cb68-805"><a href="#cb68-805" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb68-806"><a href="#cb68-806" aria-hidden="true" tabindex="-1"></a>           <span class="at">title=</span><span class="st">"Fixed effects"</span>,</span>
<span id="cb68-807"><a href="#cb68-807" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb68-808"><a href="#cb68-808" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC3 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb68-809"><a href="#cb68-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb68-810"><a href="#cb68-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-811"><a href="#cb68-811" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC3_lmer_fixed.svg"), height = 6, width = 9)</span></span>
<span id="cb68-812"><a href="#cb68-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-813"><a href="#cb68-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-814"><a href="#cb68-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-815"><a href="#cb68-815" aria-hidden="true" tabindex="-1"></a>Visualisation of the predicted Dim3 scores:</span>
<span id="cb68-816"><a href="#cb68-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-819"><a href="#cb68-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-820"><a href="#cb68-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim3estimateplots</span></span>
<span id="cb68-821"><a href="#cb68-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-822"><a href="#cb68-822" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb68-823"><a href="#cb68-823" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb68-824"><a href="#cb68-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-825"><a href="#cb68-825" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC3_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span id="cb68-826"><a href="#cb68-826" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md_interaction_PC3, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Register"</span>, </span>
<span id="cb68-827"><a href="#cb68-827" aria-hidden="true" tabindex="-1"></a>       <span class="co">#type = "contrast",</span></span>
<span id="cb68-828"><a href="#cb68-828" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">"conditional"</span>,</span>
<span id="cb68-829"><a href="#cb68-829" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), </span>
<span id="cb68-830"><a href="#cb68-830" aria-hidden="true" tabindex="-1"></a>       <span class="at">points=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.3</span>),</span>
<span id="cb68-831"><a href="#cb68-831" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, <span class="at">ylab =</span> <span class="st">"PC3"</span>,</span>
<span id="cb68-832"><a href="#cb68-832" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb68-833"><a href="#cb68-833" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-834"><a href="#cb68-834" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb68-835"><a href="#cb68-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-836"><a href="#cb68-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-837"><a href="#cb68-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-838"><a href="#cb68-838" aria-hidden="true" tabindex="-1"></a>We can also explore the random effect structure.</span>
<span id="cb68-839"><a href="#cb68-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-842"><a href="#cb68-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-843"><a href="#cb68-843" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effects</span></span>
<span id="cb68-844"><a href="#cb68-844" aria-hidden="true" tabindex="-1"></a>ranef <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ranef</span>(md_interaction_PC3))</span>
<span id="cb68-845"><a href="#cb68-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-846"><a href="#cb68-846" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the random effects of the sources of the Info Teens corpus</span></span>
<span id="cb68-847"><a href="#cb68-847" aria-hidden="true" tabindex="-1"></a>ranef <span class="sc">|&gt;</span> </span>
<span id="cb68-848"><a href="#cb68-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"TeenVogue"</span>, <span class="st">"BBC"</span>, <span class="st">"Dogo"</span>, <span class="st">"Ducksters"</span>, <span class="st">"Encyclopedia"</span>, <span class="st">"Factmonster"</span>, <span class="st">"History"</span>, <span class="st">"Quatr"</span>, <span class="st">"Revision"</span>, <span class="st">"Science"</span>, <span class="st">"Science_Tech"</span>, <span class="st">"Teen"</span>, <span class="st">"TweenTribute"</span>, <span class="st">"WhyFiles"</span>, <span class="st">"World"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb68-849"><a href="#cb68-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> condval)) <span class="sc">+</span></span>
<span id="cb68-850"><a href="#cb68-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-851"><a href="#cb68-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb68-852"><a href="#cb68-852" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-853"><a href="#cb68-853" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the random effects associated with textbook series</span></span>
<span id="cb68-854"><a href="#cb68-854" aria-hidden="true" tabindex="-1"></a>ranef <span class="sc">|&gt;</span> </span>
<span id="cb68-855"><a href="#cb68-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">%in%</span> <span class="fu">levels</span>(data<span class="sc">$</span>Series)) <span class="sc">|&gt;</span> </span>
<span id="cb68-856"><a href="#cb68-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> condval)) <span class="sc">+</span></span>
<span id="cb68-857"><a href="#cb68-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-858"><a href="#cb68-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb68-859"><a href="#cb68-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-860"><a href="#cb68-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-861"><a href="#cb68-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-862"><a href="#cb68-862" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 4: 'Factual vs. Speculative' / 'Simple vs. complex verb forms'?</span></span>
<span id="cb68-863"><a href="#cb68-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-864"><a href="#cb68-864" aria-hidden="true" tabindex="-1"></a>We first compare various models and then present a tabular summary of the best-fitting one.</span>
<span id="cb68-865"><a href="#cb68-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-866"><a href="#cb68-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PC4-results-lmer-plots}</span></span>
<span id="cb68-867"><a href="#cb68-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-868"><a href="#cb68-868" aria-hidden="true" tabindex="-1"></a><span class="in">PC4_models &lt;- run_anova("PC4", res.ind)</span></span>
<span id="cb68-869"><a href="#cb68-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-870"><a href="#cb68-870" aria-hidden="true" tabindex="-1"></a><span class="in">tab_model(md_interaction_PC4) # R2 = 0.234 / 0.434</span></span>
<span id="cb68-871"><a href="#cb68-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-872"><a href="#cb68-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-873"><a href="#cb68-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-874"><a href="#cb68-874" aria-hidden="true" tabindex="-1"></a>Visualisation of the coefficient estimates of the fixed effects:</span>
<span id="cb68-875"><a href="#cb68-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-878"><a href="#cb68-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-879"><a href="#cb68-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim4fixed</span></span>
<span id="cb68-880"><a href="#cb68-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-881"><a href="#cb68-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb68-882"><a href="#cb68-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-883"><a href="#cb68-883" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md_interaction_PC4, </span>
<span id="cb68-884"><a href="#cb68-884" aria-hidden="true" tabindex="-1"></a>           <span class="co">#type = "re", # Option to visualise random effects </span></span>
<span id="cb68-885"><a href="#cb68-885" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-886"><a href="#cb68-886" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb68-887"><a href="#cb68-887" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb68-888"><a href="#cb68-888" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb68-889"><a href="#cb68-889" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb68-890"><a href="#cb68-890" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)],</span>
<span id="cb68-891"><a href="#cb68-891" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb68-892"><a href="#cb68-892" aria-hidden="true" tabindex="-1"></a>           <span class="at">title=</span><span class="st">"Fixed effects"</span>,</span>
<span id="cb68-893"><a href="#cb68-893" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb68-894"><a href="#cb68-894" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC4 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb68-895"><a href="#cb68-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb68-896"><a href="#cb68-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-897"><a href="#cb68-897" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxBRef3Reg_PC4_lmer_fixed.svg"), height = 6, width = 9)</span></span>
<span id="cb68-898"><a href="#cb68-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-899"><a href="#cb68-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-900"><a href="#cb68-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-901"><a href="#cb68-901" aria-hidden="true" tabindex="-1"></a>Visualisation of the predicted Dim4 scores:</span>
<span id="cb68-902"><a href="#cb68-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-905"><a href="#cb68-905" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-906"><a href="#cb68-906" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim4estimateplots</span></span>
<span id="cb68-907"><a href="#cb68-907" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb68-908"><a href="#cb68-908" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb68-909"><a href="#cb68-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb68-910"><a href="#cb68-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-911"><a href="#cb68-911" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxBReg3Reg_predicted_PC4_scores_interactions.svg"), height = 8, width = 9)</span></span>
<span id="cb68-912"><a href="#cb68-912" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md_interaction_PC4, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Register"</span>, </span>
<span id="cb68-913"><a href="#cb68-913" aria-hidden="true" tabindex="-1"></a>       <span class="co">#type = "contrast",</span></span>
<span id="cb68-914"><a href="#cb68-914" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">"conditional"</span>,</span>
<span id="cb68-915"><a href="#cb68-915" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), </span>
<span id="cb68-916"><a href="#cb68-916" aria-hidden="true" tabindex="-1"></a>       <span class="at">points=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.3</span>),</span>
<span id="cb68-917"><a href="#cb68-917" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Ref. corpora and textbook level (A to E)"</span>, <span class="at">ylab =</span> <span class="st">"PC4"</span>,</span>
<span id="cb68-918"><a href="#cb68-918" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb68-919"><a href="#cb68-919" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-920"><a href="#cb68-920" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb68-921"><a href="#cb68-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-922"><a href="#cb68-922" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-923"><a href="#cb68-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-924"><a href="#cb68-924" aria-hidden="true" tabindex="-1"></a>We can also explore the random effect structure.</span>
<span id="cb68-925"><a href="#cb68-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-928"><a href="#cb68-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-929"><a href="#cb68-929" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effects</span></span>
<span id="cb68-930"><a href="#cb68-930" aria-hidden="true" tabindex="-1"></a>ranef <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ranef</span>(md_interaction_PC4))</span>
<span id="cb68-931"><a href="#cb68-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-932"><a href="#cb68-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the random effects of the sources of the Info Teens corpus</span></span>
<span id="cb68-933"><a href="#cb68-933" aria-hidden="true" tabindex="-1"></a>ranef <span class="sc">|&gt;</span> </span>
<span id="cb68-934"><a href="#cb68-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"TeenVogue"</span>, <span class="st">"BBC"</span>, <span class="st">"Dogo"</span>, <span class="st">"Ducksters"</span>, <span class="st">"Encyclopedia"</span>, <span class="st">"Factmonster"</span>, <span class="st">"History"</span>, <span class="st">"Quatr"</span>, <span class="st">"Revision"</span>, <span class="st">"Science"</span>, <span class="st">"Science_Tech"</span>, <span class="st">"Teen"</span>, <span class="st">"TweenTribute"</span>, <span class="st">"WhyFiles"</span>, <span class="st">"World"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb68-935"><a href="#cb68-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> condval)) <span class="sc">+</span></span>
<span id="cb68-936"><a href="#cb68-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-937"><a href="#cb68-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb68-938"><a href="#cb68-938" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-939"><a href="#cb68-939" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the random effects associated with textbook series</span></span>
<span id="cb68-940"><a href="#cb68-940" aria-hidden="true" tabindex="-1"></a>ranef <span class="sc">|&gt;</span> </span>
<span id="cb68-941"><a href="#cb68-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">%in%</span> <span class="fu">levels</span>(data<span class="sc">$</span>Series)) <span class="sc">|&gt;</span> </span>
<span id="cb68-942"><a href="#cb68-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> condval)) <span class="sc">+</span></span>
<span id="cb68-943"><a href="#cb68-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-944"><a href="#cb68-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb68-945"><a href="#cb68-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-946"><a href="#cb68-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-947"><a href="#cb68-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-948"><a href="#cb68-948" aria-hidden="true" tabindex="-1"></a><span class="fu">### Testing model assumptions</span></span>
<span id="cb68-949"><a href="#cb68-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-950"><a href="#cb68-950" aria-hidden="true" tabindex="-1"></a>This chunk can be used to check the assumptions of all of the models computed above. In the following example, we examine the final model selected to predict Dim2 scores.</span>
<span id="cb68-951"><a href="#cb68-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-952"><a href="#cb68-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lmer-diagnostics}</span></span>
<span id="cb68-953"><a href="#cb68-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-954"><a href="#cb68-954" aria-hidden="true" tabindex="-1"></a><span class="in">model2test &lt;- md_interaction_PC2</span></span>
<span id="cb68-955"><a href="#cb68-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-956"><a href="#cb68-956" aria-hidden="true" tabindex="-1"></a><span class="in"># check distribution of residuals</span></span>
<span id="cb68-957"><a href="#cb68-957" aria-hidden="true" tabindex="-1"></a><span class="in">plot(model2test)</span></span>
<span id="cb68-958"><a href="#cb68-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-959"><a href="#cb68-959" aria-hidden="true" tabindex="-1"></a><span class="in"># scale-location plot</span></span>
<span id="cb68-960"><a href="#cb68-960" aria-hidden="true" tabindex="-1"></a><span class="in">plot(model2test,</span></span>
<span id="cb68-961"><a href="#cb68-961" aria-hidden="true" tabindex="-1"></a><span class="in">     sqrt(abs(resid(.)))~fitted(.),</span></span>
<span id="cb68-962"><a href="#cb68-962" aria-hidden="true" tabindex="-1"></a><span class="in">     type=c("p","smooth"), col.line=1)</span></span>
<span id="cb68-963"><a href="#cb68-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-964"><a href="#cb68-964" aria-hidden="true" tabindex="-1"></a><span class="in"># Q-Q plot</span></span>
<span id="cb68-965"><a href="#cb68-965" aria-hidden="true" tabindex="-1"></a><span class="in">lattice::qqmath(model2test)</span></span>
<span id="cb68-966"><a href="#cb68-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-967"><a href="#cb68-967" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.elenlefoll.eu">Elen Le Foll</a></p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://benjamins.com/catalog/scl">Textbook English</a></p>
</div>
    <div class="nav-footer-right">
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a></p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","openEffect":"zoom","selector":".lightbox","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>