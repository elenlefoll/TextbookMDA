<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Elen Le Foll">
<title>Textbook English: A Multi-Dimensional Approach - Appendix D — Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./G_Ch7_Analysis.html" rel="next">
<link href="./E_Ch6_Analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./A_LitReview.html">Appendices</a></li><li class="breadcrumb-item"><a href="./F_Ch7_DataPrep.html"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Textbook English: A Multi-Dimensional Approach</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/elenlefoll/TextbookMDA/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Textbook-English--A-Multi-Dimensional-Approach.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./OpenScience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Open Science statement</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A_LitReview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix A: Literature review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B_CorpusData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Corpus data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./D_Ch6_DataPrep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Intra-Textbook Variation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./E_Ch6_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Intra-Textbook Variation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./F_Ch7_DataPrep.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./G_Ch7_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#packages-required" id="toc-packages-required" class="nav-link active" data-scroll-target="#packages-required"><span class="header-section-number">D.1</span> Packages required</a></li>
  <li>
<a href="#data-import-from-mfte-outputs" id="toc-data-import-from-mfte-outputs" class="nav-link" data-scroll-target="#data-import-from-mfte-outputs"><span class="header-section-number">D.2</span> Data import from MFTE outputs</a>
  <ul class="collapse">
<li><a href="#spoken-bnc2014" id="toc-spoken-bnc2014" class="nav-link" data-scroll-target="#spoken-bnc2014"><span class="header-section-number">D.2.1</span> Spoken BNC2014</a></li>
  <li><a href="#youth-fiction-corpus" id="toc-youth-fiction-corpus" class="nav-link" data-scroll-target="#youth-fiction-corpus"><span class="header-section-number">D.2.2</span> Youth Fiction corpus</a></li>
  <li><a href="#informative-texts-for-teens-infoteens-corpus" id="toc-informative-texts-for-teens-infoteens-corpus" class="nav-link" data-scroll-target="#informative-texts-for-teens-infoteens-corpus"><span class="header-section-number">D.2.3</span> Informative Texts for Teens (InfoTeens) corpus</a></li>
  </ul>
</li>
  <li>
<a href="#merging-tec-and-reference-corpora-data" id="toc-merging-tec-and-reference-corpora-data" class="nav-link" data-scroll-target="#merging-tec-and-reference-corpora-data"><span class="header-section-number">D.3</span> Merging TEC and reference corpora data</a>
  <ul class="collapse">
<li><a href="#corpus-size" id="toc-corpus-size" class="nav-link" data-scroll-target="#corpus-size"><span class="header-section-number">D.3.1</span> Corpus size</a></li>
  </ul>
</li>
  <li>
<a href="#data-preparation-for-pca" id="toc-data-preparation-for-pca" class="nav-link" data-scroll-target="#data-preparation-for-pca"><span class="header-section-number">D.4</span> Data preparation for PCA</a>
  <ul class="collapse">
<li><a href="#feature-distributions" id="toc-feature-distributions" class="nav-link" data-scroll-target="#feature-distributions"><span class="header-section-number">D.4.1</span> Feature distributions</a></li>
  <li><a href="#feature-removal" id="toc-feature-removal" class="nav-link" data-scroll-target="#feature-removal"><span class="header-section-number">D.4.2</span> Feature removal</a></li>
  <li><a href="#identifying-outlier-texts" id="toc-identifying-outlier-texts" class="nav-link" data-scroll-target="#identifying-outlier-texts"><span class="header-section-number">D.4.3</span> Identifying outlier texts</a></li>
  <li><a href="#signed-log-transformation" id="toc-signed-log-transformation" class="nav-link" data-scroll-target="#signed-log-transformation"><span class="header-section-number">D.4.4</span> Signed log transformation</a></li>
  <li><a href="#merging-of-data-for-mda" id="toc-merging-of-data-for-mda" class="nav-link" data-scroll-target="#merging-of-data-for-mda"><span class="header-section-number">D.4.5</span> Merging of data for MDA</a></li>
  </ul>
</li>
  <li>
<a href="#testing-factorability-of-data" id="toc-testing-factorability-of-data" class="nav-link" data-scroll-target="#testing-factorability-of-data"><span class="header-section-number">D.5</span> Testing factorability of data</a>
  <ul class="collapse">
<li><a href="#visualisation-of-feature-correlations" id="toc-visualisation-of-feature-correlations" class="nav-link" data-scroll-target="#visualisation-of-feature-correlations"><span class="header-section-number">D.5.1</span> Visualisation of feature correlations</a></li>
  <li><a href="#collinearity" id="toc-collinearity" class="nav-link" data-scroll-target="#collinearity"><span class="header-section-number">D.5.2</span> Collinearity</a></li>
  <li><a href="#msa" id="toc-msa" class="nav-link" data-scroll-target="#msa"><span class="header-section-number">D.5.3</span> MSA</a></li>
  <li><a href="#scree-plot" id="toc-scree-plot" class="nav-link" data-scroll-target="#scree-plot"><span class="header-section-number">D.5.4</span> Scree plot</a></li>
  <li><a href="#communalities" id="toc-communalities" class="nav-link" data-scroll-target="#communalities"><span class="header-section-number">D.5.5</span> Communalities</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./A_LitReview.html">Appendices</a></li><li class="breadcrumb-item"><a href="./F_Ch7_DataPrep.html"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Appendix D — Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>This script documents the steps taken to pre-process the data extracted from the Textbook English Corpus (TEC) and the three reference corpora that were ultimately entered in the comparative multi-dimensional model of Textbook English as compared to English outside the EFL classroom (Chapter 7).</p>
<section id="packages-required" class="level2" data-number="D.1"><h2 data-number="D.1" class="anchored" data-anchor-id="packages-required">
<span class="header-section-number">D.1</span> Packages required</h2>
<p>The following packages must be installed and loaded to process the data.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original thesis.</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed">broom.mixed</a></span><span class="op">)</span> <span class="co"># For checking singularity issues </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span> <span class="co"># For recoding data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span> <span class="co"># For the feature correlation matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co"># For nice plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span> <span class="co"># Comparing group means of predicted values</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span> <span class="co"># For ggpairs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span> <span class="co"># For making large faceted plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span> <span class="co"># For ease of sharing</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span> <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co"># For mixed effects modelling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span> <span class="co"># For various useful stats function, including KMO()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span> <span class="co"># For working with colours</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co"># For nice tabular display of regression models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># For data wrangling and plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbreheny.github.io/visreg">visreg</a></span><span class="op">)</span> <span class="co"># For nice visualisations of model results</span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="data-import-from-mfte-outputs" class="level2" data-number="D.2"><h2 data-number="D.2" class="anchored" data-anchor-id="data-import-from-mfte-outputs">
<span class="header-section-number">D.2</span> Data import from MFTE outputs</h2>
<p>The raw data used in this script comes from the matrices of mixed normalised frequencies as output by the <a href="https://github.com/mshakirDr/MultiFeatureTaggerEnglish">MFTE Perl v. 3.1</a> <span class="citation" data-cites="lefoll2021">(<a href="references.html#ref-lefoll2021" role="doc-biblioref">Le Foll 2021a</a>)</span>.</p>
<section id="spoken-bnc2014" class="level3" data-number="D.2.1"><h3 data-number="D.2.1" class="anchored" data-anchor-id="spoken-bnc2014">
<span class="header-section-number">D.2.1</span> Spoken BNC2014</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SpokenBNC2014</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"MFTE"</span>, <span class="st">"SpokenBNC2014_3.1_normed_complex_counts.tsv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Series</span> <span class="op">&lt;-</span> <span class="st">"Spoken BNC2014"</span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Level</span> <span class="op">&lt;-</span> <span class="st">"Ref."</span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Country</span> <span class="op">&lt;-</span> <span class="st">"Spoken BNC2014"</span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Register</span> <span class="op">&lt;-</span> <span class="st">"Spoken BNC2014"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These normalised frequencies were computed on the basis of my own “John and Jill in Ivybridge” version of the Spoken BNC2014 with added full stops at speaker turns (see Appendix B for details). This corpus comprises of 1,251 texts, all of which were used in the following analyses.</p>
</section><section id="youth-fiction-corpus" class="level3" data-number="D.2.2"><h3 data-number="D.2.2" class="anchored" data-anchor-id="youth-fiction-corpus">
<span class="header-section-number">D.2.2</span> Youth Fiction corpus</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">YouthFiction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"MFTE"</span>, <span class="st">"YF_sampled_500_3.1_normed_complex_counts.tsv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Series</span> <span class="op">&lt;-</span> <span class="st">"Youth Fiction"</span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Level</span> <span class="op">&lt;-</span> <span class="st">"Ref."</span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Country</span> <span class="op">&lt;-</span> <span class="st">"Youth Fiction"</span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Register</span> <span class="op">&lt;-</span> <span class="st">"Youth Fiction"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These normalised frequencies were computed on the basis of the random samples of approximately 5,000 words of the books of the Youth Fiction corpus (for details of the works included in this corpus, see Appendix B). The sampling procedure is described in Section 4.3.2.4 of the book. This dataset consists of 1,191 files.</p>
</section><section id="informative-texts-for-teens-infoteens-corpus" class="level3" data-number="D.2.3"><h3 data-number="D.2.3" class="anchored" data-anchor-id="informative-texts-for-teens-infoteens-corpus">
<span class="header-section-number">D.2.3</span> Informative Texts for Teens (InfoTeens) corpus</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">InfoTeen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"MFTE"</span>, <span class="st">"InfoTeen_3.1_normed_complex_counts.tsv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Removes three outlier files which should not have been included in the corpus as they contain exam papers only</span></span>
<span><span class="va">InfoTeen</span> <span class="op">&lt;-</span> <span class="va">InfoTeen</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Filename</span><span class="op">!=</span><span class="st">".DS_Store"</span> <span class="op">&amp;</span> <span class="va">Filename</span><span class="op">!=</span><span class="st">"Revision_World_GCSE_10529068_wjec-level-law-past-papers.txt"</span> <span class="op">&amp;</span> <span class="va">Filename</span><span class="op">!=</span><span class="st">"Revision_World_GCSE_10528474_wjec-level-history-past-papers.txt"</span> <span class="op">&amp;</span> <span class="va">Filename</span><span class="op">!=</span><span class="st">"Revision_World_GCSE_10528472_edexcel-level-history-past-papers.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Series</span> <span class="op">&lt;-</span> <span class="st">"Info Teens"</span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Level</span> <span class="op">&lt;-</span> <span class="st">"Ref."</span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Country</span> <span class="op">&lt;-</span> <span class="st">"Info Teens"</span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Register</span> <span class="op">&lt;-</span> <span class="st">"Info Teens"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Details of the composition of the Info Teens corpus can be found in Section 4.3.2.5 of the book. The version used in the present study comprises 1,411 texts.</p>
</section></section><section id="merging-tec-and-reference-corpora-data" class="level2" data-number="D.3"><h2 data-number="D.3" class="anchored" data-anchor-id="merging-tec-and-reference-corpora-data">
<span class="header-section-number">D.3</span> Merging TEC and reference corpora data</h2>
<section id="corpus-size" class="level3" data-number="D.3.1"><h3 data-number="D.3.1" class="anchored" data-anchor-id="corpus-size">
<span class="header-section-number">D.3.1</span> Corpus size</h3>
<p>These tables provide some summary statistics about the texts/files whose normalised feature frequencies were entered in the model of Textbook English vs.&nbsp;real-world English described in Chapter 7.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ncounts</span><span class="op">$</span><span class="va">Subcorpus</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(Sub)corpus"</span>, <span class="st">"# texts"</span><span class="op">)</span>,</span>
<span>        format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">(Sub)corpus</th>
<th style="text-align: right;"># texts</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: right;">593</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: right;">285</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Info Teens Ref.</td>
<td style="text-align: right;">1,411</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: right;">364</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spoken BNC2014 Ref.</td>
<td style="text-align: right;">1,251</td>
</tr>
<tr class="even">
<td style="text-align: left;">Youth Fiction Ref.</td>
<td style="text-align: right;">1,191</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ncounts</span>  <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Register</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>totaltexts <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            totalwords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Words</span><span class="op">)</span>, </span>
<span>            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Words</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Words</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            TTRmean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">TTR</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, </span>
<span>        format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>        col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Register"</span>, <span class="st">"# texts/files"</span>, <span class="st">"# words"</span>, <span class="st">"mean # words per text"</span>, <span class="st">"SD"</span>, <span class="st">"mean TTR"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 29%">
<col style="width: 8%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Register</th>
<th style="text-align: right;"># texts/files</th>
<th style="text-align: right;"># words</th>
<th style="text-align: right;">mean # words per text</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">mean TTR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">1,844</td>
<td style="text-align: right;">13,804,196</td>
<td style="text-align: right;">7,486</td>
<td style="text-align: right;">8,690</td>
<td style="text-align: right;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: right;">1,476</td>
<td style="text-align: right;">7,321,747</td>
<td style="text-align: right;">4,960</td>
<td style="text-align: right;">2,022</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1,775</td>
<td style="text-align: right;">1,436,732</td>
<td style="text-align: right;">809</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">0.51</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="data-preparation-for-pca" class="level2" data-number="D.4"><h2 data-number="D.4" class="anchored" data-anchor-id="data-preparation-for-pca">
<span class="header-section-number">D.4</span> Data preparation for PCA</h2>
<section id="feature-distributions" class="level3" data-number="D.4.1"><h3 data-number="D.4.1" class="anchored" data-anchor-id="feature-distributions">
<span class="header-section-number">D.4.1</span> Feature distributions</h3>
<p>The distributions of each linguistic features were examined by means of visualisation. As shown below, before transformation, many of the features displayed highly skewed distributions.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ncounts &lt;- readRDS(here("data", "processed", "counts3Reg.rds"))</span></span>
<span></span>
<span><span class="va">ncounts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Words</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, colour<span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkred"</span>, weight <span class="op">=</span> <span class="fl">2</span>, fill<span class="op">=</span><span class="st">"darkred"</span>, alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="F_Ch7_DataPrep_files/figure-html/distribution-viz-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="F_Ch7_DataPrep_files/figure-html/distribution-viz-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "DensityPlotsAllVariables.svg"), width = 15, height = 49)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="feature-removal" class="level3" data-number="D.4.2"><h3 data-number="D.4.2" class="anchored" data-anchor-id="feature-removal">
<span class="header-section-number">D.4.2</span> Feature removal</h3>
<p>A number of features were removed from the dataset as they are not linguistically interpretable. In the case of the TEC, this included the variable CD because numbers spelt out as digits were removed from the textbooks before these were tagged with the MFTE. In addition, the variables LIKE and SO because these are “bin” features included in the output of the MFTE to ensure that the counts for these polysemous words do not inflate other categories due to mistags <span class="citation" data-cites="lefoll2021a">(<a href="references.html#ref-lefoll2021a" role="doc-biblioref">Le Foll 2021b</a>)</span>.</p>
<p>Whenever linguistically meaningful, very low-frequency features, features with low MSA or communalities (see chunks below) were merged. Finally, features absent from more than third of texts were also excluded. For the comparative analysis of TEC and the reference corpora, the following linguistic features were excluded from the analysis due to low dispersion:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Removal of meaningless feature: CD because numbers as digits were mostly removed from the textbooks, LIKE and SO because they are dustbin categories</span></span>
<span><span class="va">ncounts</span> <span class="op">&lt;-</span> <span class="va">ncounts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">CD</span>, <span class="va">LIKE</span>, <span class="va">SO</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine problematic features into meaningful groups whenever this makes linguistic sense</span></span>
<span><span class="va">ncounts</span> <span class="op">&lt;-</span> <span class="va">ncounts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>JJPR <span class="op">=</span> <span class="va">JJPR</span> <span class="op">+</span> <span class="va">ABLE</span>, ABLE <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>PASS <span class="op">=</span> <span class="va">PGET</span> <span class="op">+</span> <span class="va">PASS</span>, PGET <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>TPP3 <span class="op">=</span> <span class="va">TPP3S</span> <span class="op">+</span> <span class="va">TPP3P</span>, TPP3P <span class="op">=</span> <span class="cn">NULL</span>, TPP3S <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Merged due to TTP3P having an individual MSA &lt; 0.5</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FQTI <span class="op">=</span> <span class="va">FREQ</span> <span class="op">+</span> <span class="va">TIME</span>, FREQ <span class="op">=</span> <span class="cn">NULL</span>, TIME <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># Merged due to TIME communality &lt; 0.2 (see below)</span></span>
<span></span>
<span><span class="co"># Function to compute percentage of texts with occurrences meeting a condition</span></span>
<span><span class="va">compute_percentage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">condition</span>, <span class="va">threshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">numeric_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Filter</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">condition</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">numeric_data</span>, <span class="va">is.numeric</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Percentage"</span></span>
<span>  <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="va">percentage</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Percentage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">Percentage</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">threshold</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="va">percentage</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Percentage</span> <span class="op">&gt;</span> <span class="va">threshold</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate percentage of texts with 0 occurrences of each feature</span></span>
<span><span class="va">zero_features</span> <span class="op">&lt;-</span> <span class="fu">compute_percentage</span><span class="op">(</span><span class="va">ncounts</span>, <span class="va">ncounts</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">66.6</span><span class="op">)</span></span>
<span><span class="va">zero_features</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Feature"</span>, <span class="st">"% texts with zero occurrences"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Feature</th>
<th style="text-align: right;">% texts with zero occurrences</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PRP</td>
<td style="text-align: right;">85.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">URL</td>
<td style="text-align: right;">93.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EMO</td>
<td style="text-align: right;">98.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">HST</td>
<td style="text-align: right;">99.55</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Drop variables with low document frequency</span></span>
<span><span class="va">ncounts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ncounts</span>, <span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html">one_of</a></span><span class="op">(</span><span class="va">zero_features</span><span class="op">$</span><span class="va">rowname</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These feature removal operations resulted in a feature set of 71 linguistic variables.</p>
</section><section id="identifying-outlier-texts" class="level3" data-number="D.4.3"><h3 data-number="D.4.3" class="anchored" data-anchor-id="identifying-outlier-texts">
<span class="header-section-number">D.4.3</span> Identifying outlier texts</h3>
<p>All normalised frequencies were normalised to identify any potential outlier texts.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First scale the normalised counts (z-standardisation) to be able to compare the various features</span></span>
<span><span class="va">zcounts</span> <span class="op">&lt;-</span> <span class="va">ncounts2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Words</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If necessary, remove any outliers at this stage.</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ncounts2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">zcounts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outliers</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_any</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">Words</span>,  .fns <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">8</span><span class="op">}</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Filename</span>, <span class="va">Corpus</span>, <span class="va">Register</span>, <span class="va">Words</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following outlier texts were identified according to the above conditions and excluded in subsequent analyses.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># These are potential outlier texts :</span></span>
<span><span class="va">outliers</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Filename"</span>, <span class="st">"Corpus"</span>, <span class="st">"Register"</span>, <span class="st">"# words"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 70%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Filename</th>
<th style="text-align: left;">Corpus</th>
<th style="text-align: left;">Register</th>
<th style="text-align: right;"># words</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POC_4e_Spoken_0007.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">750</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Elementary_ELF_Spoken_0013.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">931</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EIM_Starter_Informative_0004.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">534</td>
</tr>
<tr class="even">
<td style="text-align: left;">GreenLine_1_Spoken_0003.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">970</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Access_1_Spoken_0011.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">784</td>
</tr>
<tr class="even">
<td style="text-align: left;">Achievers_B1_Informative_0003.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">926</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EIM_Starter_Spoken_0002.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">824</td>
</tr>
<tr class="even">
<td style="text-align: left;">GreenLine_1_Spoken_0008.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">876</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JTT_3_Informative_0003.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">699</td>
</tr>
<tr class="even">
<td style="text-align: left;">GreenLine_1_Spoken_0010.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">701</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EIM_1_Spoken_0012.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">640</td>
</tr>
<tr class="even">
<td style="text-align: left;">NGL_1_Spoken_0013.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">940</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NGL_3_Spoken_0018.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">751</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Intermediate_Spoken_0029.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">672</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NGL_1_Spoken_0012.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">910</td>
</tr>
<tr class="even">
<td style="text-align: left;">GreenLine_1_Spoken_0006.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">622</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GreenLine_2_Spoken_0004.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">1102</td>
</tr>
<tr class="even">
<td style="text-align: left;">Access_2_Spoken_0023.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">875</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HT_4_Informative_0006.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">513</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Intermediate_Informative_0017.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">816</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EIM_1_Spoken_0013.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">967</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Elementary_ELF_Spoken_0021.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">846</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solutions_Intermediate_Plus_Spoken_0022.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">596</td>
</tr>
<tr class="even">
<td style="text-align: left;">Access_2_Spoken_0028.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">813</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NGL_1_Spoken_0005.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">1020</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Elementary_ELF_Spoken_0016.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">871</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solutions_Pre-Intermediate_ELF_Spoken_0007.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">630</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Intermediate_Informative_0013.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">770</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GreenLine_2_Spoken_0003.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">850</td>
</tr>
<tr class="even">
<td style="text-align: left;">HT_4_Spoken_0010.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">727</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solutions_Elementary_Informative_0003.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1051</td>
</tr>
<tr class="even">
<td style="text-align: left;">Access_2_Informative_0001.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">655</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solutions_Elementary_Informative_0010.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">708</td>
</tr>
<tr class="even">
<td style="text-align: left;">GreenLine_1_Informative_0001.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">731</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Access_2_Spoken_0002.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">572</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Intermediate_Spoken_0019.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">1024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Access_3_Informative_0003.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Access_1_Spoken_0019.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">701</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Access_2_Spoken_0013.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">981</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Intermediate_Plus_Informative_0014.txt</td>
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">537</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Revision_World_GCSE_10525362_literary-terms.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">790</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10528697_p6-physics-radioactive-materials.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1015</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382383_math.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">522</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_for_students_10064820_scientists-say-metabolism.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">895</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382388_recycling.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">666</td>
</tr>
<tr class="even">
<td style="text-align: left;">History_Kids_BBC_10404337_go_furthers.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">620</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382391_sports.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">657</td>
</tr>
<tr class="even">
<td style="text-align: left;">Teen_Kids_News_10402607_so-you-want-to-be-an-archivist.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">763</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382234_biology.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">843</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382372_astronomy.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dogo_News_file10060404_banana-plant-extract-may-be-the-key-to-slower-melting-ice-cream.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">611</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382667_countries.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">717</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quatr_us_file10390777_quick-summary-geological-erashtm.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">643</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382873_physics.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">722</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382382_light.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">639</td>
</tr>
<tr class="even">
<td style="text-align: left;">Factmonster_10053687_august-13.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">523</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Revision_World_GCSE_10526703_limited-companies.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">714</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10529637_transition-metals.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">787</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quatr_us_10390856_early-african-historyhtm.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1136</td>
</tr>
<tr class="even">
<td style="text-align: left;">History_Kids_BBC_10401873_ff6_sicilylandingss.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">813</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quatr_us_10394250_harappan.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">651</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ducksters_10398301_iraqphp.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">657</td>
</tr>
<tr class="odd">
<td style="text-align: left;">History_Kids_BBC_10403171_death_sakkara_gallery_04s.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">844</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10528246_agricultural-change.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Revision_World_GCSE_10528086_uk-government-judiciary.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1019</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10529794_definitions.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">904</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Encyclopedia_Kinds_au_10085347_Nobel_Prize_in_Chemistry.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">598</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_for_students_10064875_questions-big-melt-earths-ice-sheets-are-under-attack.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">685</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Teen_Kids_News_10403301_golden-globe-winners-2019-the-complete-list.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">800</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382201_projects.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">947</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Revision_World_GCSE_10529753_probability.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">816</td>
</tr>
<tr class="even">
<td style="text-align: left;">Encyclopedia_Kinds_au_10085531_Complex_analysis.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">735</td>
</tr>
<tr class="odd">
<td style="text-align: left;">History_Kids_BBC_10401890_ff7_ddays.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">759</td>
</tr>
<tr class="even">
<td style="text-align: left;">History_Kids_BBC_10403434s.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">732</td>
</tr>
<tr class="odd">
<td style="text-align: left;">History_Kids_BBC_10401872_ff6_italys.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">786</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382371_amazing.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">629</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quatr_us_10391129_athabascan.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">637</td>
</tr>
<tr class="even">
<td style="text-align: left;">Encyclopedia_Kinds_au_10085355_20th_century.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">864</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dogo_News_10060755_luxury-space-hotel-promises-guests-a-truly-out-of-this-world-vacation.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">722</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10528072_nationalism-practice.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">776</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quatr_us_10390861_quatr-us-privacy-policyhtm.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">960</td>
</tr>
<tr class="even">
<td style="text-align: left;">History_Kids_BBC_10401909_ff7_bulges.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">732</td>
</tr>
<tr class="odd">
<td style="text-align: left;">History_kids_10381259_timeline-of-mesopotamia.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">768</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10528123_gender-written-textual-analysis-framework.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">905</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10386406_floods.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10529693_advantages.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">782</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382378_geography.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">761</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382374_earth.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">726</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_for_students_10066286_watering-plants-wastewater-can-spread-germs.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">836</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382393_water.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">856</td>
</tr>
<tr class="odd">
<td style="text-align: left;">World_Dteen_10406069_website_policies.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">995</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382384_metals.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">669</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dogo_News_10062028_puppy-bowl-14-promises-viewers-a-paw-some-time-on-super-bowl-sunday.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">581</td>
</tr>
<tr class="even">
<td style="text-align: left;">History_Kids_BBC_10404730_go_furthers.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">611</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382385_nature.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">722</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_for_students_10065015_scientists-say-dna-sequencing.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">953</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quatr_us_file10390817_conifers-pine-trees-gymnospermshtm.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">533</td>
</tr>
<tr class="even">
<td style="text-align: left;">TweenTribute_10051509_it-true-elephants-cant-jump.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">790</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Revision_World_GCSE_10528494_application-software.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">855</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10529581_different-types-questions-examinations.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">742</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dogo_News_10061669_the-chinese-city-of-chengdu-may-soon-be-home-to-multiple-moons.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">614</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ducksters_10398306_geography_of_ancient_chinaphp.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">638</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_for_students_10065144_scientists-say-multiverse.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">712</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382211_images.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factmonster_10053754_may-18.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">497</td>
</tr>
<tr class="even">
<td style="text-align: left;">World_Dteen_10406047_AboutWORLDteen.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1053</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ducksters_10398078_first_new_dealphp.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">649</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10526926_economies-scale.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">621</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Factmonster_10053201_september-03.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">445</td>
</tr>
<tr class="even">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10387183_calciumcarbonates.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Science_Tech_Kinds_NZ_10382380_health.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">694</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revision_World_GCSE_10529587_sources-finance.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">665</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quatr_us_10393444_fishing.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">656</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ducksters_10398315_glossary_and_termsphp.txt</td>
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">684</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5AA.txt</td>
<td style="text-align: left;">Spoken.BNC2014</td>
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">1869</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We check that that outlier texts are not particularly long or short texts by looking at the distribution of text/file length of the outliers.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outliers</span><span class="op">$</span><span class="va">Words</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  445.0   655.5   751.0   773.6   860.0  1869.0 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">outliers</span><span class="op">$</span><span class="va">Words</span>, breaks <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="F_Ch7_DataPrep_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="F_Ch7_DataPrep_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We also check the distribution of outlier texts across the four corpora. The majority come from the Info Teens corpus, though quite a few are also from the TEC.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outliers</span><span class="op">$</span><span class="va">Corpus</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(Sub)corpus"</span>, <span class="st">"# outlier texts"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">(Sub)corpus</th>
<th style="text-align: right;"># outlier texts</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Textbook.English</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative.Teens</td>
<td style="text-align: right;">74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spoken.BNC2014</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Youth.Fiction</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Report on the manual check of a sample of these outliers:</span></span>
<span></span>
<span><span class="co"># Encyclopedia_Kinds_au_10085347_Nobel_Prize_in_Chemistry.txt is essentially a list of Nobel prize winners but with some additional information. In other words, not a bad representative of the type of texts of the Info Teen corpus.</span></span>
<span><span class="co"># Solutions_Elementary_ELF_Spoken_0013 --&gt; Has a lot of "going to" constructions because they are learnt in this chapter but is otherwise a well-formed text.</span></span>
<span><span class="co"># Teen_Kids_News_10403972_a-brief-history-of-white-house-weddings --&gt; No issues</span></span>
<span><span class="co"># Teen_Kids_News_10403301_golden-globe-winners-2019-the-complete-list --&gt; Similar to the Nobel prize laureates text.</span></span>
<span><span class="co"># Revision_World_GCSE_10528123_gender-written-textual-analysis-framework --&gt; Text includes bullet points tokenised as the letter "o" but otherwise a fairly typical informative text.</span></span>
<span></span>
<span><span class="co"># Removing the outliers at the request of the reviewers (but comparisons of models including the outliers showed that the results are very similar):</span></span>
<span><span class="va">ncounts3</span> <span class="op">&lt;-</span> <span class="va">ncounts2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">Filename</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">outliers</span><span class="op">$</span><span class="va">Filename</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#saveRDS(ncounts3, here("data", "processed", "ncounts3_3Reg.rds")) # Last saved 6 March 2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This resulted in 4,980 texts/files being included in the comparative model of Textbook English vs.&nbsp;‘real-world’ English. These standardised feature frequencies were distributed as follows:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">zcounts3</span> <span class="op">&lt;-</span> <span class="va">ncounts3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Words</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">zcounts3</span>, las <span class="op">=</span> <span class="fl">3</span>, main <span class="op">=</span> <span class="st">"z-scores"</span><span class="op">)</span> <span class="co"># Slow</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="F_Ch7_DataPrep_files/figure-html/z-transformed-distributions-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="F_Ch7_DataPrep_files/figure-html/z-transformed-distributions-1.png" class="img-fluid figure-img" width="1440"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="signed-log-transformation" class="level3" data-number="D.4.4"><h3 data-number="D.4.4" class="anchored" data-anchor-id="signed-log-transformation">
<span class="header-section-number">D.4.4</span> Signed log transformation</h3>
<p>A signed logarithmic transformation was applied to (further) deskew the feature distributions <span class="citation" data-cites="diwersy2014 neumann2021">(see <a href="references.html#ref-diwersy2014" role="doc-biblioref">Diwersy, Evert, and Neumann 2014</a>; <a href="references.html#ref-neumann2021" role="doc-biblioref">Neumann and Evert 2021</a>)</span>.</p>
<p>The signed log transformation function was inspired by the SignedLog function proposed in <a href="https://cran.r-project.org/web/packages/DataVisualizations/DataVisualizations.pdf" class="uri">https://cran.r-project.org/web/packages/DataVisualizations/DataVisualizations.pdf</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">signed.log</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Standardise first, then sign log transform</span></span>
<span><span class="va">zlogcounts</span> <span class="op">&lt;-</span> <span class="fu">signed.log</span><span class="op">(</span><span class="va">zcounts3</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The new feature distributions are visualised below.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">zlogcounts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, colour<span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkred"</span>, weight <span class="op">=</span> <span class="fl">2</span>, fill<span class="op">=</span><span class="st">"darkred"</span>, alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="F_Ch7_DataPrep_files/figure-html/signed.log.transformation-distributions-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="F_Ch7_DataPrep_files/figure-html/signed.log.transformation-distributions-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "DensityPlotsAllVariablesSignedLog.svg"), width = 15, height = 49)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="merging-of-data-for-mda" class="level3" data-number="D.4.5"><h3 data-number="D.4.5" class="anchored" data-anchor-id="merging-of-data-for-mda">
<span class="header-section-number">D.4.5</span> Merging of data for MDA</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">zlogcounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"zlogcounts_3Reg.rds"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#nrow(zlogcounts)</span></span>
<span><span class="co">#colnames(zlogcounts)</span></span>
<span></span>
<span><span class="va">ncounts3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"ncounts3_3Reg.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#nrow(ncounts3)</span></span>
<span><span class="co">#colnames(ncounts3)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ncounts3</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">zlogcounts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#saveRDS(data, here("data", "processed", "datazlogcounts_3Reg.rds")) # Last saved 16 March 2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The final dataset comprises of 4,980 texts/files, divided as follows:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">(Sub)corpus</th>
<th style="text-align: right;"># texts/files</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: right;">565</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: right;">285</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Info Teens Ref.</td>
<td style="text-align: right;">1337</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: right;">352</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spoken BNC2014 Ref.</td>
<td style="text-align: right;">1250</td>
</tr>
<tr class="even">
<td style="text-align: left;">Youth Fiction Ref.</td>
<td style="text-align: right;">1191</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="testing-factorability-of-data" class="level2" data-number="D.5"><h2 data-number="D.5" class="anchored" data-anchor-id="testing-factorability-of-data">
<span class="header-section-number">D.5</span> Testing factorability of data</h2>
<section id="visualisation-of-feature-correlations" class="level3" data-number="D.5.1"><h3 data-number="D.5.1" class="anchored" data-anchor-id="visualisation-of-feature-correlations">
<span class="header-section-number">D.5.1</span> Visualisation of feature correlations</h3>
<p>We begin by visualising the correlations of the transformed feature frequencies using the <code>heatmap</code> function of the <code>stats</code> library. Negative correlations are rendered in blue; positive ones are in red.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simple heatmap in base R (inspired by Stephanie Evert's SIGIL code)</span></span>
<span><span class="va">cor.colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/hsv.html">hsv</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, v<span class="op">=</span><span class="fl">1</span>, s<span class="op">=</span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, <span class="co"># blue = negative correlation </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="co"># white = no correlation </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/hsv.html">hsv</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">1</span>, s<span class="op">=</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># red = positive correlation</span></span>
<span></span>
<span><span class="co">#png(here("plots", "heatmapzlogcounts.png"), width = 30, height= 30, units = "cm", res = 300)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">zlogcounts</span><span class="op">)</span>, </span>
<span>        symm<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>        col<span class="op">=</span><span class="va">cor.colours</span>, </span>
<span>        margins<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="F_Ch7_DataPrep_files/figure-html/heatmap-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="F_Ch7_DataPrep_files/figure-html/heatmap-1.png" class="img-fluid figure-img" width="1440"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="collinearity" class="level3" data-number="D.5.2"><h3 data-number="D.5.2" class="anchored" data-anchor-id="collinearity">
<span class="header-section-number">D.5.2</span> Collinearity</h3>
<p>As a result of the normalisation unit of finite verb phrases for verb-based features, the present tense (VPRT) and past tense (VBD) variables are correlated to a very high degree:</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">VPRT</span>, <span class="va">data</span><span class="op">$</span><span class="va">VBD</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.97</code></pre>
</div>
</div>
<p>We therefore remove the least marked of the pair of collinear variables: VPRT.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">VPRT</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="msa" class="level3" data-number="D.5.3"><h3 data-number="D.5.3" class="anchored" data-anchor-id="msa">
<span class="header-section-number">D.5.3</span> MSA</h3>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/KMO.html">KMO</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># The first eight columns contain metadata.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The overall MSA value of the dataset is 0.95. The features have the following individual MSA values (ordered from lowest to largest):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo</span><span class="op">$</span><span class="va">MSAi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">kmo</span><span class="op">$</span><span class="va">MSAi</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   AMP   COMM    POS   TPP3   JJPR  PLACE  SPLIT     DT   JJAT   VIMP   MDCO 
  0.67   0.69   0.70   0.74   0.76   0.82   0.83   0.83   0.84   0.84   0.85 
    RP     EX   THSC     LD  NCOMP   BEMA   MDWS   FQTI  FPP1P   MDCA    ACT 
  0.85   0.85   0.86   0.87   0.88   0.88   0.89   0.89   0.89   0.89   0.89 
MENTAL    VBD  FPP1S   MDMM   PEAS   CONC   MDWO   THRC     NN   COND   PROG 
  0.91   0.91   0.91   0.91   0.91   0.93   0.93   0.94   0.94   0.95   0.95 
    CC   SPP2     RB   DWNT   MDNE   WHSC   CONT   QUPR    XX0  CAUSE   WHQU 
  0.95   0.95   0.95   0.95   0.95   0.96   0.96   0.96   0.96   0.96   0.96 
   VBG    AWL POLITE   PASS    PIT  DOAUX   ELAB ASPECT    DMA   DEMO    HDG 
  0.96   0.96   0.96   0.96   0.97   0.97   0.97   0.97   0.97   0.97   0.97 
    IN   FPUH  OCCUR    CUZ   EMPH   YNQU   QUAN    TTR  QUTAG  THATD    VBN 
  0.97   0.97   0.97   0.97   0.98   0.98   0.98   0.98   0.98   0.98   0.98 
 EXIST   STPR    GTO   HGOT 
  0.98   0.99   0.99   0.99 </code></pre>
</div>
</div>
<p>We aim to remove features with an individual MSA &lt; 0.5. All features have individual MSAs of &gt; 0.5 (but only because TPP3P was merged into a broader category in an earlier chunk).</p>
</section><section id="scree-plot" class="level3" data-number="D.5.4"><h3 data-number="D.5.4" class="anchored" data-anchor-id="scree-plot">
<span class="header-section-number">D.5.4</span> Scree plot</h3>
<p>Six components were originally retained on the basis of the following screeplot, though only the first four were found to be interpretable and were therefore included in the model.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># png(here("plots", "screeplot-TEC-Ref_3Reg.png"), width = 20, height= 12, units = "cm", res = 300)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/VSS.scree.html">scree</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, factors <span class="op">=</span> <span class="cn">FALSE</span>, pc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="F_Ch7_DataPrep_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="F_Ch7_DataPrep_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span>
<span></span>
<span><span class="co"># Perform PCA</span></span>
<span><span class="va">pca1</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/principal.html">principal</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                         nfactors <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="communalities" class="level3" data-number="D.5.5"><h3 data-number="D.5.5" class="anchored" data-anchor-id="communalities">
<span class="header-section-number">D.5.5</span> Communalities</h3>
<p>If features with final communalities of &lt; 0.2 are removed, TIME would have to be removed. TIME was therefore merged with FREQ in an earlier chunk so that now all features have final communalities of &gt; 0.2 (note that this is a very generous threshold!).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca1</span><span class="op">$</span><span class="va">communality</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  DWNT   STPR   CONC   FQTI    POS ASPECT   MDNE  FPP1P   PROG   MDCO   MDMM 
  0.22   0.23   0.23   0.23   0.24   0.25   0.27   0.28   0.29   0.32   0.32 
  MDWO  SPLIT   MDWS   PEAS   QUPR    AMP  PLACE    HDG   COMM  CAUSE     EX 
  0.32   0.33   0.34   0.35   0.35   0.35   0.37   0.38   0.38   0.38   0.38 
  THSC  OCCUR   WHSC   THRC   JJAT   COND MENTAL    ACT   VIMP   ELAB  EXIST 
  0.40   0.40   0.42   0.43   0.44   0.44   0.45   0.45   0.46   0.46   0.46 
  JJPR  NCOMP     RP    GTO   DEMO   MDCA POLITE    CUZ     CC   WHQU   TPP3 
  0.46   0.48   0.49   0.50   0.50   0.52   0.52   0.53   0.57   0.58   0.58 
   VBG  THATD    PIT   BEMA  FPP1S     DT   HGOT     RB    VBN  QUTAG   EMPH 
  0.60   0.60   0.61   0.61   0.61   0.61   0.62   0.62   0.64   0.64   0.64 
  PASS    XX0   QUAN   SPP2  DOAUX    TTR   YNQU    VBD     LD   FPUH     IN 
  0.65   0.65   0.67   0.68   0.69   0.71   0.74   0.78   0.81   0.83   0.86 
  CONT    DMA    AWL     NN 
  0.89   0.89   0.91   0.93 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#saveRDS(data, here("data", "processed", "dataforPCA.rds")) # Last saved on 6 March 2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The final dataset entered in the analysis described in Chapter 7 therefore comprises 4,980 texts/files, each with logged standardised normalised frequencies for 70 linguistic features.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-diwersy2014" class="csl-entry" role="listitem">
Diwersy, Sascha, Stephanie Evert, and Stella Neumann. 2014. <span>“A Weakly Supervised Multivariate Approach to the Study of Language Variation.”</span> In, edited by Benedikt Szmrecsanyi and Bernhard Wälchli, 174–204. Berlin: De Gruyter.
</div>
<div id="ref-lefoll2021" class="csl-entry" role="listitem">
Le Foll, Elen. 2021a. <em>Introducing the Multi-Feature Tagger of English (MFTE)</em>. Osnabrück University. <a href="https://github.com/elenlefoll/MultiFeatureTaggerEnglish">https://github.com/elenlefoll/MultiFeatureTaggerEnglish</a>.
</div>
<div id="ref-lefoll2021a" class="csl-entry" role="listitem">
———. 2021b. <em>Introducing the Multi-Feature Tagger of English (MFTE)</em>. Osnabrück University. <a href="https://github.com/elenlefoll/MultiFeatureTaggerEnglish">https://github.com/elenlefoll/MultiFeatureTaggerEnglish</a>.
</div>
<div id="ref-neumann2021" class="csl-entry" role="listitem">
Neumann, Stella, and Stephanie Evert. 2021. <span>“A Register Variation Perspective on Varieties of English.”</span> In, edited by Elena Seoane and Douglas Biber, 144178. Studies in Corpus Linguistics 103. Amsterdam: Benjamins.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/elenlefoll\.github\.io\/TextbookMDA\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./E_Ch6_Analysis.html" class="pagination-link  aria-label=" analysis="" for="" the="" model="" of="" intra-textbook="" variation="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Intra-Textbook Variation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./G_Ch7_Analysis.html" class="pagination-link" aria-label="<span class='chapter-number'>E</span>&nbsp; <span class='chapter-title'>Data Analysis for the Model of Textbook English vs. ‘real-world’ English</span>">
        <span class="nav-page-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Preparation for the Model of Textbook English vs. ‘real-world’ English</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>This script documents the steps taken to pre-process the data extracted from the Textbook English Corpus (TEC) and the three reference corpora that were ultimately entered in the comparative multi-dimensional model of Textbook English as compared to English outside the EFL classroom (Chapter 7).</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages required</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>The following packages must be installed and loaded to process the data.</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: set-up</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original thesis.</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># For checking singularity issues </span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># For recoding data</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># For the feature correlation matrix</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># For nice plots</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co"># Comparing group means of predicted values</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co"># For ggpairs</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># For making large faceted plots</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># For ease of sharing</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># For mixed effects modelling</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co"># For various useful stats function, including KMO()</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co"># For working with colours</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># For nice tabular display of regression models</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># For data wrangling and plotting</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg) <span class="co"># For nice visualisations of model results</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r palette}</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a><span class="in"># Colours used in Register Studies paper and included in Open Access plots published on Zenodo:</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="in">#colours &lt;- suf_palette(name = "london", n = 6, type = "continuous") # Very nice, similar to OrRd palette</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a><span class="in">#scales::show_col(colours)</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a><span class="in">#colours &lt;- colours[6:1] </span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a><span class="in"># Colour scheme used in PhD thesis:</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a><span class="in">colours = c("#F9B921", "#A18A33",  "#722672", "#BD241E", "#15274D", "#D54E1E") </span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a><span class="in"># scales::show_col(colours)</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data import from MFTE outputs</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>The raw data used in this script comes from the matrices of mixed normalised frequencies as output by the <span class="co">[</span><span class="ot">MFTE Perl v. 3.1</span><span class="co">](https://github.com/mshakirDr/MultiFeatureTaggerEnglish)</span> <span class="co">[</span><span class="ot">@lefoll2021</span><span class="co">]</span>.</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a><span class="fu">### Spoken BNC2014</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r SpokenBNC2014}</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014 &lt;- read.delim(here("data", "MFTE", "SpokenBNC2014_3.1_normed_complex_counts.tsv"), header = TRUE, stringsAsFactors = TRUE)</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Series &lt;- "Spoken BNC2014"</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Level &lt;- "Ref."</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Country &lt;- "Spoken BNC2014"</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Register &lt;- "Spoken BNC2014"</span></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>These normalised frequencies were computed on the basis of my own "John and Jill in Ivybridge" version of the Spoken BNC2014 with added full stops at speaker turns (see Appendix B for details). This corpus comprises of <span class="in">`{r} nrow(SpokenBNC2014) |&gt; format(big.mark=",")`</span> texts, all of which were used in the following analyses.</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a><span class="fu">### Youth Fiction corpus</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r YouthFiction}</span></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction &lt;- read.delim(here("data", "MFTE", "YF_sampled_500_3.1_normed_complex_counts.tsv"), header = TRUE, stringsAsFactors = TRUE)</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Series &lt;- "Youth Fiction"</span></span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Level &lt;- "Ref."</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Country &lt;- "Youth Fiction"</span></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Register &lt;- "Youth Fiction"</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>These normalised frequencies were computed on the basis of the random samples of approximately 5,000 words of the books of the Youth Fiction corpus (for details of the works included in this corpus, see Appendix B). The sampling procedure is described in Section 4.3.2.4 of the book. This dataset consists of <span class="in">`{r} nrow(YouthFiction) |&gt; format(big.mark=",")`</span> files.</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a><span class="fu">### Informative Texts for Teens (InfoTeens) corpus</span></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r InfoTeencounts}</span></span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen &lt;- read.delim(here("data", "MFTE", "InfoTeen_3.1_normed_complex_counts.tsv"), header = TRUE, stringsAsFactors = TRUE)</span></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a><span class="in"># Removes three outlier files which should not have been included in the corpus as they contain exam papers only</span></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen &lt;- InfoTeen |&gt; </span></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Filename!=".DS_Store" &amp; Filename!="Revision_World_GCSE_10529068_wjec-level-law-past-papers.txt" &amp; Filename!="Revision_World_GCSE_10528474_wjec-level-history-past-papers.txt" &amp; Filename!="Revision_World_GCSE_10528472_edexcel-level-history-past-papers.txt")</span></span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Series &lt;- "Info Teens"</span></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Level &lt;- "Ref."</span></span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Country &lt;- "Info Teens"</span></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Register &lt;- "Info Teens"</span></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>Details of the composition of the Info Teens corpus can be found in Section 4.3.2.5 of the book. The version used in the present study comprises <span class="in">`{r} nrow(InfoTeen) |&gt; format(big.mark=",")`</span> texts.</span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Merging TEC and reference corpora data</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r DataMerging}</span></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a><span class="in">TxBncounts &lt;- readRDS(here("data", "processed", "TxBcounts.rds"))</span></span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a><span class="in">All3Reg &lt;- c("Conversation", "Fiction", "Informative")</span></span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a><span class="in">TxBncounts3Reg &lt;- TxBncounts |&gt; </span></span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Register %in% All3Reg) |&gt; </span></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a><span class="in">  droplevels()</span></span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts &lt;- bind_rows(TxBncounts3Reg, InfoTeen, SpokenBNC2014, YouthFiction, .id = "Corpus")</span></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert all character vectors to factors</span></span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts[sapply(ncounts, is.character)] &lt;- lapply(ncounts[sapply(ncounts, is.character)], as.factor)</span></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a><span class="in"># Change all NAs to 0</span></span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts[is.na(ncounts)] &lt;- 0</span></span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a><span class="in">levels(ncounts$Corpus) &lt;- list(Textbook.English="1", Informative.Teens="2", Spoken.BNC2014="3", Youth.Fiction="4")</span></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(ncounts$Corpus)</span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(ncounts$Series)</span></span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a><span class="in"># Wrangle metadata variables</span></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts$Subcorpus &lt;- ncounts$Register</span></span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a><span class="in">#levels(ncounts$Subcorpus)</span></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a><span class="in">levels(ncounts$Subcorpus) &lt;- c("Textbook Conversation", "Textbook Fiction", "Info Teens Ref.", "Textbook Informative", "Spoken BNC2014 Ref.", "Youth Fiction Ref.")</span></span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a><span class="in"># Re-order registers</span></span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a><span class="in">levels(ncounts$Register) &lt;- c("Conversation", "Fiction", "Informative", "Informative", "Conversation", "Fiction")</span></span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a><span class="in">#summary(ncounts$Register)</span></span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a><span class="in"># Re-order variables</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts &lt;- select(ncounts, order(names(ncounts))) |&gt; </span></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a><span class="in">  select(Filename, Register, Level, Series, Country, Corpus, Subcorpus, Words, everything()) # Then place the metadata variable at the front of the table</span></span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a><span class="in">#saveRDS(ncounts, here("data", "processed", "counts3Reg.rds")) # Last saved 6 March 2024</span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Corpus size</span></span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a>These tables provide some summary statistics about the texts/files whose normalised feature frequencies were entered in the model of Textbook English vs. real-world English described in Chapter 7.</span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: corpora-summary-stats</span></span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ncounts<span class="sc">$</span>Subcorpus) <span class="sc">|&gt;</span> </span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"(Sub)corpus"</span>, <span class="st">"# texts"</span>),</span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a>ncounts  <span class="sc">|&gt;</span>  </span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Register) <span class="sc">|&gt;</span>  </span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totaltexts =</span> <span class="fu">n</span>(), </span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a>            <span class="at">totalwords =</span> <span class="fu">sum</span>(Words), </span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">as.integer</span>(<span class="fu">mean</span>(Words)), </span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">as.integer</span>(<span class="fu">sd</span>(Words)), </span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a>            <span class="at">TTRmean =</span> <span class="fu">mean</span>(TTR)) <span class="sc">|&gt;</span>  </span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Register"</span>, <span class="st">"# texts/files"</span>, <span class="st">"# words"</span>, <span class="st">"mean # words per text"</span>, <span class="st">"SD"</span>, <span class="st">"mean TTR"</span>))</span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data preparation for PCA</span></span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a><span class="fu">### Feature distributions</span></span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>The distributions of each linguistic features were examined by means of visualisation. As shown below, before transformation, many of the features displayed highly skewed distributions.</span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: distribution-viz</span></span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 40</span></span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a><span class="co">#ncounts &lt;- readRDS(here("data", "processed", "counts3Reg.rds"))</span></span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a>ncounts <span class="sc">|&gt;</span></span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Words) <span class="sc">|&gt;</span> </span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">colour=</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">weight =</span> <span class="dv">2</span>, <span class="at">fill=</span><span class="st">"darkred"</span>, <span class="at">alpha =</span> .<span class="dv">4</span>)</span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "DensityPlotsAllVariables.svg"), width = 15, height = 49)</span></span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a><span class="fu">### Feature removal</span></span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a>A number of features were removed from the dataset as they are not linguistically interpretable. In the case of the TEC, this included the variable CD because numbers spelt out as digits were removed from the textbooks before these were tagged with the MFTE. In addition, the variables LIKE and SO because these are "bin" features included in the output of the MFTE to ensure that the counts for these polysemous words do not inflate other categories due to mistags <span class="co">[</span><span class="ot">@lefoll2021a</span><span class="co">]</span>.</span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a>Whenever linguistically meaningful, very low-frequency features, features with low MSA or communalities (see chunks below) were merged. Finally, features absent from more than third of texts were also excluded. For the comparative analysis of TEC and the reference corpora, the following linguistic features were excluded from the analysis due to low dispersion:</span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: feature-removal</span></span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Removal of meaningless feature: CD because numbers as digits were mostly removed from the textbooks, LIKE and SO because they are dustbin categories</span></span>
<span id="cb36-217"><a href="#cb36-217" aria-hidden="true" tabindex="-1"></a>ncounts <span class="ot">&lt;-</span> ncounts <span class="sc">|&gt;</span> </span>
<span id="cb36-218"><a href="#cb36-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(CD, LIKE, SO))</span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine problematic features into meaningful groups whenever this makes linguistic sense</span></span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a>ncounts <span class="ot">&lt;-</span> ncounts <span class="sc">|&gt;</span> </span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">JJPR =</span> JJPR <span class="sc">+</span> ABLE, <span class="at">ABLE =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PASS =</span> PGET <span class="sc">+</span> PASS, <span class="at">PGET =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TPP3 =</span> TPP3S <span class="sc">+</span> TPP3P, <span class="at">TPP3P =</span> <span class="cn">NULL</span>, <span class="at">TPP3S =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> <span class="co"># Merged due to TTP3P having an individual MSA &lt; 0.5</span></span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FQTI =</span> FREQ <span class="sc">+</span> TIME, <span class="at">FREQ =</span> <span class="cn">NULL</span>, <span class="at">TIME =</span> <span class="cn">NULL</span>) <span class="co"># Merged due to TIME communality &lt; 0.2 (see below)</span></span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute percentage of texts with occurrences meeting a condition</span></span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a>compute_percentage <span class="ot">&lt;-</span> <span class="cf">function</span>(data, condition, threshold) {</span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a>  numeric_data <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.numeric, data)</span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a>  percentage <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">colSums</span>(condition[, <span class="fu">sapply</span>(numeric_data, is.numeric)])<span class="sc">/</span><span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a>  percentage <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(percentage)</span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(percentage) <span class="ot">&lt;-</span> <span class="st">"Percentage"</span></span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a>  percentage <span class="ot">&lt;-</span> percentage <span class="sc">|&gt;</span> </span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percentage)) <span class="sc">|&gt;</span></span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>() <span class="sc">|&gt;</span></span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(Percentage)</span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(threshold)) {</span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a>    percentage <span class="ot">&lt;-</span> percentage <span class="sc">|&gt;</span> </span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Percentage <span class="sc">&gt;</span> threshold)</span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(percentage)</span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage of texts with 0 occurrences of each feature</span></span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a>zero_features <span class="ot">&lt;-</span> <span class="fu">compute_percentage</span>(ncounts, ncounts <span class="sc">==</span> <span class="dv">0</span>, <span class="fl">66.6</span>)</span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a>zero_features <span class="sc">|&gt;</span> </span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Feature"</span>, <span class="st">"% texts with zero occurrences"</span>))</span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop variables with low document frequency</span></span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a>ncounts2 <span class="ot">&lt;-</span> <span class="fu">select</span>(ncounts, <span class="sc">-</span><span class="fu">one_of</span>(zero_features<span class="sc">$</span>rowname))</span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-252"><a href="#cb36-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a>These feature removal operations resulted in a feature set of <span class="in">`{r} ncol(ncounts2)-8`</span> linguistic variables.</span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identifying outlier texts</span></span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-258"><a href="#cb36-258" aria-hidden="true" tabindex="-1"></a>All normalised frequencies were normalised to identify any potential outlier texts.</span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: z-standardisation-outliers</span></span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 15</span></span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb36-266"><a href="#cb36-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-267"><a href="#cb36-267" aria-hidden="true" tabindex="-1"></a><span class="co"># First scale the normalised counts (z-standardisation) to be able to compare the various features</span></span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a>zcounts <span class="ot">&lt;-</span> ncounts2 <span class="sc">|&gt;</span></span>
<span id="cb36-269"><a href="#cb36-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Words) <span class="sc">|&gt;</span> </span>
<span id="cb36-270"><a href="#cb36-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a><span class="co"># If necessary, remove any outliers at this stage.</span></span>
<span id="cb36-274"><a href="#cb36-274" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ncounts2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="fu">as.data.frame</span>(zcounts))</span>
<span id="cb36-275"><a href="#cb36-275" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(<span class="fu">if_any</span>(<span class="fu">where</span>(is.numeric) <span class="sc">&amp;</span> <span class="sc">!</span>Words,  <span class="at">.fns =</span> <span class="cf">function</span>(x){x <span class="sc">&gt;</span> <span class="dv">8</span>}))  <span class="sc">|&gt;</span></span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Filename, Corpus, Register, Words) </span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a>The following outlier texts were identified according to the above conditions and excluded in subsequent analyses.</span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-285"><a href="#cb36-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: list-outliers</span></span>
<span id="cb36-286"><a href="#cb36-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a><span class="co"># These are potential outlier texts :</span></span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a>outliers <span class="sc">|&gt;</span> </span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Filename"</span>, <span class="st">"Corpus"</span>, <span class="st">"Register"</span>, <span class="st">"# words"</span>))</span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a>We check that that outlier texts are not particularly long or short texts by looking at the distribution of text/file length of the outliers.</span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-300"><a href="#cb36-300" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(outliers<span class="sc">$</span>Words)</span>
<span id="cb36-301"><a href="#cb36-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-302"><a href="#cb36-302" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(outliers<span class="sc">$</span>Words, <span class="at">breaks =</span> <span class="dv">30</span>)</span>
<span id="cb36-303"><a href="#cb36-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a>We also check the distribution of outlier texts across the four corpora. The majority come from the Info Teens corpus, though quite a few are also from the TEC.</span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-310"><a href="#cb36-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-311"><a href="#cb36-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(outliers<span class="sc">$</span>Corpus) <span class="sc">|&gt;</span> </span>
<span id="cb36-313"><a href="#cb36-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"(Sub)corpus"</span>, <span class="st">"# outlier texts"</span>))</span>
<span id="cb36-314"><a href="#cb36-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-315"><a href="#cb36-315" aria-hidden="true" tabindex="-1"></a><span class="co"># Report on the manual check of a sample of these outliers:</span></span>
<span id="cb36-316"><a href="#cb36-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-317"><a href="#cb36-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Encyclopedia_Kinds_au_10085347_Nobel_Prize_in_Chemistry.txt is essentially a list of Nobel prize winners but with some additional information. In other words, not a bad representative of the type of texts of the Info Teen corpus.</span></span>
<span id="cb36-318"><a href="#cb36-318" aria-hidden="true" tabindex="-1"></a><span class="co"># Solutions_Elementary_ELF_Spoken_0013 --&gt; Has a lot of "going to" constructions because they are learnt in this chapter but is otherwise a well-formed text.</span></span>
<span id="cb36-319"><a href="#cb36-319" aria-hidden="true" tabindex="-1"></a><span class="co"># Teen_Kids_News_10403972_a-brief-history-of-white-house-weddings --&gt; No issues</span></span>
<span id="cb36-320"><a href="#cb36-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Teen_Kids_News_10403301_golden-globe-winners-2019-the-complete-list --&gt; Similar to the Nobel prize laureates text.</span></span>
<span id="cb36-321"><a href="#cb36-321" aria-hidden="true" tabindex="-1"></a><span class="co"># Revision_World_GCSE_10528123_gender-written-textual-analysis-framework --&gt; Text includes bullet points tokenised as the letter "o" but otherwise a fairly typical informative text.</span></span>
<span id="cb36-322"><a href="#cb36-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-323"><a href="#cb36-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing the outliers at the request of the reviewers (but comparisons of models including the outliers showed that the results are very similar):</span></span>
<span id="cb36-324"><a href="#cb36-324" aria-hidden="true" tabindex="-1"></a>ncounts3 <span class="ot">&lt;-</span> ncounts2 <span class="sc">|&gt;</span> </span>
<span id="cb36-325"><a href="#cb36-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Filename <span class="sc">%in%</span> outliers<span class="sc">$</span>Filename)</span>
<span id="cb36-326"><a href="#cb36-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-327"><a href="#cb36-327" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(ncounts3, here("data", "processed", "ncounts3_3Reg.rds")) # Last saved 6 March 2024</span></span>
<span id="cb36-328"><a href="#cb36-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-329"><a href="#cb36-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-330"><a href="#cb36-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-331"><a href="#cb36-331" aria-hidden="true" tabindex="-1"></a>This resulted in <span class="in">`{r} nrow(ncounts3) |&gt; format(big.mark=",")`</span> texts/files being included in the comparative model of Textbook English vs. 'real-world' English. These standardised feature frequencies were distributed as follows:</span>
<span id="cb36-332"><a href="#cb36-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-335"><a href="#cb36-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-336"><a href="#cb36-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: z-transformed-distributions</span></span>
<span id="cb36-337"><a href="#cb36-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 15</span></span>
<span id="cb36-338"><a href="#cb36-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb36-339"><a href="#cb36-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-340"><a href="#cb36-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-341"><a href="#cb36-341" aria-hidden="true" tabindex="-1"></a>zcounts3 <span class="ot">&lt;-</span> ncounts3 <span class="sc">|&gt;</span></span>
<span id="cb36-342"><a href="#cb36-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Words) <span class="sc">|&gt;</span> </span>
<span id="cb36-343"><a href="#cb36-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb36-344"><a href="#cb36-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb36-345"><a href="#cb36-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-346"><a href="#cb36-346" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(zcounts3, <span class="at">las =</span> <span class="dv">3</span>, <span class="at">main =</span> <span class="st">"z-scores"</span>) <span class="co"># Slow</span></span>
<span id="cb36-347"><a href="#cb36-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-348"><a href="#cb36-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-349"><a href="#cb36-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-350"><a href="#cb36-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Signed log transformation</span></span>
<span id="cb36-351"><a href="#cb36-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-352"><a href="#cb36-352" aria-hidden="true" tabindex="-1"></a>A signed logarithmic transformation was applied to (further) deskew the feature distributions <span class="co">[</span><span class="ot">see @diwersy2014; @neumann2021</span><span class="co">]</span>.</span>
<span id="cb36-353"><a href="#cb36-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-354"><a href="#cb36-354" aria-hidden="true" tabindex="-1"></a>The signed log transformation function was inspired by the SignedLog function proposed in <span class="ot">&lt;https://cran.r-project.org/web/packages/DataVisualizations/DataVisualizations.pdf&gt;</span>.</span>
<span id="cb36-355"><a href="#cb36-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-358"><a href="#cb36-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-359"><a href="#cb36-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: signed.log.transformation</span></span>
<span id="cb36-360"><a href="#cb36-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-361"><a href="#cb36-361" aria-hidden="true" tabindex="-1"></a>signed.log <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sign</span>(x)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">abs</span>(x)<span class="sc">+</span><span class="dv">1</span>)}</span>
<span id="cb36-362"><a href="#cb36-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-363"><a href="#cb36-363" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardise first, then sign log transform</span></span>
<span id="cb36-364"><a href="#cb36-364" aria-hidden="true" tabindex="-1"></a>zlogcounts <span class="ot">&lt;-</span> <span class="fu">signed.log</span>(zcounts3) </span>
<span id="cb36-365"><a href="#cb36-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-366"><a href="#cb36-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-367"><a href="#cb36-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-370"><a href="#cb36-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-371"><a href="#cb36-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-372"><a href="#cb36-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-373"><a href="#cb36-373" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(zlogcounts, here("data", "processed", "zlogcounts_3Reg.rds")) # Last saved 16 March 2024</span></span>
<span id="cb36-374"><a href="#cb36-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-375"><a href="#cb36-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-376"><a href="#cb36-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-377"><a href="#cb36-377" aria-hidden="true" tabindex="-1"></a>The new feature distributions are visualised below.</span>
<span id="cb36-378"><a href="#cb36-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-381"><a href="#cb36-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-382"><a href="#cb36-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: signed.log.transformation-distributions</span></span>
<span id="cb36-383"><a href="#cb36-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 40</span></span>
<span id="cb36-384"><a href="#cb36-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-385"><a href="#cb36-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-386"><a href="#cb36-386" aria-hidden="true" tabindex="-1"></a>zlogcounts <span class="sc">|&gt;</span></span>
<span id="cb36-387"><a href="#cb36-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb36-388"><a href="#cb36-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span id="cb36-389"><a href="#cb36-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb36-390"><a href="#cb36-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-391"><a href="#cb36-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-392"><a href="#cb36-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb36-393"><a href="#cb36-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb36-394"><a href="#cb36-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">colour=</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb36-395"><a href="#cb36-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">weight =</span> <span class="dv">2</span>, <span class="at">fill=</span><span class="st">"darkred"</span>, <span class="at">alpha =</span> .<span class="dv">4</span>)</span>
<span id="cb36-396"><a href="#cb36-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-397"><a href="#cb36-397" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "DensityPlotsAllVariablesSignedLog.svg"), width = 15, height = 49)</span></span>
<span id="cb36-398"><a href="#cb36-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-399"><a href="#cb36-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-400"><a href="#cb36-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-401"><a href="#cb36-401" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merging of data for MDA</span></span>
<span id="cb36-402"><a href="#cb36-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-405"><a href="#cb36-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-406"><a href="#cb36-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-407"><a href="#cb36-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-408"><a href="#cb36-408" aria-hidden="true" tabindex="-1"></a>zlogcounts <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"zlogcounts_3Reg.rds"</span>)) </span>
<span id="cb36-409"><a href="#cb36-409" aria-hidden="true" tabindex="-1"></a><span class="co">#nrow(zlogcounts)</span></span>
<span id="cb36-410"><a href="#cb36-410" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(zlogcounts)</span></span>
<span id="cb36-411"><a href="#cb36-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-412"><a href="#cb36-412" aria-hidden="true" tabindex="-1"></a>ncounts3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"ncounts3_3Reg.rds"</span>))</span>
<span id="cb36-413"><a href="#cb36-413" aria-hidden="true" tabindex="-1"></a><span class="co">#nrow(ncounts3)</span></span>
<span id="cb36-414"><a href="#cb36-414" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(ncounts3)</span></span>
<span id="cb36-415"><a href="#cb36-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-416"><a href="#cb36-416" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ncounts3[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="fu">as.data.frame</span>(zlogcounts))</span>
<span id="cb36-417"><a href="#cb36-417" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(data, here("data", "processed", "datazlogcounts_3Reg.rds")) # Last saved 16 March 2024</span></span>
<span id="cb36-418"><a href="#cb36-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-419"><a href="#cb36-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-420"><a href="#cb36-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-421"><a href="#cb36-421" aria-hidden="true" tabindex="-1"></a>The final dataset comprises of <span class="in">`{r} nrow(data) |&gt; format(big.mark=",")`</span> texts/files, divided as follows:</span>
<span id="cb36-422"><a href="#cb36-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-425"><a href="#cb36-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-426"><a href="#cb36-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb36-427"><a href="#cb36-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-428"><a href="#cb36-428" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>Subcorpus) <span class="sc">|&gt;</span> </span>
<span id="cb36-429"><a href="#cb36-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"(Sub)corpus"</span>, <span class="st">"# texts/files"</span>))</span>
<span id="cb36-430"><a href="#cb36-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-431"><a href="#cb36-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-432"><a href="#cb36-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-433"><a href="#cb36-433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r prepare-data}</span></span>
<span id="cb36-434"><a href="#cb36-434" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb36-435"><a href="#cb36-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-436"><a href="#cb36-436" aria-hidden="true" tabindex="-1"></a><span class="in"># Quick import</span></span>
<span id="cb36-437"><a href="#cb36-437" aria-hidden="true" tabindex="-1"></a><span class="in">#data &lt;- readRDS(here("data", "processed", "datazlogcounts_3Reg.rds"))</span></span>
<span id="cb36-438"><a href="#cb36-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-439"><a href="#cb36-439" aria-hidden="true" tabindex="-1"></a><span class="in"># This rearranges the levels in the desired order for the plot legends:</span></span>
<span id="cb36-440"><a href="#cb36-440" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- data |&gt; </span></span>
<span id="cb36-441"><a href="#cb36-441" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Subcorpus = fct_relevel(Subcorpus, "Info Teens Ref.", after = 9))</span></span>
<span id="cb36-442"><a href="#cb36-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-443"><a href="#cb36-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-444"><a href="#cb36-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-445"><a href="#cb36-445" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing factorability of data</span></span>
<span id="cb36-446"><a href="#cb36-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-447"><a href="#cb36-447" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualisation of feature correlations</span></span>
<span id="cb36-448"><a href="#cb36-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-449"><a href="#cb36-449" aria-hidden="true" tabindex="-1"></a>We begin by visualising the correlations of the transformed feature frequencies using the <span class="in">`heatmap`</span> function of the <span class="in">`stats`</span> library. Negative correlations are rendered in blue; positive ones are in red.</span>
<span id="cb36-450"><a href="#cb36-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-451"><a href="#cb36-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r heatmap}</span></span>
<span id="cb36-452"><a href="#cb36-452" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-453"><a href="#cb36-453" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 15</span></span>
<span id="cb36-454"><a href="#cb36-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-455"><a href="#cb36-455" aria-hidden="true" tabindex="-1"></a><span class="in"># Simple heatmap in base R (inspired by Stephanie Evert's SIGIL code)</span></span>
<span id="cb36-456"><a href="#cb36-456" aria-hidden="true" tabindex="-1"></a><span class="in">cor.colours &lt;- c(</span></span>
<span id="cb36-457"><a href="#cb36-457" aria-hidden="true" tabindex="-1"></a><span class="in">  hsv(h=2/3, v=1, s=(10:1)/10), # blue = negative correlation </span></span>
<span id="cb36-458"><a href="#cb36-458" aria-hidden="true" tabindex="-1"></a><span class="in">  rgb(1,1,1), # white = no correlation </span></span>
<span id="cb36-459"><a href="#cb36-459" aria-hidden="true" tabindex="-1"></a><span class="in">  hsv(h=0, v=1, s=(1:10/10))) # red = positive correlation</span></span>
<span id="cb36-460"><a href="#cb36-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-461"><a href="#cb36-461" aria-hidden="true" tabindex="-1"></a><span class="in">#png(here("plots", "heatmapzlogcounts.png"), width = 30, height= 30, units = "cm", res = 300)</span></span>
<span id="cb36-462"><a href="#cb36-462" aria-hidden="true" tabindex="-1"></a><span class="in">heatmap(cor(zlogcounts), </span></span>
<span id="cb36-463"><a href="#cb36-463" aria-hidden="true" tabindex="-1"></a><span class="in">        symm=TRUE, </span></span>
<span id="cb36-464"><a href="#cb36-464" aria-hidden="true" tabindex="-1"></a><span class="in">        zlim=c(-1,1), </span></span>
<span id="cb36-465"><a href="#cb36-465" aria-hidden="true" tabindex="-1"></a><span class="in">        col=cor.colours, </span></span>
<span id="cb36-466"><a href="#cb36-466" aria-hidden="true" tabindex="-1"></a><span class="in">        margins=c(7,7))</span></span>
<span id="cb36-467"><a href="#cb36-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-468"><a href="#cb36-468" aria-hidden="true" tabindex="-1"></a><span class="in">#dev.off()</span></span>
<span id="cb36-469"><a href="#cb36-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-470"><a href="#cb36-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-471"><a href="#cb36-471" aria-hidden="true" tabindex="-1"></a><span class="fu">### Collinearity</span></span>
<span id="cb36-472"><a href="#cb36-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-473"><a href="#cb36-473" aria-hidden="true" tabindex="-1"></a>As a result of the normalisation unit of finite verb phrases for verb-based features, the present tense (VPRT) and past tense (VBD) variables are correlated to a very high degree:</span>
<span id="cb36-474"><a href="#cb36-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-475"><a href="#cb36-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collinear}</span></span>
<span id="cb36-476"><a href="#cb36-476" aria-hidden="true" tabindex="-1"></a><span class="in">cor(data$VPRT, data$VBD) |&gt; round(2)</span></span>
<span id="cb36-477"><a href="#cb36-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-478"><a href="#cb36-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-479"><a href="#cb36-479" aria-hidden="true" tabindex="-1"></a>We therefore remove the least marked of the pair of collinear variables: VPRT.</span>
<span id="cb36-480"><a href="#cb36-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-481"><a href="#cb36-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collinear2}</span></span>
<span id="cb36-482"><a href="#cb36-482" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- data |&gt; </span></span>
<span id="cb36-483"><a href="#cb36-483" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(VPRT))</span></span>
<span id="cb36-484"><a href="#cb36-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-485"><a href="#cb36-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-486"><a href="#cb36-486" aria-hidden="true" tabindex="-1"></a><span class="fu">### MSA</span></span>
<span id="cb36-487"><a href="#cb36-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-488"><a href="#cb36-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r factorability.TEC}</span></span>
<span id="cb36-489"><a href="#cb36-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-490"><a href="#cb36-490" aria-hidden="true" tabindex="-1"></a><span class="in">kmo &lt;- KMO(data[,9:ncol(data)]) # The first eight columns contain metadata.</span></span>
<span id="cb36-491"><a href="#cb36-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-492"><a href="#cb36-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-493"><a href="#cb36-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-494"><a href="#cb36-494" aria-hidden="true" tabindex="-1"></a>The overall MSA value of the dataset is <span class="in">`{r} kmo$MSA |&gt; round(2)`</span>. The features have the following individual MSA values (ordered from lowest to largest):</span>
<span id="cb36-495"><a href="#cb36-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-498"><a href="#cb36-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-499"><a href="#cb36-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-500"><a href="#cb36-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-501"><a href="#cb36-501" aria-hidden="true" tabindex="-1"></a>kmo<span class="sc">$</span>MSAi[<span class="fu">order</span>(kmo<span class="sc">$</span>MSAi)] <span class="sc">|&gt;</span>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb36-502"><a href="#cb36-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-503"><a href="#cb36-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-504"><a href="#cb36-504" aria-hidden="true" tabindex="-1"></a>We aim to remove features with an individual MSA <span class="sc">\&lt;</span> 0.5. All features have individual MSAs of <span class="sc">\&gt;</span> 0.5 (but only because TPP3P was merged into a broader category in an earlier chunk).</span>
<span id="cb36-505"><a href="#cb36-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-506"><a href="#cb36-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scree plot</span></span>
<span id="cb36-507"><a href="#cb36-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-508"><a href="#cb36-508" aria-hidden="true" tabindex="-1"></a>Six components were originally retained on the basis of the following screeplot, though only the first four were found to be interpretable and were therefore included in the model.</span>
<span id="cb36-509"><a href="#cb36-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-512"><a href="#cb36-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-513"><a href="#cb36-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb36-514"><a href="#cb36-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-515"><a href="#cb36-515" aria-hidden="true" tabindex="-1"></a><span class="co"># png(here("plots", "screeplot-TEC-Ref_3Reg.png"), width = 20, height= 12, units = "cm", res = 300)</span></span>
<span id="cb36-516"><a href="#cb36-516" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(data[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(data)], <span class="at">factors =</span> <span class="cn">FALSE</span>, <span class="at">pc =</span> <span class="cn">TRUE</span>) <span class="co"># </span></span>
<span id="cb36-517"><a href="#cb36-517" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb36-518"><a href="#cb36-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-519"><a href="#cb36-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb36-520"><a href="#cb36-520" aria-hidden="true" tabindex="-1"></a>pca1 <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">principal</span>(data[<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(data)], </span>
<span id="cb36-521"><a href="#cb36-521" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nfactors =</span> <span class="dv">6</span>)</span>
<span id="cb36-522"><a href="#cb36-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-523"><a href="#cb36-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-524"><a href="#cb36-524" aria-hidden="true" tabindex="-1"></a><span class="fu">### Communalities</span></span>
<span id="cb36-525"><a href="#cb36-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-526"><a href="#cb36-526" aria-hidden="true" tabindex="-1"></a>If features with final communalities of <span class="sc">\&lt;</span> 0.2 are removed, TIME would have to be removed. TIME was therefore merged with FREQ in an earlier chunk so that now all features have final communalities of <span class="sc">\&gt;</span> 0.2 (note that this is a very generous threshold!).</span>
<span id="cb36-527"><a href="#cb36-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-528"><a href="#cb36-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r communalities}</span></span>
<span id="cb36-529"><a href="#cb36-529" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-530"><a href="#cb36-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-531"><a href="#cb36-531" aria-hidden="true" tabindex="-1"></a><span class="in">pca1$communality |&gt; sort() |&gt; round(2)</span></span>
<span id="cb36-532"><a href="#cb36-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-533"><a href="#cb36-533" aria-hidden="true" tabindex="-1"></a><span class="in">#saveRDS(data, here("data", "processed", "dataforPCA.rds")) # Last saved on 6 March 2024</span></span>
<span id="cb36-534"><a href="#cb36-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-535"><a href="#cb36-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-536"><a href="#cb36-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-537"><a href="#cb36-537" aria-hidden="true" tabindex="-1"></a>The final dataset entered in the analysis described in Chapter 7 therefore comprises <span class="in">`{r} nrow(data)  |&gt; format(big.mark=",")`</span> texts/files, each with logged standardised normalised frequencies for <span class="in">`{r} ncol(data)-8`</span> linguistic features.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.elenlefoll.eu">Elen Le Foll</a></p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://benjamins.com/catalog/scl">Textbook English</a></p>
</div>
    <div class="nav-footer-right">
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a></p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>