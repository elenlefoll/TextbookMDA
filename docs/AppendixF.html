<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.30">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Elen Le Foll">
<title>Textbook English – Appendix F — Data Analysis for the Model of Intra-Textbook Variation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./AppendixG.html" rel="next">
<link href="./AppendixE.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./AppendixA.html">Appendices</a></li><li class="breadcrumb-item"><a href="./AppendixF.html"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Intra-Textbook Variation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Textbook English <br>(Le Foll 2024)</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="mailto:elefoll@uni-koeln.de" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
    <a href="https://github.com/elenlefoll/TextbookMDA/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Textbook-English.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Online supplements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./OpenScience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Open Science statement</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Synthesis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Literature Review Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Corpus Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Linguistic Features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Evaluation of the Multi-Feature Tagger of English (MFTE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Intra-Textbook Variation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixF.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Intra-Textbook Variation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AppendixH.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#packages-required" id="toc-packages-required" class="nav-link active" data-scroll-target="#packages-required"><span class="header-section-number">F.1</span> Packages required</a></li>
  <li>
<a href="#preparing-the-data-for-pca" id="toc-preparing-the-data-for-pca" class="nav-link" data-scroll-target="#preparing-the-data-for-pca"><span class="header-section-number">F.2</span> Preparing the data for PCA</a>
  <ul class="collapse">
<li><a href="#tec-data-import" id="toc-tec-data-import" class="nav-link" data-scroll-target="#tec-data-import"><span class="header-section-number">F.2.1</span> TEC data import</a></li>
  </ul>
</li>
  <li>
<a href="#checking-the-factorability-of-data" id="toc-checking-the-factorability-of-data" class="nav-link" data-scroll-target="#checking-the-factorability-of-data"><span class="header-section-number">F.3</span> Checking the factorability of data</a>
  <ul class="collapse">
<li><a href="#removal-of-feature-with-msas-of-0.5" id="toc-removal-of-feature-with-msas-of-0.5" class="nav-link" data-scroll-target="#removal-of-feature-with-msas-of-0.5"><span class="header-section-number">F.3.1</span> Removal of feature with MSAs of &lt; 0.5</a></li>
  <li><a href="#choosing-the-number-of-principal-components-to-retain" id="toc-choosing-the-number-of-principal-components-to-retain" class="nav-link" data-scroll-target="#choosing-the-number-of-principal-components-to-retain"><span class="header-section-number">F.3.2</span> Choosing the number of principal components to retain</a></li>
  <li><a href="#excluding-features-with-low-final-communalites" id="toc-excluding-features-with-low-final-communalites" class="nav-link" data-scroll-target="#excluding-features-with-low-final-communalites"><span class="header-section-number">F.3.3</span> Excluding features with low final communalites</a></li>
  </ul>
</li>
  <li><a href="#testing-the-effect-of-rotating-the-components" id="toc-testing-the-effect-of-rotating-the-components" class="nav-link" data-scroll-target="#testing-the-effect-of-rotating-the-components"><span class="header-section-number">F.4</span> Testing the effect of rotating the components</a></li>
  <li>
<a href="#principal-component-analysis-pca" id="toc-principal-component-analysis-pca" class="nav-link" data-scroll-target="#principal-component-analysis-pca"><span class="header-section-number">F.5</span> Principal Component Analysis (PCA)</a>
  <ul class="collapse">
<li><a href="#using-the-full-dataset" id="toc-using-the-full-dataset" class="nav-link" data-scroll-target="#using-the-full-dataset"><span class="header-section-number">F.5.1</span> Using the full dataset</a></li>
  <li><a href="#using-random-subsets-of-the-data" id="toc-using-random-subsets-of-the-data" class="nav-link" data-scroll-target="#using-random-subsets-of-the-data"><span class="header-section-number">F.5.2</span> Using random subsets of the data</a></li>
  <li><a href="#using-specific-subsets-of-the-data" id="toc-using-specific-subsets-of-the-data" class="nav-link" data-scroll-target="#using-specific-subsets-of-the-data"><span class="header-section-number">F.5.3</span> Using specific subsets of the data</a></li>
  <li><a href="#performing-the-pca" id="toc-performing-the-pca" class="nav-link" data-scroll-target="#performing-the-pca"><span class="header-section-number">F.5.4</span> Performing the PCA</a></li>
  </ul>
</li>
  <li>
<a href="#plotting-pca-results" id="toc-plotting-pca-results" class="nav-link" data-scroll-target="#plotting-pca-results"><span class="header-section-number">F.6</span> Plotting PCA results</a>
  <ul class="collapse">
<li><a href="#d-plots" id="toc-d-plots" class="nav-link" data-scroll-target="#d-plots"><span class="header-section-number">F.6.1</span> 3D plots</a></li>
  </ul>
</li>
  <li>
<a href="#two-dimensional-plots-biplots" id="toc-two-dimensional-plots-biplots" class="nav-link" data-scroll-target="#two-dimensional-plots-biplots"><span class="header-section-number">F.7</span> Two-dimensional plots (biplots)</a>
  <ul class="collapse">
<li><a href="#data-wrangling-for-pcatools" id="toc-data-wrangling-for-pcatools" class="nav-link" data-scroll-target="#data-wrangling-for-pcatools"><span class="header-section-number">F.7.1</span> Data wrangling for PCAtools</a></li>
  <li><a href="#pairs-plot" id="toc-pairs-plot" class="nav-link" data-scroll-target="#pairs-plot"><span class="header-section-number">F.7.2</span> Pairs plot</a></li>
  <li><a href="#bi-plots" id="toc-bi-plots" class="nav-link" data-scroll-target="#bi-plots"><span class="header-section-number">F.7.3</span> Bi-plots</a></li>
  </ul>
</li>
  <li><a href="#feature-contributions-loadings-on-each-component" id="toc-feature-contributions-loadings-on-each-component" class="nav-link" data-scroll-target="#feature-contributions-loadings-on-each-component"><span class="header-section-number">F.8</span> Feature contributions (loadings) on each component</a></li>
  <li><a href="#exploring-the-dimensions-of-the-model" id="toc-exploring-the-dimensions-of-the-model" class="nav-link" data-scroll-target="#exploring-the-dimensions-of-the-model"><span class="header-section-number">F.9</span> Exploring the dimensions of the model</a></li>
  <li>
<a href="#computing-mixed-effects-models-of-the-dimension-scores" id="toc-computing-mixed-effects-models-of-the-dimension-scores" class="nav-link" data-scroll-target="#computing-mixed-effects-models-of-the-dimension-scores"><span class="header-section-number">F.10</span> Computing mixed-effects models of the dimension scores</a>
  <ul class="collapse">
<li><a href="#dimension-1-overt-instructions-and-explanations" id="toc-dimension-1-overt-instructions-and-explanations" class="nav-link" data-scroll-target="#dimension-1-overt-instructions-and-explanations"><span class="header-section-number">F.10.1</span> Dimension 1: ‘Overt instructions and explanations’</a></li>
  <li><a href="#dimension-2-involved-vs.-informational-production" id="toc-dimension-2-involved-vs.-informational-production" class="nav-link" data-scroll-target="#dimension-2-involved-vs.-informational-production"><span class="header-section-number">F.10.2</span> Dimension 2: ‘Involved vs.&nbsp;Informational Production’</a></li>
  <li><a href="#dimension-3-narrative-vs.-factual-discourse" id="toc-dimension-3-narrative-vs.-factual-discourse" class="nav-link" data-scroll-target="#dimension-3-narrative-vs.-factual-discourse"><span class="header-section-number">F.10.3</span> Dimension 3: ‘Narrative vs.&nbsp;factual discourse’</a></li>
  <li><a href="#dimension-4-informational-compression-vs.-elaboration" id="toc-dimension-4-informational-compression-vs.-elaboration" class="nav-link" data-scroll-target="#dimension-4-informational-compression-vs.-elaboration"><span class="header-section-number">F.10.4</span> Dimension 4: ‘Informational compression vs.&nbsp;elaboration’</a></li>
  <li><a href="#testing-model-assumptions" id="toc-testing-model-assumptions" class="nav-link" data-scroll-target="#testing-model-assumptions"><span class="header-section-number">F.10.5</span> Testing model assumptions</a></li>
  </ul>
</li>
  <li>
<a href="#packages-used-in-this-script" id="toc-packages-used-in-this-script" class="nav-link" data-scroll-target="#packages-used-in-this-script"><span class="header-section-number">F.11</span> Packages used in this script</a>
  <ul class="collapse">
<li><a href="#package-names-and-versions" id="toc-package-names-and-versions" class="nav-link" data-scroll-target="#package-names-and-versions"><span class="header-section-number">F.11.1</span> Package names and versions</a></li>
  <li><a href="#package-references" id="toc-package-references" class="nav-link" data-scroll-target="#package-references"><span class="header-section-number">F.11.2</span> Package references</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./AppendixA.html">Appendices</a></li><li class="breadcrumb-item"><a href="./AppendixF.html"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Data Analysis for the Model of Intra-Textbook Variation</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Appendix F — Data Analysis for the Model of Intra-Textbook Variation</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>This script documents the analysis of the pre-processed data from the Textbook English Corpus (TEC) to arrive at the multi-dimensional model of intra-textbook linguistic variation (Chapter 6). It generates all of the statistics and plots included in the book, as well as many others that were used in the analysis, but not included in the book for reasons of space.</p>
<section id="packages-required" class="level2" data-number="F.1"><h2 data-number="F.1" class="anchored" data-anchor-id="packages-required">
<span class="header-section-number">F.1</span> Packages required</h2>
<p>The following packages must be installed and loaded to carry out the following analyses.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original study</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span> <span class="co"># For its confusion matrix function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span> <span class="co"># For 95% CI</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvlenth.github.io/emmeans/">emmeans</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span> <span class="co"># For circular graphs of variables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/">forcats</a></span><span class="op">)</span> <span class="co"># For data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jrnold.github.io/ggthemes/">ggthemes</a></span><span class="op">)</span> <span class="co"># For theme of factoextra plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span> <span class="co"># For dynamic file paths</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span> <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co"># For linear regression modelling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span> <span class="co"># To create figures with more than one plot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kevinblighe/PCAtools">PCAtools</a></span><span class="op">)</span> <span class="co"># For nice biplots of PCA results</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span> <span class="co"># For various useful stats function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co"># For model plots and tables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># For data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbreheny.github.io/visreg">visreg</a></span><span class="op">)</span> <span class="co"># For plots of interaction effects</span></span>
<span></span>
<span><span class="co"># From https://github.com/RainCloudPlots/RainCloudPlots:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R_rainclouds.R"</span><span class="op">)</span><span class="op">)</span> <span class="co"># For geom_flat_violin rainplots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="preparing-the-data-for-pca" class="level2" data-number="F.2"><h2 data-number="F.2" class="anchored" data-anchor-id="preparing-the-data-for-pca">
<span class="header-section-number">F.2</span> Preparing the data for PCA</h2>
<section id="tec-data-import" class="level3" data-number="F.2.1"><h3 data-number="F.2.1" class="anchored" data-anchor-id="tec-data-import">
<span class="header-section-number">F.2.1</span> TEC data import</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TxBcounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"TxBcounts3.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># colnames(TxBcounts)</span></span>
<span><span class="co"># nrow(TxBcounts)</span></span>
<span></span>
<span><span class="va">TxBzlogcounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"TxBzlogcounts.rds"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># nrow(TxBzlogcounts)</span></span>
<span><span class="co"># colnames(TxBzlogcounts)</span></span>
<span></span>
<span><span class="va">TxBdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">TxBcounts</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">TxBzlogcounts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># str(TxBdata)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>First, the TEC data as processed in Appendix D is imported. It comprises 1,961 texts/files, each with logged standardised normalised frequencies for 66 linguistic features.</p>
</section></section><section id="checking-the-factorability-of-data" class="level2" data-number="F.3"><h2 data-number="F.3" class="anchored" data-anchor-id="checking-the-factorability-of-data">
<span class="header-section-number">F.3</span> Checking the factorability of data</h2>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/KMO.html">KMO</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The overall MSA value of the dataset is 0.86. The features have the following individual MSA values (ordered from lowest to largest):</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo</span><span class="op">$</span><span class="va">MSAi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">kmo</span><span class="op">$</span><span class="va">MSAi</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  MDWO   MDWS   MDNE   MDCA    VBD   VPRT    POS    ACT   FREQ  TPP3S     LD 
  0.34   0.46   0.52   0.53   0.59   0.60   0.64   0.65   0.65   0.66   0.68 
 CAUSE   COND   MDCO   VIMP  NCOMP     DT  TPP3P   STPR     RP   SPP2 MENTAL 
  0.69   0.75   0.77   0.78   0.79   0.80   0.80   0.81   0.81   0.83   0.84 
 DOAUX   WHSC    VBG  EXIST  THATD   COMM  FPP1S     IN     NN   WHQU   JJAT 
  0.84   0.85   0.86   0.86   0.86   0.87   0.87   0.88   0.88   0.89   0.89 
  DEMO   THRC ASPECT     CC     EX  OCCUR   PEAS    TTR   YNQU    AWL   QUAN 
  0.89   0.89   0.90   0.90   0.90   0.90   0.91   0.91   0.91   0.92   0.92 
 FPP1P   PROG    XX0   CONT   TIME   BEMA  SPLIT   PASS   JJPR    AMP   QUPR 
  0.92   0.92   0.92   0.92   0.93   0.93   0.93   0.94   0.94   0.95   0.95 
  THSC     RB   FPUH    CUZ    VBN    PIT    DMA POLITE   EMPH    HDG  PLACE 
  0.95   0.95   0.95   0.95   0.95   0.96   0.96   0.96   0.96   0.96   0.97 </code></pre>
</div>
</div>
<section id="removal-of-feature-with-msas-of-0.5" class="level3" data-number="F.3.1"><h3 data-number="F.3.1" class="anchored" data-anchor-id="removal-of-feature-with-msas-of-0.5">
<span class="header-section-number">F.3.1</span> Removal of feature with MSAs of &lt; 0.5</h3>
<p>We first remove the first feature with an individual MSA &lt; 0.5, then check the MSA values again and continue removing features one by one if necessary.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TxBdata</span> <span class="op">&lt;-</span> <span class="va">TxBdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MDWO</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kmo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/KMO.html">KMO</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The overall MSA value of the dataset is now 0.87. None of the remaining features have individual MSA values below 0.5:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo2</span><span class="op">$</span><span class="va">MSAi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">kmo2</span><span class="op">$</span><span class="va">MSAi</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  MDWS   MDNE   MDCA    VBD    POS   VPRT   FREQ    ACT  TPP3S     LD  CAUSE 
  0.55   0.58   0.61   0.63   0.64   0.65   0.65   0.66   0.66   0.69   0.70 
  MDCO   COND     DT  TPP3P   VIMP  NCOMP     RP   STPR   SPP2  DOAUX MENTAL 
  0.77   0.80   0.80   0.80   0.81   0.81   0.81   0.82   0.83   0.84   0.85 
   VBG   WHSC  EXIST  THATD  FPP1S   COMM     IN     NN   DEMO   WHQU   THRC 
  0.85   0.85   0.86   0.87   0.87   0.87   0.88   0.89   0.89   0.89   0.89 
  JJAT ASPECT   PEAS     EX  OCCUR     CC    TTR   YNQU    AWL   QUAN  FPP1P 
  0.89   0.89   0.90   0.90   0.91   0.91   0.91   0.91   0.92   0.92   0.92 
  TIME    XX0   CONT   PROG   BEMA  SPLIT   PASS   JJPR   THSC    AMP     RB 
  0.92   0.92   0.93   0.93   0.93   0.93   0.94   0.94   0.95   0.95   0.95 
  QUPR   FPUH    PIT    VBN    DMA    CUZ POLITE   EMPH    HDG  PLACE 
  0.95   0.95   0.96   0.96   0.96   0.96   0.96   0.96   0.96   0.97 </code></pre>
</div>
</div>
</section><section id="choosing-the-number-of-principal-components-to-retain" class="level3" data-number="F.3.2"><h3 data-number="F.3.2" class="anchored" data-anchor-id="choosing-the-number-of-principal-components-to-retain">
<span class="header-section-number">F.3.2</span> Choosing the number of principal components to retain</h3>
<p>On the basis of this scree plot, six principal components were initially retained.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot screen plot</span></span>
<span><span class="co">#png(here("plots", "screeplot-TEC-only.png"), width = 20, height= 12, units = "cm", res = 300)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/VSS.scree.html">scree</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span>, factors <span class="op">=</span> <span class="cn">FALSE</span>, pc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Retain six components</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/screeplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="AppendixF_files/figure-html/screeplot-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#dev.off()</span></span>
<span></span>
<span><span class="co"># Perform PCA</span></span>
<span><span class="va">pca1</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/principal.html">principal</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                         nfactors <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                         rotate <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="co">#pca1$loadings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="excluding-features-with-low-final-communalites" class="level3" data-number="F.3.3"><h3 data-number="F.3.3" class="anchored" data-anchor-id="excluding-features-with-low-final-communalites">
<span class="header-section-number">F.3.3</span> Excluding features with low final communalites</h3>
<p>We first check whether some feature have extremely low communalities (see <a href="https://rdrr.io/cran/FactorAssumptions/man/communalities_optimal_solution.htmlhttps://rdrr.io/cran/FactorAssumptions/man/communalities_optimal_solution.html">https://rdrr.io/cran/FactorAssumptions/man/communalities_optimal_solution.html</a>).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  STPR   MDNE    HDG  CAUSE   FREQ   THRC    POS   PROG    ACT   DEMO   MDWS 
  0.09   0.17   0.17   0.19   0.22   0.22   0.24   0.26   0.26   0.27   0.28 
   CUZ   COND   QUPR  EXIST   MDCO  NCOMP  OCCUR   TIME ASPECT  TPP3P    AMP 
  0.28   0.28   0.29   0.29   0.31   0.31   0.32   0.32   0.33   0.33   0.34 
    RP  THATD   THSC     EX  FPP1P  PLACE    PIT    VBG   PEAS   MDCA  DOAUX 
  0.34   0.36   0.39   0.43   0.43   0.43   0.45   0.46   0.47   0.48   0.48 
   VBN   JJPR   JJAT   WHSC  SPLIT   EMPH   QUAN MENTAL  TPP3S   PASS   YNQU 
  0.48   0.49   0.49   0.50   0.51   0.53   0.55   0.56   0.56   0.57   0.58 
POLITE     RB     CC    XX0     DT   COMM   WHQU    TTR  FPP1S     IN     LD 
  0.58   0.58   0.58   0.59   0.62   0.62   0.64   0.65   0.67   0.68   0.68 
  FPUH   VPRT   SPP2   BEMA    DMA    VBD    AWL   CONT     NN   VIMP 
  0.70   0.71   0.72   0.74   0.74   0.80   0.85   0.85   0.87   0.90 </code></pre>
</div>
</div>
<p>As we chose to exclude features with communalities of &lt; 0.2, we remove STPR, HDG, MDNE and CAUSE from the dataset to be analysed.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TxBdataforPCA</span> <span class="op">&lt;-</span> <span class="va">TxBdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">STPR</span>, <span class="va">MDNE</span>, <span class="va">HDG</span>, <span class="va">CAUSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The overall MSA value of the dataset is now 0.88. None of the remaining features have individual MSA values below 0.5:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo3</span><span class="op">$</span><span class="va">MSAi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">kmo3</span><span class="op">$</span><span class="va">MSAi</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  MDWS   MDCA    POS   FREQ    VBD  TPP3S   VPRT    ACT     LD   COND     DT 
  0.54   0.64   0.64   0.65   0.65   0.66   0.66   0.67   0.69   0.78   0.79 
  MDCO  TPP3P     RP  NCOMP   VIMP   SPP2  DOAUX MENTAL   WHSC    VBG  THATD 
  0.79   0.81   0.82   0.82   0.82   0.82   0.84   0.85   0.86   0.86   0.86 
 EXIST  FPP1S   COMM     NN     IN   WHQU   DEMO ASPECT   JJAT   THRC     EX 
  0.86   0.87   0.88   0.89   0.89   0.89   0.89   0.89   0.89   0.90   0.90 
 OCCUR   PEAS     CC   YNQU   QUAN    AWL   TIME    XX0  FPP1P    TTR   CONT 
  0.90   0.91   0.91   0.91   0.91   0.92   0.92   0.92   0.92   0.92   0.93 
  PROG   BEMA  SPLIT   PASS   JJPR   THSC     RB   QUPR    AMP   FPUH    PIT 
  0.93   0.93   0.93   0.94   0.94   0.95   0.95   0.95   0.95   0.95   0.95 
   VBN    DMA POLITE    CUZ   EMPH  PLACE 
  0.95   0.96   0.96   0.96   0.96   0.97 </code></pre>
</div>
</div>
<p>The final number of linguistic features entered in the intra-textbook model of linguistic variation is 61.</p>
</section></section><section id="testing-the-effect-of-rotating-the-components" class="level2" data-number="F.4"><h2 data-number="F.4" class="anchored" data-anchor-id="testing-the-effect-of-rotating-the-components">
<span class="header-section-number">F.4</span> Testing the effect of rotating the components</h2>
<p>This chunk was used when considering whether or not to rotate the components (see methods section). Ultimately, the components were not rotated.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Comparing a rotated vs. a non-rotated solution</span></span>
<span></span>
<span><span class="co">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span></span>
<span><span class="co"># No rotation</span></span>
<span><span class="va">pca2</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/principal.html">principal</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                         nfactors <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                         rotate <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pca2</span><span class="op">$</span><span class="va">loadings</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/biplot.psych.html">biplot.psych</a></span><span class="op">(</span><span class="va">pca2</span>, </span>
<span>             vars <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             choose<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>             <span class="op">)</span></span>
<span></span>
<span><span class="co"># Promax rotation</span></span>
<span><span class="va">pca2.rotated</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/principal.html">principal</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                         nfactors <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                         rotate <span class="op">=</span> <span class="st">"promax"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This summary shows the component correlations which is particularly interesting</span></span>
<span><span class="va">pca2.rotated</span></span>
<span></span>
<span><span class="va">pca2.rotated</span><span class="op">$</span><span class="va">loadings</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/biplot.psych.html">biplot.psych</a></span><span class="op">(</span><span class="va">pca2.rotated</span>, vars <span class="op">=</span> <span class="cn">TRUE</span>, choose<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="principal-component-analysis-pca" class="level2" data-number="F.5"><h2 data-number="F.5" class="anchored" data-anchor-id="principal-component-analysis-pca">
<span class="header-section-number">F.5</span> Principal Component Analysis (PCA)</h2>
<section id="using-the-full-dataset" class="level3" data-number="F.5.1"><h3 data-number="F.5.1" class="anchored" data-anchor-id="using-the-full-dataset">
<span class="header-section-number">F.5.1</span> Using the full dataset</h3>
<p>Except outliers removed as part of the data preparation (see Appendix D).</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform PCA on full data</span></span>
<span><span class="va">TxBdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"TxBdataforPCA.rds"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="using-random-subsets-of-the-data" class="level3" data-number="F.5.2"><h3 data-number="F.5.2" class="anchored" data-anchor-id="using-random-subsets-of-the-data">
<span class="header-section-number">F.5.2</span> Using random subsets of the data</h3>
<p>Alternatively, it is possible to conduct the PCA on random subsets of the data to test the stability of the solution. Re-running this line will generate a new subset of the TEC texts containing 2/3 of the texts randomly sampled.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TxBdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"TxBdataforPCA.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1961</span><span class="op">*</span><span class="fl">0.6</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span></span>
<span><span class="va">TxBdata</span><span class="op">$</span><span class="va">Filename</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span> <span class="co"># Check that there is enough data to conduct a PCA. This ratio should be at least 5 (see Friginal &amp; Hardy 2014: 303–304).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="using-specific-subsets-of-the-data" class="level3" data-number="F.5.3"><h3 data-number="F.5.3" class="anchored" data-anchor-id="using-specific-subsets-of-the-data">
<span class="header-section-number">F.5.3</span> Using specific subsets of the data</h3>
<p>The following chunk can be used to perform the PCA on a country subset of the data to test the stability of the solution. See <span class="citation" data-cites="lefoll">(<a href="references.html#ref-lefoll" role="doc-biblioref">Le Foll</a>)</span> for a detailed analysis of the subcorpus of textbooks used in Germany.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TxBdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"TxBdataforPCA.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">#filter(Country == "France")</span></span>
<span>  <span class="co">#filter(Country == "Germany")</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">"Spain"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span></span>
<span><span class="va">TxBdata</span><span class="op">$</span><span class="va">Filename</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="co"># Check data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span> <span class="co"># Check that there is enough data to conduct a PCA. This should be &gt; 5 (see Friginal &amp; Hardy 2014: 303–304).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="performing-the-pca" class="level3" data-number="F.5.4"><h3 data-number="F.5.4" class="anchored" data-anchor-id="performing-the-pca">
<span class="header-section-number">F.5.4</span> Performing the PCA</h3>
<p>We perform the PCA using the <code>prcomp</code> function and print a summary of the results.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span>, scale.<span class="op">=</span><span class="cn">FALSE</span>, rank. <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="co"># All quantitative variables for all TxB files except outliers</span></span>
<span><span class="va">register</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="st">"Register"</span><span class="op">]</span><span class="op">)</span> <span class="co"># Register</span></span>
<span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="st">"Level"</span><span class="op">]</span><span class="op">)</span> <span class="co"># Textbook proficiency level</span></span>
<span></span>
<span><span class="co"># summary(register)</span></span>
<span><span class="co"># summary(level)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pca</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Importance of first k=6 (out of 61) components:
                          PC1    PC2     PC3     PC4     PC5     PC6
Standard deviation     2.1693 1.7776 1.08902 1.00207 0.84288 0.76792
Proportion of Variance 0.2108 0.1416 0.05313 0.04499 0.03183 0.02642
Cumulative Proportion  0.2108 0.3524 0.40553 0.45051 0.48234 0.50876</code></pre>
</div>
</div>
</section></section><section id="plotting-pca-results" class="level2" data-number="F.6"><h2 data-number="F.6" class="anchored" data-anchor-id="plotting-pca-results">
<span class="header-section-number">F.6</span> Plotting PCA results</h2>
<section id="d-plots" class="level3" data-number="F.6.1"><h3 data-number="F.6.1" class="anchored" data-anchor-id="d-plots">
<span class="header-section-number">F.6.1</span> 3D plots</h3>
<p>The following chunk can be used to create projections of TEC texts on three dimensions of the model. These plots cannot be rendered in two dimensions and are therefore not generated in the present document. For more information on the <code>pca3d</code> library, see: <a href="https://cran.r-project.org/web/packages/pca3d/vignettes/pca3d.pdf" class="uri">https://cran.r-project.org/web/packages/pca3d/vignettes/pca3d.pdf</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pca3d</span><span class="op">)</span> <span class="co"># For 3-D plots</span></span>
<span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span> <span class="co"># without poetry</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Conversation"</span>, <span class="st">"Fiction"</span>, <span class="st">"Informative"</span>, <span class="st">"Instructional"</span>, <span class="st">"Personal"</span><span class="op">)</span></span>
<span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/show_col.html">show_col</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="co"># Check colours</span></span>
<span></span>
<span><span class="fu">pca3d</span><span class="op">(</span><span class="va">pca</span>, </span>
<span>      group <span class="op">=</span> <span class="va">register</span>,</span>
<span>      components <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>      <span class="co">#components = 4:6,</span></span>
<span>      show.ellipses<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>      ellipse.ci<span class="op">=</span><span class="fl">0.75</span>,</span>
<span>      show.plane<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>      col <span class="op">=</span> <span class="va">col</span>,</span>
<span>      shape <span class="op">=</span> <span class="st">"sphere"</span>,</span>
<span>      radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      legend <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">snapshotPCA3d</span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"plots"</span>, <span class="st">"PCA_TxB_3Dsnapshot.png"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"D"</span><span class="op">)</span> <span class="co"># To colour the dots according to the profiency level of the textbooks</span></span>
<span><span class="fu">pca3d</span><span class="op">(</span><span class="va">pca</span>, </span>
<span>      components <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>      group <span class="op">=</span> <span class="va">level</span>,</span>
<span>      show.ellipses<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>      ellipse.ci<span class="op">=</span><span class="fl">0.75</span>,</span>
<span>      show.plane<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>      col <span class="op">=</span> <span class="va">col</span>,</span>
<span>      shape <span class="op">=</span> <span class="st">"sphere"</span>,</span>
<span>      radius <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>      legend <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="two-dimensional-plots-biplots" class="level2" data-number="F.7"><h2 data-number="F.7" class="anchored" data-anchor-id="two-dimensional-plots-biplots">
<span class="header-section-number">F.7</span> Two-dimensional plots (biplots)</h2>
<p>These plots were generated using the <code>PCAtools</code> package, which requires the data to be formatted in a rather unconventional way so it needs to wrangled first.</p>
<section id="data-wrangling-for-pcatools" class="level3" data-number="F.7.1"><h3 data-number="F.7.1" class="anchored" data-anchor-id="data-wrangling-for-pcatools">
<span class="header-section-number">F.7.1</span> Data wrangling for PCAtools</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span></span>
<span><span class="va">TxBdata2meta</span> <span class="op">&lt;-</span> <span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">TxBdata2meta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">TxBdata2meta</span><span class="op">$</span><span class="va">Filename</span></span>
<span><span class="va">TxBdata2meta</span> <span class="op">&lt;-</span> <span class="va">TxBdata2meta</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Filename</span><span class="op">)</span></span>
<span><span class="co">#head(TxBdata2meta)</span></span>
<span></span>
<span><span class="va">TxBdata2</span> <span class="op">=</span> <span class="va">TxBdata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">TxBdata2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">TxBdata2</span><span class="op">$</span><span class="va">Filename</span></span>
<span><span class="va">TxBdata2num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">TxBdata2</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#TxBdata2num[1:12,1:3] # Check sanity of data</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/pca.html">pca</a></span><span class="op">(</span><span class="va">TxBdata2num</span>, </span>
<span>         metadata <span class="op">=</span> <span class="va">TxBdata2meta</span>,</span>
<span>         scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="pairs-plot" class="level3" data-number="F.7.2"><h3 data-number="F.7.2" class="anchored" data-anchor-id="pairs-plot">
<span class="header-section-number">F.7.2</span> Pairs plot</h3>
<p>We first produce a scatterplot matrix of all the combinations of the first six dimensions of the model of intra-textbook variation. Note that the number before the comma on each axis label shows which principal component is plotted on that axis; this is followed by the percentage of the total variance explained by that particular component. The colours correspond to the text registers.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Colour and shape scheme for all biplots</span></span>
<span><span class="va">colkey</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Conversation<span class="op">=</span><span class="st">"#BD241E"</span>, Fiction<span class="op">=</span><span class="st">"#A18A33"</span>, Informative<span class="op">=</span><span class="st">"#15274D"</span>, Instructional<span class="op">=</span><span class="st">"#F9B921"</span>, Personal<span class="op">=</span><span class="st">"#722672"</span><span class="op">)</span></span>
<span><span class="va">shapekey</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A<span class="op">=</span><span class="fl">1</span>, B<span class="op">=</span><span class="fl">2</span>, C<span class="op">=</span><span class="fl">6</span>, D<span class="op">=</span><span class="fl">0</span>, E<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Very slow, open in zoomed out window!</span></span>
<span><span class="co"># Add legend manually? Yes (take it from the biplot code below), sadly really the simplest solution, here. Or use Evert's mvar.pairs plot function (though that also requires manual axis annotation).</span></span>
<span></span>
<span><span class="co"># png(here("plots", "PCA_TxB_pairsplot.png"), width = 12, height= 19, units = "cm", res = 300)</span></span>
<span><span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/pairsplot.html">pairsplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 triangle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 components <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>                 ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 nrow <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Register"</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkey</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekey</span>,</span>
<span>                 margingaps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/PCAtools-pairsplots-TxB-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="AppendixF_files/figure-html/PCAtools-pairsplots-TxB-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="bi-plots" class="level3" data-number="F.7.3"><h3 data-number="F.7.3" class="anchored" data-anchor-id="bi-plots">
<span class="header-section-number">F.7.3</span> Bi-plots</h3>
<p>Then, biplots of the most important dimensions are generated to examine components more carefully.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colkey</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Conversation<span class="op">=</span><span class="st">"#BD241E"</span>, Fiction<span class="op">=</span><span class="st">"#A18A33"</span>, Informative<span class="op">=</span><span class="st">"#15274D"</span>, Instructional<span class="op">=</span><span class="st">"#F9B921"</span>, Personal<span class="op">=</span><span class="st">"#722672"</span><span class="op">)</span></span>
<span><span class="va">shapekey</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A<span class="op">=</span><span class="fl">1</span>, B<span class="op">=</span><span class="fl">2</span>, C<span class="op">=</span><span class="fl">6</span>, D<span class="op">=</span><span class="fl">0</span>, E<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#png(here("plots", "PCA_TxB_Biplot_PC1_PC2.png"), width = 40, height= 25, units = "cm", res = 300)</span></span>
<span><span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC1"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC2"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 <span class="co">#xlim = c(min(p$rotated$PC1)-0.5, max(p$rotated$PC1)+0.5),</span></span>
<span>                 <span class="co">#ylim = c(min(p$rotated$PC2)-0.5, max(p$rotated$PC2)+0.5),</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Register"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkey</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekey</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 axisLabSize <span class="op">=</span> <span class="fl">22</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">22</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">18</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/PCAtools-biplots-TxB-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="AppendixF_files/figure-html/PCAtools-biplots-TxB-1.png" class="img-fluid figure-img" width="1248"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#dev.off()</span></span>
<span><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC1_PC2.svg"), width = 12, height = 10)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Biplots to examine components more carefully</span></span>
<span><span class="va">pRegisters</span> <span class="op">&lt;-</span> <span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC3"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC4"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Register"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkey</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekey</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">22</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">18</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC3_PC4.svg"), width = 12, height = 10)</span></span>
<span></span>
<span><span class="co"># Biplots to examine components more carefully</span></span>
<span><span class="va">pRegisters2</span> <span class="op">&lt;-</span> <span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC5"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC6"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Register"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkey</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekey</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">22</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">18</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC5_PC6.svg"), width = 12, height = 10)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Changing the colour of the points and the ellipses to represent the texts’ target proficiency levels instead of the register allows for a different interpretation of the model.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Inverted keys for the biplots with ellipses for Level rather than Register</span></span>
<span><span class="va">colkeyLevels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A<span class="op">=</span><span class="st">"#F9B921"</span>, B<span class="op">=</span><span class="st">"#A18A33"</span>, C<span class="op">=</span><span class="st">"#BD241E"</span>, D<span class="op">=</span><span class="st">"#722672"</span>, E<span class="op">=</span><span class="st">"#15274D"</span><span class="op">)</span></span>
<span><span class="va">shapekeyLevels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Conversation<span class="op">=</span><span class="fl">1</span>, Fiction<span class="op">=</span><span class="fl">2</span>, Informative<span class="op">=</span><span class="fl">6</span>, Instructional<span class="op">=</span><span class="fl">0</span>, Personal<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pLevels</span> <span class="op">&lt;-</span> <span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC3"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC4"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 <span class="co">#xlim = c(min(p$rotated$PC1)-0.5, max(p$rotated$PC1)+0.5),</span></span>
<span>                 <span class="co">#ylim = c(min(p$rotated$PC2)-0.5, max(p$rotated$PC2)+0.5),</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkeyLevels</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Register"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekeyLevels</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">22</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">18</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC3_PC4_Level.svg"), width = 12, height = 10)</span></span>
<span></span>
<span><span class="va">pLevels2</span> <span class="op">&lt;-</span> <span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/biplot.html">biplot</a></span><span class="op">(</span><span class="va">p</span>,</span>
<span>                 x <span class="op">=</span> <span class="st">"PC5"</span>,</span>
<span>                 y <span class="op">=</span> <span class="st">"PC6"</span>,</span>
<span>                 lab <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span>                 <span class="co">#xlim = c(min(p$rotated$PC1)-0.5, max(p$rotated$PC1)+0.5),</span></span>
<span>                 <span class="co">#ylim = c(min(p$rotated$PC2)-0.5, max(p$rotated$PC2)+0.5),</span></span>
<span>                 colby <span class="op">=</span> <span class="st">"Level"</span>,</span>
<span>                 pointSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 colkey <span class="op">=</span> <span class="va">colkeyLevels</span>,</span>
<span>                 shape <span class="op">=</span> <span class="st">"Register"</span>,</span>
<span>                 shapekey <span class="op">=</span> <span class="va">shapekeyLevels</span>,</span>
<span>                 showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 legendPosition <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>                 legendTitleSize <span class="op">=</span> <span class="fl">22</span>,</span>
<span>                 legendLabSize <span class="op">=</span> <span class="fl">18</span>, </span>
<span>                 legendIconSize <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC5_PC6_Level.svg"), width = 12, height = 10)</span></span>
<span></span>
<span></span>
<span><span class="co"># Display and save the two different representations of data points on PC2 and PC3 using the {patchwork} package</span></span>
<span><span class="va">pRegisters</span> <span class="op">/</span> <span class="va">pLevels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/PCAtools-biplots-TxB-Levels-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="AppendixF_files/figure-html/PCAtools-biplots-TxB-Levels-1.png" class="img-fluid figure-img" width="1248"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC3_PC4_Register_vs_Level.svg"), width = 14, height = 20)</span></span>
<span></span>
<span><span class="co"># Display and save the two different representations of data points on PC5 and PC6 using the {patchwork} package </span></span>
<span><span class="va">pRegisters2</span> <span class="op">/</span> <span class="va">pLevels2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/PCAtools-biplots-TxB-Levels-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="AppendixF_files/figure-html/PCAtools-biplots-TxB-Levels-2.png" class="img-fluid figure-img" width="1248"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC5_PC6_Register_vs_Level.svg"), width = 14, height = 20)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="feature-contributions-loadings-on-each-component" class="level2" data-number="F.8"><h2 data-number="F.8" class="anchored" data-anchor-id="feature-contributions-loadings-on-each-component">
<span class="header-section-number">F.8</span> Feature contributions (loadings) on each component</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span>, scale.<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># All quantitative variables for all TEC files</span></span>
<span></span>
<span><span class="co"># The rotated data that represents the observations / samples is stored in rotated, while the variable loadings are stored in loadings</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">loadings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
<th style="text-align: right;">PC4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ACT</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">AMP</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ASPECT</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">AWL</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BEMA</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">CC</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">COMM</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">COND</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CONT</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">CUZ</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DEMO</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-0.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">DMA</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DOAUX</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">DT</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EMPH</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">EX</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EXIST</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">FPP1P</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FPP1S</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">FPUH</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FREQ</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">IN</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JJAT</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">JJPR</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LD</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">MDCA</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MDCO</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">MDWS</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MENTAL</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">NCOMP</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NN</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">OCCUR</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PASS</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">PEAS</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIT</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">PLACE</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POLITE</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">POS</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PROG</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">QUAN</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QUPR</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">RB</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RP</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPLIT</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPP2</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">THATD</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">THRC</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">THSC</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TIME</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">TPP3P</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TPP3S</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">TTR</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VBD</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">VBG</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VBN</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">VIMP</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VPRT</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">-0.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">WHQU</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WHSC</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">XX0</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YNQU</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.08</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can go back to the normalised frequencies of the individual features to compare them across different registers and levels, e.g.:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TxBcounts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Register</span>, <span class="va">Level</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">NCOMP</span><span class="op">)</span>, <span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/MAD.html">MAD</a></span><span class="op">(</span><span class="va">NCOMP</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Register</th>
<th style="text-align: left;">Level</th>
<th style="text-align: right;">median(NCOMP)</th>
<th style="text-align: right;">MAD(NCOMP)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">5.69</td>
<td style="text-align: right;">2.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">5.48</td>
<td style="text-align: right;">2.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">5.32</td>
<td style="text-align: right;">2.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">6.18</td>
<td style="text-align: right;">2.91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">6.21</td>
<td style="text-align: right;">2.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">4.14</td>
<td style="text-align: right;">2.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">2.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">4.05</td>
<td style="text-align: right;">1.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">5.05</td>
<td style="text-align: right;">2.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">5.05</td>
<td style="text-align: right;">2.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">8.07</td>
<td style="text-align: right;">2.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">7.62</td>
<td style="text-align: right;">2.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">7.49</td>
<td style="text-align: right;">3.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">7.56</td>
<td style="text-align: right;">2.46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">8.77</td>
<td style="text-align: right;">2.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">6.84</td>
<td style="text-align: right;">2.54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">6.80</td>
<td style="text-align: right;">2.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">6.14</td>
<td style="text-align: right;">2.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">6.22</td>
<td style="text-align: right;">2.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">2.69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">6.72</td>
<td style="text-align: right;">1.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">4.92</td>
<td style="text-align: right;">2.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">5.75</td>
<td style="text-align: right;">1.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">6.46</td>
<td style="text-align: right;">3.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">8.22</td>
<td style="text-align: right;">3.09</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Graphs of features display the features with the strongest contributions to any two dimensions of the model of intra-textbook variation. They are created using the <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">factoextra::fviz_pca_var</a></code> function.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">pca</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>             select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cos2 <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>             col.var <span class="op">=</span> <span class="st">"contrib"</span>, <span class="co"># Colour by contributions to the PC</span></span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#DB241E"</span>, <span class="st">"#722672"</span><span class="op">)</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Try to avoid too much text overlapping</span></span>
<span>             ggtheme <span class="op">=</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/graphs-of-variables-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="AppendixF_files/figure-html/graphs-of-variables-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "fviz_pca_var_PC1_PC2.svg"), width = 11, height = 9)</span></span>
<span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">pca</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>             select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>contrib <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>             col.var <span class="op">=</span> <span class="st">"contrib"</span>, <span class="co"># Colour by contributions to the PC</span></span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#DB241E"</span>, <span class="st">"#722672"</span><span class="op">)</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Try to avoid too much text overlapping</span></span>
<span>             ggtheme <span class="op">=</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/graphs-of-variables-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="AppendixF_files/figure-html/graphs-of-variables-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "fviz_pca_var_PC3_PC2.svg"), width = 9, height = 8)</span></span>
<span></span>
<span><span class="fu">factoextra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">pca</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>             select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>contrib <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>             col.var <span class="op">=</span> <span class="st">"contrib"</span>, <span class="co"># Colour by contributions to the PC</span></span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#DB241E"</span>, <span class="st">"#722672"</span><span class="op">)</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Try to avoid too much text overlapping</span></span>
<span>             ggtheme <span class="op">=</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/graphs-of-variables-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="AppendixF_files/figure-html/graphs-of-variables-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "fviz_pca_var_PC3_PC4.svg"), width = 9, height = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="exploring-the-dimensions-of-the-model" class="level2" data-number="F.9"><h2 data-number="F.9" class="anchored" data-anchor-id="exploring-the-dimensions-of-the-model">
<span class="header-section-number">F.9</span> Exploring the dimensions of the model</h2>
<p>We begin with some descriptive statistics of the dimension scores.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/#pca-results-for-variables</span></span>
<span></span>
<span><span class="co">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">)</span><span class="op">]</span>, scale.<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># All quantitative variables for all TxB files</span></span>
<span><span class="va">register</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="st">"Register"</span><span class="op">]</span><span class="op">)</span> <span class="co"># Register</span></span>
<span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="st">"Level"</span><span class="op">]</span><span class="op">)</span> <span class="co"># Textbook proficiency level</span></span>
<span></span>
<span><span class="co"># summary(register)</span></span>
<span><span class="co"># summary(level)</span></span>
<span><span class="co"># summary(pca)</span></span>
<span></span>
<span><span class="co">## Access to the PCA results for individual PC</span></span>
<span><span class="co">#pca$rotation[,1]</span></span>
<span></span>
<span><span class="va">res.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">TxBdata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Register</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Register</th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
<th style="text-align: right;">PC4</th>
<th style="text-align: right;">PC5</th>
<th style="text-align: right;">PC6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">-2.29</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: right;">-0.85</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-2.45</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Instructional</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal</td>
<td style="text-align: right;">-1.92</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.09</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Register</span>, <span class="va">Level</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Register</th>
<th style="text-align: left;">Level</th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
<th style="text-align: right;">PC4</th>
<th style="text-align: right;">PC5</th>
<th style="text-align: right;">PC6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-2.39</td>
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">-1.23</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">-2.54</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">-2.25</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">-2.10</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">-2.13</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.98</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-0.95</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">-0.46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">-0.89</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">-0.98</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">-1.57</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">-1.45</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-1.11</td>
<td style="text-align: right;">-1.94</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">-0.88</td>
<td style="text-align: right;">-0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-1.67</td>
<td style="text-align: right;">-1.19</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-2.37</td>
<td style="text-align: right;">-0.68</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-2.89</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-3.13</td>
<td style="text-align: right;">-0.79</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2.89</td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">-0.34</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">-0.49</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">Instructional</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-1.84</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">-1.11</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">-1.85</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">-0.58</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">-2.05</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">-1.89</td>
<td style="text-align: right;">-1.05</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">-0.63</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">-1.96</td>
<td style="text-align: right;">-0.92</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-1.10</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.45</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The following chunk can be used to search for example texts that are located in specific areas of the biplots. For example, we can search for texts that have high scores on Dim3 and low ones on Dim2 to proceed with a qualitative comparison and analysis of these texts.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res.ind</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">PC3</span> <span class="op">&gt;</span> <span class="fl">2.5</span> <span class="op">&amp;</span> <span class="va">PC2</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Filename</span>, <span class="va">PC2</span>, <span class="va">PC3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Filename</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Achievers_B1_plus_Narrative_0005.txt</td>
<td style="text-align: right;">-3.88</td>
<td style="text-align: right;">2.60</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solutions_Intermediate_Plus_Spoken_0018.txt</td>
<td style="text-align: right;">-2.08</td>
<td style="text-align: right;">2.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JTT_3_Narrative_0005.txt</td>
<td style="text-align: right;">-2.85</td>
<td style="text-align: right;">2.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">Achievers_B2_Narrative_00031.txt</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">2.59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Access_4_Narrative_0006.txt</td>
<td style="text-align: right;">-2.19</td>
<td style="text-align: right;">3.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="computing-mixed-effects-models-of-the-dimension-scores" class="level2" data-number="F.10"><h2 data-number="F.10" class="anchored" data-anchor-id="computing-mixed-effects-models-of-the-dimension-scores">
<span class="header-section-number">F.10</span> Computing mixed-effects models of the dimension scores</h2>
<section id="dimension-1-overt-instructions-and-explanations" class="level3" data-number="F.10.1"><h3 data-number="F.10.1" class="anchored" data-anchor-id="dimension-1-overt-instructions-and-explanations">
<span class="header-section-number">F.10.1</span> Dimension 1: ‘Overt instructions and explanations’</h3>
<p>Having compared various models, the following model is chosen as the best-fitting one.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Models with Textbook series as random intercepts</span></span>
<span><span class="va">md1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC1</span> <span class="op">~</span> <span class="va">Register</span><span class="op">*</span><span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md1Register</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC1</span> <span class="op">~</span> <span class="va">Register</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md1Level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC1</span> <span class="op">~</span> <span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">md1</span>, <span class="va">md1Register</span>, <span class="va">md1Level</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: res.ind
Models:
md1Register: PC1 ~ Register + (1 | Series)
md1Level: PC1 ~ Level + (1 | Series)
md1: PC1 ~ Register * Level + (1 | Series)
            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
md1Register    7 4080.4 4119.4 -2033.2   4066.4                         
md1Level       7 8533.0 8572.0 -4259.5   8519.0    0.0  0               
md1           27 4068.3 4219.0 -2007.2   4014.3 4504.6 20  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md1</span>, wrap.labels <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="co"># Marginal R2 = 0.890</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 1</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.59&nbsp;–&nbsp;-2.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.36&nbsp;–&nbsp;1.87</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.96&nbsp;–&nbsp;2.50</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">5.10&nbsp;–&nbsp;5.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08&nbsp;–&nbsp;0.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.019</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.30&nbsp;–&nbsp;0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.167</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.05&nbsp;–&nbsp;0.29</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.159</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06&nbsp;–&nbsp;0.41</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.010</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07&nbsp;–&nbsp;0.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.010</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] × Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.15&nbsp;–&nbsp;0.51</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.284</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] × Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.36</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02&nbsp;–&nbsp;0.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.038</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional] × Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.35&nbsp;–&nbsp;0.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.434</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] × Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.39&nbsp;–&nbsp;0.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.671</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] × Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.58&nbsp;–&nbsp;0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.130</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] × Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.32&nbsp;–&nbsp;0.32</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.993</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional] × Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.62&nbsp;–&nbsp;-0.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] × Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.72&nbsp;–&nbsp;0.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.381</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] × Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.38&nbsp;–&nbsp;0.27</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.739</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] × Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.33&nbsp;–&nbsp;0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.946</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional] × Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.72&nbsp;–&nbsp;-0.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] × Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.60&nbsp;–&nbsp;0.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.800</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] × Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.58&nbsp;–&nbsp;0.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.173</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] × Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.29&nbsp;–&nbsp;0.40</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.747</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional] × Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.50</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.77&nbsp;–&nbsp;-0.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] × Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.74&nbsp;–&nbsp;0.38</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.527</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.45</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.07</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.14</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">9</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1961</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.890 / 0.906</td>
</tr>
</tbody></table>
</div>
</div>
<p>Its estimated coefficients are visualised in the plot below.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot of fixed effects:</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md1Register</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"est"</span>,</span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, </span>
<span>           title <span class="op">=</span> <span class="st">""</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC1 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim1fixed-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="AppendixF_files/figure-html/Dim1fixed-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA1_lmer_fixedeffects_Register.svg"), height = 3, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>emmeans</code> and <code>pairs</code> functions are used to compare the estimated Dim1 scores for each register and to compare these to one another.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Register_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">md1Register</span>, <span class="st">"Register"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Register_results</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Register       emmean    SE   df lower.CL upper.CL
 Conversation  -2.2793 0.102 11.6   -2.502   -2.056
 Fiction       -0.7267 0.106 13.9   -0.955   -0.498
 Informative    0.0603 0.104 12.7   -0.165    0.286
 Instructional  2.7141 0.101 11.3    2.492    2.937
 Personal      -1.8734 0.122 25.5   -2.125   -1.622

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">Register_results</span>, adjust <span class="op">=</span> <span class="st">"tukey"</span><span class="op">)</span></span>
<span><span class="va">comparisons</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> contrast                     estimate     SE   df  t.ratio p.value
 Conversation - Fiction         -1.553 0.0508 1963  -30.535  &lt;.0001
 Conversation - Informative     -2.340 0.0465 1961  -50.341  &lt;.0001
 Conversation - Instructional   -4.993 0.0399 1961 -125.141  &lt;.0001
 Conversation - Personal        -0.406 0.0791 1958   -5.134  &lt;.0001
 Fiction - Informative          -0.787 0.0557 1962  -14.135  &lt;.0001
 Fiction - Instructional        -3.441 0.0497 1962  -69.168  &lt;.0001
 Fiction - Personal              1.147 0.0840 1958   13.645  &lt;.0001
 Informative - Instructional    -2.654 0.0447 1957  -59.399  &lt;.0001
 Informative - Personal          1.934 0.0816 1957   23.692  &lt;.0001
 Instructional - Personal        4.587 0.0780 1957   58.820  &lt;.0001

Degrees-of-freedom method: kenward-roger 
P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#write_last_clip()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">comparisons</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> contrast                     estimate     SE   df lower.CL upper.CL
 Conversation - Fiction         -1.553 0.0508 1963   -1.691   -1.414
 Conversation - Informative     -2.340 0.0465 1961   -2.466   -2.213
 Conversation - Instructional   -4.993 0.0399 1961   -5.102   -4.884
 Conversation - Personal        -0.406 0.0791 1958   -0.622   -0.190
 Fiction - Informative          -0.787 0.0557 1962   -0.939   -0.635
 Fiction - Instructional        -3.441 0.0497 1962   -3.577   -3.305
 Fiction - Personal              1.147 0.0840 1958    0.917    1.376
 Informative - Instructional    -2.654 0.0447 1957   -2.776   -2.532
 Informative - Personal          1.934 0.0816 1957    1.711    2.156
 Instructional - Personal        4.587 0.0780 1957    4.374    4.800

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#write_last_clip()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can also visualise the estimated coefficients for the textbook series, which is modelled here as a random effect.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md1</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="st">"bw"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC1 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim1random-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="AppendixF_files/figure-html/Dim1random-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA1_lmer_randomeffects.svg"), height = 3, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="dimension-2-involved-vs.-informational-production" class="level3" data-number="F.10.2"><h3 data-number="F.10.2" class="anchored" data-anchor-id="dimension-2-involved-vs.-informational-production">
<span class="header-section-number">F.10.2</span> Dimension 2: ‘Involved vs.&nbsp;Informational Production’</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">md2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC2</span> <span class="op">~</span> <span class="va">Register</span><span class="op">*</span><span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md2Register</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC2</span> <span class="op">~</span> <span class="va">Register</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md2Level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC2</span> <span class="op">~</span> <span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">md2</span>, <span class="va">md2Register</span>, <span class="va">md2Level</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Data: res.ind
Models:
md2Register: PC2 ~ Register + (1 | Series)
md2Level: PC2 ~ Level + (1 | Series)
md2: PC2 ~ Register * Level + (1 | Series)
            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
md2Register    7 6155.2 6194.3 -3070.6   6141.2                         
md2Level       7 7290.1 7329.2 -3638.1   7276.1    0.0  0               
md2           27 5200.9 5351.6 -2573.4   5146.9 2129.2 20  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md2</span><span class="op">)</span> <span class="co"># Marginal R2 = 0.723</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 2</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.20&nbsp;–&nbsp;2.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.14&nbsp;–&nbsp;-1.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-3.79&nbsp;–&nbsp;-3.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.87</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.12&nbsp;–&nbsp;-0.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.42&nbsp;–&nbsp;-1.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.96&nbsp;–&nbsp;-0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.71</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.94&nbsp;–&nbsp;-1.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.61&nbsp;–&nbsp;-2.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-2.93&nbsp;–&nbsp;-2.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.72&nbsp;–&nbsp;0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.223</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.32&nbsp;–&nbsp;0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.565</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.11&nbsp;–&nbsp;0.77</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.009</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.53</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.14&nbsp;–&nbsp;1.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.120</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.35&nbsp;–&nbsp;0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.705</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01&nbsp;–&nbsp;0.84</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.053</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.80&nbsp;–&nbsp;1.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07&nbsp;–&nbsp;1.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.081</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.44&nbsp;–&nbsp;0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.972</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.07&nbsp;–&nbsp;0.91</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.024</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.16&nbsp;–&nbsp;1.81</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.12&nbsp;–&nbsp;1.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.104</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.04&nbsp;–&nbsp;0.87</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.072</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.07&nbsp;–&nbsp;0.86</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.099</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.68&nbsp;–&nbsp;1.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.27&nbsp;–&nbsp;1.76</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.008</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.80</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.09</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.10</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">9</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1961</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.723 / 0.752</td>
</tr>
</tbody></table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># tab_model(md2Register) # Marginal R2 = 0.558</span></span>
<span><span class="co"># tab_model(md2Level) # Marginal R2 = 0.228</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Estimated coefficients of fixed effects on Dim2 scores:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md2</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"est"</span>,</span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, </span>
<span>           title <span class="op">=</span> <span class="st">""</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC2 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim2fixed-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="AppendixF_files/figure-html/Dim2fixed-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA2_lmer_fixedeffects.svg"), height = 8, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Estimated coefficients of random effects on Dim2 scores:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Random intercepts</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md2</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="st">"bw"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC2 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim2random-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="AppendixF_files/figure-html/Dim2random-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA2_lmer_randomeffects.svg"), height = 3, width = 8)</span></span>
<span></span>
<span><span class="co"># Textbook Country as a random effect variable</span></span>
<span><span class="va">md2country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC2</span> <span class="op">~</span> <span class="va">Register</span><span class="op">*</span><span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Country</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md2country</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="st">"bw"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC2 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim2random-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="AppendixF_files/figure-html/Dim2random-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA2_lmer_randomeffects_country.svg"), height = 3, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>visreg</code> function is used to visualise the distributions of the modelled Dim2 scores:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># svg(here("plots", "TxB_predicted_PC2_scores_interactions.svg"), height = 5, width = 8)</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md2</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Register"</span>, type <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, </span>
<span>       xlab <span class="op">=</span> <span class="st">"Textbook Level"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span></span>
<span>       <span class="co">#,gg = TRUE</span></span>
<span>       ,layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim2estimateplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="AppendixF_files/figure-html/Dim2estimateplots-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span>
<span></span>
<span><span class="co"># Textbook Series-Register interactions</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md2</span>, xvar <span class="op">=</span> <span class="st">"Series"</span>, by<span class="op">=</span><span class="st">"Level"</span>, type <span class="op">=</span> <span class="st">"conditional"</span>, re.form<span class="op">=</span><span class="op">~</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, </span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Textbook Series"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span>,</span>
<span>       layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim2estimateplots-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="AppendixF_files/figure-html/Dim2estimateplots-2.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Textbook Series-Register interactions</span></span>
<span><span class="co"># svg(here("plots", "TxB_PCA2_lmer_randomeffects_country_register.svg"), height = 5, width = 8)</span></span>
<span><span class="fu">visreg</span><span class="fu">::</span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md2country</span>, <span class="st">"Country"</span>, by<span class="op">=</span><span class="st">"Register"</span>, re.form<span class="op">=</span><span class="op">~</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Country</span><span class="op">)</span>,</span>
<span>               ylab<span class="op">=</span><span class="st">"PC2"</span>, line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim2estimateplots-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="AppendixF_files/figure-html/Dim2estimateplots-3.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="dimension-3-narrative-vs.-factual-discourse" class="level3" data-number="F.10.3"><h3 data-number="F.10.3" class="anchored" data-anchor-id="dimension-3-narrative-vs.-factual-discourse">
<span class="header-section-number">F.10.3</span> Dimension 3: ‘Narrative vs.&nbsp;factual discourse’</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">md3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC3</span> <span class="op">~</span> <span class="va">Register</span><span class="op">*</span><span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md3Register</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC3</span> <span class="op">~</span> <span class="va">Register</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md3Level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC3</span> <span class="op">~</span> <span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">md3</span>, <span class="va">md3Register</span>, <span class="va">md3Level</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Data: res.ind
Models:
md3Register: PC3 ~ Register + (1 | Series)
md3Level: PC3 ~ Level + (1 | Series)
md3: PC3 ~ Register * Level + (1 | Series)
            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
md3Register    7 5139.9 5179.0 -2563.0   5125.9                         
md3Level       7 5528.8 5567.9 -2757.4   5514.8   0.00  0               
md3           27 4582.6 4733.3 -2264.3   4528.6 986.21 20  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md3</span><span class="op">)</span> <span class="co"># Marginal R2 = 0.436</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 3</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.62&nbsp;–&nbsp;-1.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.50&nbsp;–&nbsp;1.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.10&nbsp;–&nbsp;-0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.82&nbsp;–&nbsp;1.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.27&nbsp;–&nbsp;0.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.411</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.77&nbsp;–&nbsp;1.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.20&nbsp;–&nbsp;1.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.50</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.30&nbsp;–&nbsp;1.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.36&nbsp;–&nbsp;1.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17&nbsp;–&nbsp;0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.004</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.52&nbsp;–&nbsp;0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.504</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.95&nbsp;–&nbsp;-0.39</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.91&nbsp;–&nbsp;0.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.242</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.41&nbsp;–&nbsp;1.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.53&nbsp;–&nbsp;0.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.362</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.94</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.21&nbsp;–&nbsp;-0.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.40&nbsp;–&nbsp;0.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.568</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.03&nbsp;–&nbsp;0.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.073</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.35&nbsp;–&nbsp;0.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.953</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.29&nbsp;–&nbsp;-0.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.58&nbsp;–&nbsp;0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.939</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.15&nbsp;–&nbsp;0.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.238</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.58&nbsp;–&nbsp;0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.364</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.01</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.32&nbsp;–&nbsp;-0.70</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.84&nbsp;–&nbsp;0.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.520</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.58</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.14</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.19</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">9</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1961</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.436 / 0.543</td>
</tr>
</tbody></table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># tab_model(md3Register) # Marginal R2 = 0.272</span></span>
<span><span class="co"># tab_model(md3Level) # Marginal R2 = 0.119</span></span>
<span></span>
<span><span class="co"># Plot of fixed effects:</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md3</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"est"</span>,</span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, </span>
<span>           title <span class="op">=</span> <span class="st">""</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC3 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim3model-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="AppendixF_files/figure-html/Dim3model-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA3_lmer_fixedeffects.svg"), height = 8, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot of random effects:</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md3</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           color <span class="op">=</span> <span class="st">"bw"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC3 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/unnamed-chunk-30-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="AppendixF_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA3_lmer_randomeffects.svg"), height = 3, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># svg(here("plots", "TxB_predicted_PC3_scores_interactions.svg"), height = 5, width = 8)</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md3</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Register"</span>, type <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, </span>
<span>       xlab <span class="op">=</span> <span class="st">"Textbook Level"</span>, ylab <span class="op">=</span> <span class="st">"PC3"</span></span>
<span>       <span class="co">#,gg = TRUE</span></span>
<span>       ,layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim3comparisons-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="AppendixF_files/figure-html/Dim3comparisons-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span>
<span></span>
<span><span class="co"># Textbook Series-Register interactions</span></span>
<span><span class="fu">visreg</span><span class="fu">::</span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md3</span>, <span class="st">"Series"</span>, by<span class="op">=</span><span class="st">"Register"</span>, re.form<span class="op">=</span><span class="op">~</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>,</span>
<span>               ylab<span class="op">=</span><span class="st">"PC3"</span>, line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim3comparisons-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="AppendixF_files/figure-html/Dim3comparisons-2.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md3</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Series"</span>, type <span class="op">=</span> <span class="st">"conditional"</span>, re.form<span class="op">=</span><span class="op">~</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, </span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Textbook Series"</span>, ylab <span class="op">=</span> <span class="st">"PC3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim3comparisons-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="AppendixF_files/figure-html/Dim3comparisons-3.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="dimension-4-informational-compression-vs.-elaboration" class="level3" data-number="F.10.4"><h3 data-number="F.10.4" class="anchored" data-anchor-id="dimension-4-informational-compression-vs.-elaboration">
<span class="header-section-number">F.10.4</span> Dimension 4: ‘Informational compression vs.&nbsp;elaboration’</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">md4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC4</span> <span class="op">~</span> <span class="va">Register</span><span class="op">*</span><span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md4Register</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC4</span> <span class="op">~</span> <span class="va">Register</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">md4Level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">PC4</span> <span class="op">~</span> <span class="va">Level</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Series</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res.ind</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">md4</span>, <span class="va">md4Register</span>, <span class="va">md4Level</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Data: res.ind
Models:
md4Register: PC4 ~ Register + (1 | Series)
md4Level: PC4 ~ Level + (1 | Series)
md4: PC4 ~ Register * Level + (1 | Series)
            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
md4Register    7 5034.0 5073.0 -2510.0   5020.0                         
md4Level       7 5043.6 5082.7 -2514.8   5029.6   0.00  0               
md4           27 4372.1 4522.8 -2159.1   4318.1 711.52 20  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">md4</span><span class="op">)</span> <span class="co"># Marginal R2 = 0.426</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">PC 4</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.76</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.56&nbsp;–&nbsp;0.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.72</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.44&nbsp;–&nbsp;1.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.09&nbsp;–&nbsp;0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.176</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.43&nbsp;–&nbsp;-0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.023</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.49</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06&nbsp;–&nbsp;0.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.026</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.87&nbsp;–&nbsp;-0.48</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.32&nbsp;–&nbsp;-0.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.61&nbsp;–&nbsp;-1.23</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.76</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.99&nbsp;–&nbsp;-1.54</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.61&nbsp;–&nbsp;1.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.14&nbsp;–&nbsp;0.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.230</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.06&nbsp;–&nbsp;0.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.130</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [B]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.57&nbsp;–&nbsp;0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.930</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.50&nbsp;–&nbsp;1.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.25</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.09&nbsp;–&nbsp;0.59</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.156</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.11&nbsp;–&nbsp;0.62</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.005</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [C]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.80&nbsp;–&nbsp;0.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.343</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.65</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.30&nbsp;–&nbsp;1.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.00&nbsp;–&nbsp;0.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.053</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.20&nbsp;–&nbsp;0.73</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [D]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.43</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.01&nbsp;–&nbsp;0.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.140</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Fiction] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.82</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.45&nbsp;–&nbsp;1.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Informative] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.05&nbsp;–&nbsp;0.80</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.027</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Instructional]<br>× Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.14&nbsp;–&nbsp;0.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.004</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Register [Personal] ×<br>Level [E]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.55</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.15&nbsp;–&nbsp;0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.072</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.52</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub><sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.05</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.08</td>

</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Series</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">9</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">1961</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.426 / 0.472</td>
</tr>
</tbody></table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># tab_model(md4Register) # Marginal R2 = 0.203</span></span>
<span><span class="co"># tab_model(md4Level) # Marginal R2 = 0.187</span></span>
<span></span>
<span><span class="co"># Plot of fixed effects:</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md4</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"est"</span>,</span>
<span>           show.intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           colors <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           group.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, </span>
<span>           title <span class="op">=</span> <span class="st">""</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC4 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/Dim4model-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="AppendixF_files/figure-html/Dim4model-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA4_lmer_fixedeffects.svg"), height = 8, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot of random effects:</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">md4</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span>           show.values<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>           show.p<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           value.offset <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>           value.size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>           color <span class="op">=</span> <span class="st">"bw"</span>,</span>
<span>           wrap.labels <span class="op">=</span> <span class="fl">40</span>,</span>
<span>           axis.title <span class="op">=</span> <span class="st">"PC4 estimated coefficients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/sjPlot-themes.html">theme_sjplot2</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/unnamed-chunk-33-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="AppendixF_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "TxB_PCA4_lmer_randomeffects.svg"), height = 3, width = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># svg(here("plots", "TxB_predicted_PC4_scores_interactions.svg"), height = 5, width = 8)</span></span>
<span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">md4</span>, xvar <span class="op">=</span> <span class="st">"Level"</span>, by<span class="op">=</span><span class="st">"Register"</span>, type <span class="op">=</span> <span class="st">"conditional"</span>,</span>
<span>       line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span>, </span>
<span>       xlab <span class="op">=</span> <span class="st">"Textbook Level"</span>, ylab <span class="op">=</span> <span class="st">"PC4"</span></span>
<span>       <span class="co">#,gg = TRUE</span></span>
<span>       ,layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/unnamed-chunk-34-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="AppendixF_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="testing-model-assumptions" class="level3" data-number="F.10.5"><h3 data-number="F.10.5" class="anchored" data-anchor-id="testing-model-assumptions">
<span class="header-section-number">F.10.5</span> Testing model assumptions</h3>
<p>This chunk can be used to check the assumptions of all of the models computed above. In the following example, we examine the final model selected to predict Dim2 scores.</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model2test</span> <span class="op">&lt;-</span> <span class="va">md2</span></span>
<span></span>
<span><span class="co"># check distribution of residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model2test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/lmer-diagnostics-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="AppendixF_files/figure-html/lmer-diagnostics-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># scale-location plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model2test</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p"</span>,<span class="st">"smooth"</span><span class="op">)</span>, col.line<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/lmer-diagnostics-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="AppendixF_files/figure-html/lmer-diagnostics-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Q-Q plot</span></span>
<span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/qqmath.html">qqmath</a></span><span class="op">(</span><span class="va">model2test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="AppendixF_files/figure-html/lmer-diagnostics-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="AppendixF_files/figure-html/lmer-diagnostics-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="packages-used-in-this-script" class="level2" data-number="F.11"><h2 data-number="F.11" class="anchored" data-anchor-id="packages-used-in-this-script">
<span class="header-section-number">F.11</span> Packages used in this script</h2>
<section id="package-names-and-versions" class="level3" data-number="F.11.1"><h3 data-number="F.11.1" class="anchored" data-anchor-id="package-names-and-versions">
<span class="header-section-number">F.11.1</span> Package names and versions</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.5

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Madrid
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] visreg_2.7.0      lubridate_1.9.3   stringr_1.5.1     dplyr_1.1.4      
 [5] purrr_1.0.2       readr_2.1.5       tidyr_1.3.1       tibble_3.2.1     
 [9] tidyverse_2.0.0   sjPlot_2.8.16     psych_2.4.6.26    PCAtools_2.14.0  
[13] ggrepel_0.9.5     patchwork_1.2.0   lme4_1.1-35.5     Matrix_1.7-0     
[17] knitr_1.48        here_1.0.1        ggthemes_5.1.0    forcats_1.0.0    
[21] factoextra_1.0.7  emmeans_1.10.3    DescTools_0.99.54 cowplot_1.1.3    
[25] caret_6.0-94      lattice_0.22-6    ggplot2_3.5.1    

loaded via a namespace (and not attached):
  [1] rstudioapi_0.16.0         jsonlite_1.8.8           
  [3] datawizard_0.12.1         magrittr_2.0.3           
  [5] estimability_1.5.1        nloptr_2.1.1             
  [7] rmarkdown_2.27            zlibbioc_1.50.0          
  [9] vctrs_0.6.5               minqa_1.2.7              
 [11] DelayedMatrixStats_1.26.0 htmltools_0.5.8.1        
 [13] S4Arrays_1.4.1            cellranger_1.1.0         
 [15] sjmisc_2.8.10             SparseArray_1.4.8        
 [17] pROC_1.18.5               parallelly_1.37.1        
 [19] htmlwidgets_1.6.4         plyr_1.8.9               
 [21] rootSolve_1.8.2.4         lifecycle_1.0.4          
 [23] iterators_1.0.14          pkgconfig_2.0.3          
 [25] sjlabelled_1.2.0          rsvd_1.0.5               
 [27] R6_2.5.1                  fastmap_1.2.0            
 [29] MatrixGenerics_1.16.0     future_1.33.2            
 [31] digest_0.6.36             Exact_3.2                
 [33] colorspace_2.1-0          S4Vectors_0.42.1         
 [35] rprojroot_2.0.4           dqrng_0.4.1              
 [37] irlba_2.3.5.1             beachmat_2.20.0          
 [39] fansi_1.0.6               timechange_0.3.0         
 [41] httr_1.4.7                abind_1.4-5              
 [43] compiler_4.4.1            proxy_0.4-27             
 [45] withr_3.0.0               BiocParallel_1.38.0      
 [47] performance_0.12.2        MASS_7.3-60.2            
 [49] lava_1.8.0                sjstats_0.19.0           
 [51] DelayedArray_0.30.1       gld_2.6.6                
 [53] ModelMetrics_1.2.2.2      tools_4.4.1              
 [55] future.apply_1.11.2       nnet_7.3-19              
 [57] glue_1.7.0                nlme_3.1-164             
 [59] grid_4.4.1                reshape2_1.4.4           
 [61] generics_0.1.3            recipes_1.1.0            
 [63] gtable_0.3.5              tzdb_0.4.0               
 [65] class_7.3-22              hms_1.1.3                
 [67] data.table_1.15.4         lmom_3.0                 
 [69] BiocSingular_1.20.0       ScaledMatrix_1.12.0      
 [71] utf8_1.2.4                XVector_0.44.0           
 [73] BiocGenerics_0.50.0       foreach_1.5.2            
 [75] pillar_1.9.0              splines_4.4.1            
 [77] renv_1.0.3                survival_3.6-4           
 [79] tidyselect_1.2.1          IRanges_2.38.1           
 [81] stats4_4.4.1              xfun_0.46                
 [83] expm_0.999-9              hardhat_1.4.0            
 [85] timeDate_4032.109         matrixStats_1.3.0        
 [87] stringi_1.8.4             yaml_2.3.9               
 [89] boot_1.3-30               evaluate_0.24.0          
 [91] codetools_0.2-20          BiocManager_1.30.23      
 [93] cli_3.6.3                 rpart_4.1.23             
 [95] xtable_1.8-4              munsell_0.5.1            
 [97] Rcpp_1.0.13               readxl_1.4.3             
 [99] globals_0.16.3            ggeffects_1.7.0          
[101] coda_0.19-4.1             parallel_4.4.1           
[103] gower_1.0.1               sparseMatrixStats_1.16.0 
[105] listenv_0.9.1             mvtnorm_1.2-5            
[107] ipred_0.9-15              scales_1.3.0             
[109] prodlim_2024.06.25        e1071_1.7-14             
[111] insight_0.20.2            crayon_1.5.3             
[113] rlang_1.1.4               mnormt_2.1.1             </code></pre>
</div>
</div>
</section><section id="package-references" class="level3" data-number="F.11.2"><h3 data-number="F.11.2" class="anchored" data-anchor-id="package-references">
<span class="header-section-number">F.11.2</span> Package references</h3>
<p>[1] J. B. Arnold. <em>ggthemes: Extra Themes, Scales and Geoms for ggplot2</em>. R package version 5.1.0. 2024. <a href="https://jrnold.github.io/ggthemes/" class="uri">https://jrnold.github.io/ggthemes/</a>.</p>
<p>[2] D. Bates, M. Mächler, B. Bolker, et al.&nbsp;“Fitting Linear Mixed-Effects Models Using lme4”. In: <em>Journal of Statistical Software</em> 67.1 (2015), pp.&nbsp;1-48. DOI: 10.18637/jss.v067.i01.</p>
<p>[3] D. Bates, M. Maechler, B. Bolker, et al.&nbsp;<em>lme4: Linear Mixed-Effects Models using Eigen and S4</em>. R package version 1.1-35.5. 2024. <a href="https://github.com/lme4/lme4/" class="uri">https://github.com/lme4/lme4/</a>.</p>
<p>[4] D. Bates, M. Maechler, and M. Jagan. <em>Matrix: Sparse and Dense Matrix Classes and Methods</em>. R package version 1.7-0. 2024. <a href="https://Matrix.R-forge.R-project.org" class="uri">https://Matrix.R-forge.R-project.org</a>.</p>
<p>[5] K. Blighe and A. Lun. <em>PCAtools: Everything Principal Components Analysis</em>. R package version 2.14.0. 2023. DOI: 10.18129/B9.bioc.PCAtools. <a href="https://bioconductor.org/packages/PCAtools" class="uri">https://bioconductor.org/packages/PCAtools</a>.</p>
<p>[6] P. Breheny and W. Burchett. <em>visreg: Visualization of Regression Models</em>. R package version 2.7.0. 2020. <a href="http://pbreheny.github.io/visreg" class="uri">http://pbreheny.github.io/visreg</a>.</p>
<p>[7] P. Breheny and W. Burchett. “Visualization of Regression Models Using visreg”. In: <em>The R Journal</em> 9.2 (2017), pp.&nbsp;56-71.</p>
<p>[8] G. Grolemund and H. Wickham. “Dates and Times Made Easy with lubridate”. In: <em>Journal of Statistical Software</em> 40.3 (2011), pp. 1-25. <a href="https://www.jstatsoft.org/v40/i03/" class="uri">https://www.jstatsoft.org/v40/i03/</a>.</p>
<p>[9] A. Kassambara and F. Mundt. <em>factoextra: Extract and Visualize the Results of Multivariate Data Analyses</em>. R package version 1.0.7. 2020. <a href="http://www.sthda.com/english/rpkgs/factoextra" class="uri">http://www.sthda.com/english/rpkgs/factoextra</a>.</p>
<p>[10] M. Kuhn. <em>caret: Classification and Regression Training</em>. R package version 6.0-94. 2023. <a href="https://github.com/topepo/caret/" class="uri">https://github.com/topepo/caret/</a>.</p>
<p>[11] Kuhn and Max. “Building Predictive Models in R Using the caret Package”. In: <em>Journal of Statistical Software</em> 28.5 (2008), p.&nbsp;1–26. DOI: 10.18637/jss.v028.i05. <a href="https://www.jstatsoft.org/index.php/jss/article/view/v028i05" class="uri">https://www.jstatsoft.org/index.php/jss/article/view/v028i05</a>.</p>
<p>[12] R. V. Lenth. <em>emmeans: Estimated Marginal Means, aka Least-Squares Means</em>. R package version 1.10.3. 2024. <a href="https://rvlenth.github.io/emmeans/" class="uri">https://rvlenth.github.io/emmeans/</a>.</p>
<p>[13] D. Lüdecke. <em>sjPlot: Data Visualization for Statistics in Social Science</em>. R package version 2.8.16. 2024. <a href="https://strengejacke.github.io/sjPlot/" class="uri">https://strengejacke.github.io/sjPlot/</a>.</p>
<p>[14] K. Müller. <em>here: A Simpler Way to Find Your Files</em>. R package version 1.0.1. 2020. <a href="https://here.r-lib.org/" class="uri">https://here.r-lib.org/</a>.</p>
<p>[15] K. Müller and H. Wickham. <em>tibble: Simple Data Frames</em>. R package version 3.2.1. 2023. <a href="https://tibble.tidyverse.org/" class="uri">https://tibble.tidyverse.org/</a>.</p>
<p>[16] T. L. Pedersen. <em>patchwork: The Composer of Plots</em>. R package version 1.2.0. 2024. <a href="https://patchwork.data-imaginist.com" class="uri">https://patchwork.data-imaginist.com</a>.</p>
<p>[17] R Core Team. <em>R: A Language and Environment for Statistical Computing</em>. R Foundation for Statistical Computing. Vienna, Austria, 2024. <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
<p>[18] W. Revelle. <em>psych: Procedures for Psychological, Psychometric, and Personality Research</em>. R package version 2.4.6.26. 2024. <a href="https://personality-project.org/r/psych/" class="uri">https://personality-project.org/r/psych/</a>.</p>
<p>[19] D. Sarkar. <em>Lattice: Multivariate Data Visualization with R</em>. New York: Springer, 2008. ISBN: 978-0-387-75968-5. <a href="http://lmdvr.r-forge.r-project.org" class="uri">http://lmdvr.r-forge.r-project.org</a>.</p>
<p>[20] D. Sarkar. <em>lattice: Trellis Graphics for R</em>. R package version 0.22-6. 2024. <a href="https://lattice.r-forge.r-project.org/" class="uri">https://lattice.r-forge.r-project.org/</a>.</p>
<p>[21] A. Signorell. <em>DescTools: Tools for Descriptive Statistics</em>. R package version 0.99.54. 2024. <a href="https://andrisignorell.github.io/DescTools/" class="uri">https://andrisignorell.github.io/DescTools/</a>.</p>
<p>[22] K. Slowikowski. <em>ggrepel: Automatically Position Non-Overlapping Text Labels with ggplot2</em>. R package version 0.9.5. 2024. <a href="https://ggrepel.slowkow.com/" class="uri">https://ggrepel.slowkow.com/</a>.</p>
<p>[23] V. Spinu, G. Grolemund, and H. Wickham. <em>lubridate: Make Dealing with Dates a Little Easier</em>. R package version 1.9.3. 2023. <a href="https://lubridate.tidyverse.org" class="uri">https://lubridate.tidyverse.org</a>.</p>
<p>[24] H. Wickham. <em>forcats: Tools for Working with Categorical Variables (Factors)</em>. R package version 1.0.0. 2023. <a href="https://forcats.tidyverse.org/" class="uri">https://forcats.tidyverse.org/</a>.</p>
<p>[25] H. Wickham. <em>ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York, 2016. ISBN: 978-3-319-24277-4. <a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a>.</p>
<p>[26] H. Wickham. <em>stringr: Simple, Consistent Wrappers for Common String Operations</em>. R package version 1.5.1. 2023. <a href="https://stringr.tidyverse.org" class="uri">https://stringr.tidyverse.org</a>.</p>
<p>[27] H. Wickham. <em>tidyverse: Easily Install and Load the Tidyverse</em>. R package version 2.0.0. 2023. <a href="https://tidyverse.tidyverse.org" class="uri">https://tidyverse.tidyverse.org</a>.</p>
<p>[28] H. Wickham, M. Averick, J. Bryan, et al.&nbsp;“Welcome to the tidyverse”. In: <em>Journal of Open Source Software</em> 4.43 (2019), p.&nbsp;1686. DOI: 10.21105/joss.01686.</p>
<p>[29] H. Wickham, W. Chang, L. Henry, et al.&nbsp;<em>ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. R package version 3.5.1. 2024. <a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a>.</p>
<p>[30] H. Wickham, R. François, L. Henry, et al.&nbsp;<em>dplyr: A Grammar of Data Manipulation</em>. R package version 1.1.4. 2023. <a href="https://dplyr.tidyverse.org" class="uri">https://dplyr.tidyverse.org</a>.</p>
<p>[31] H. Wickham and L. Henry. <em>purrr: Functional Programming Tools</em>. R package version 1.0.2. 2023. <a href="https://purrr.tidyverse.org/" class="uri">https://purrr.tidyverse.org/</a>.</p>
<p>[32] H. Wickham, J. Hester, and J. Bryan. <em>readr: Read Rectangular Text Data</em>. R package version 2.1.5. 2024. <a href="https://readr.tidyverse.org" class="uri">https://readr.tidyverse.org</a>.</p>
<p>[33] H. Wickham, D. Vaughan, and M. Girlich. <em>tidyr: Tidy Messy Data</em>. R package version 1.3.1. 2024. <a href="https://tidyr.tidyverse.org" class="uri">https://tidyr.tidyverse.org</a>.</p>
<p>[34] C. O. Wilke. <em>cowplot: Streamlined Plot Theme and Plot Annotations for ggplot2</em>. R package version 1.1.3. 2024. <a href="https://wilkelab.org/cowplot/" class="uri">https://wilkelab.org/cowplot/</a>.</p>
<p>[35] Y. Xie. <em>Dynamic Documents with R and knitr</em>. 2nd. ISBN 978-1498716963. Boca Raton, Florida: Chapman and Hall/CRC, 2015. <a href="https://yihui.org/knitr/" class="uri">https://yihui.org/knitr/</a>.</p>
<p>[36] Y. Xie. “knitr: A Comprehensive Tool for Reproducible Research in R”. In: <em>Implementing Reproducible Computational Research</em>. Ed. by V. Stodden, F. Leisch and R. D. Peng. ISBN 978-1466561595. Chapman and Hall/CRC, 2014.</p>
<p>[37] Y. Xie. <em>knitr: A General-Purpose Package for Dynamic Report Generation in R</em>. R package version 1.48. 2024. <a href="https://yihui.org/knitr/" class="uri">https://yihui.org/knitr/</a>.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-lefoll" class="csl-entry" role="listitem">
Le Foll, Elen. <span><em>Schulenglisch</em></span>: A multi-dimensional model of the variety of <span>English</span> taught in german secondary schools. <em>AAA: Arbeiten aus Anglistik und Amerikanistik</em> 49.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/elenlefoll\.github\.io\/TextbookMDA\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./AppendixE.html" class="pagination-link" aria-label="Data Preparation for the Model of Intra-Textbook Variation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Intra-Textbook Variation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./AppendixG.html" class="pagination-link" aria-label="Data Preparation for the Model of Textbook English vs. ‘real-world’ English">
        <span class="nav-page-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb89" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Analysis for the Model of Intra-Textbook Variation</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>This script documents the analysis of the pre-processed data from the Textbook English Corpus (TEC) to arrive at the multi-dimensional model of intra-textbook linguistic variation (Chapter 6). It generates all of the statistics and plots included in the book, as well as many others that were used in the analysis, but not included in the book for reasons of space.</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages required</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>The following packages must be installed and loaded to carry out the following analyses.</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: set-up</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original study</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># For its confusion matrix function</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools) <span class="co"># For 95% CI</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co"># For circular graphs of variables</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats) <span class="co"># For data manipulation</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes) <span class="co"># For theme of factoextra plots</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># For dynamic file paths</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># For linear regression modelling</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># To create figures with more than one plot</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PCAtools) <span class="co"># For nice biplots of PCA results</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co"># For various useful stats function</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># For model plots and tables</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># For data wrangling</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg) <span class="co"># For plots of interaction effects</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a><span class="co"># From https://github.com/RainCloudPlots/RainCloudPlots:</span></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R_rainclouds.R"</span>)) <span class="co"># For geom_flat_violin rainplots</span></span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r colours, include=FALSE}</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a><span class="in"># This is a beautiful feminist colour palette based on banners from the suffragette mouvement: https://github.com/alburezg/suffrager</span></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a><span class="in"># devtools::install_github("alburezg/suffrager")</span></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a><span class="in"># library(suffrager)</span></span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a><span class="in"># colours &lt;- suf_palette(name = "london", n = 6, type = "continuous") </span></span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a><span class="in"># colours2 &lt;- suf_palette(name = "classic", n = 5, type = "continuous") </span></span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a><span class="in"># colours &lt;- c(colours, colours2[c(2:4)]) # Nine colours range</span></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a><span class="in"># palette &lt;- colours[c(1,5,6,2,3,8,7,4,9)] # Good order for PCA</span></span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a><span class="in"># scales::show_col(palette)</span></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a><span class="in"># This is the palette created above on the basis of the suffrager package (but without needed to install the package)</span></span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a><span class="in">palette &lt;- c("#BD241E", "#A18A33", "#15274D", "#D54E1E", "#EA7E1E", "#4C4C4C", "#722672", "#F9B921", "#267226")</span></span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preparing the data for PCA</span></span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a><span class="fu">### TEC data import</span></span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: import</span></span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a>TxBcounts <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"TxBcounts3.rds"</span>))</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(TxBcounts)</span></span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(TxBcounts)</span></span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a>TxBzlogcounts <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"TxBzlogcounts.rds"</span>)) </span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(TxBzlogcounts)</span></span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(TxBzlogcounts)</span></span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true" tabindex="-1"></a>TxBdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(TxBcounts[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="fu">as.data.frame</span>(TxBzlogcounts))</span>
<span id="cb89-73"><a href="#cb89-73" aria-hidden="true" tabindex="-1"></a><span class="co"># str(TxBdata)</span></span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true" tabindex="-1"></a>First, the TEC data as processed in Appendix D is imported. It comprises <span class="in">`{r} nrow(TxBdata)  |&gt; format(big.mark=",")`</span> texts/files, each with logged standardised normalised frequencies for <span class="in">`{r} ncol(TxBdata)-6`</span> linguistic features.</span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking the factorability of data</span></span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r factorability.TEC}</span></span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true" tabindex="-1"></a><span class="in">kmo &lt;- KMO(TxBdata[,7:ncol(TxBdata)]) </span></span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-86"><a href="#cb89-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-87"><a href="#cb89-87" aria-hidden="true" tabindex="-1"></a>The overall MSA value of the dataset is <span class="in">`{r} kmo$MSA |&gt; round(2)`</span>. The features have the following individual MSA values (ordered from lowest to largest):</span>
<span id="cb89-88"><a href="#cb89-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-91"><a href="#cb89-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-92"><a href="#cb89-92" aria-hidden="true" tabindex="-1"></a>kmo<span class="sc">$</span>MSAi[<span class="fu">order</span>(kmo<span class="sc">$</span>MSAi)] <span class="sc">|&gt;</span>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb89-93"><a href="#cb89-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-94"><a href="#cb89-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-95"><a href="#cb89-95" aria-hidden="true" tabindex="-1"></a><span class="fu">### Removal of feature with MSAs of \&lt; 0.5</span></span>
<span id="cb89-96"><a href="#cb89-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-97"><a href="#cb89-97" aria-hidden="true" tabindex="-1"></a>We first remove the first feature with an individual MSA <span class="sc">\&lt;</span> 0.5, then check the MSA values again and continue removing features one by one if necessary.</span>
<span id="cb89-98"><a href="#cb89-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-101"><a href="#cb89-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-102"><a href="#cb89-102" aria-hidden="true" tabindex="-1"></a>TxBdata <span class="ot">&lt;-</span> TxBdata <span class="sc">|&gt;</span> </span>
<span id="cb89-103"><a href="#cb89-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(MDWO))</span>
<span id="cb89-104"><a href="#cb89-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-105"><a href="#cb89-105" aria-hidden="true" tabindex="-1"></a>kmo2 <span class="ot">&lt;-</span> <span class="fu">KMO</span>(TxBdata[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(TxBdata)]) </span>
<span id="cb89-106"><a href="#cb89-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-107"><a href="#cb89-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-108"><a href="#cb89-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-109"><a href="#cb89-109" aria-hidden="true" tabindex="-1"></a>The overall MSA value of the dataset is now <span class="in">`{r} kmo2$MSA |&gt; round(2)`</span>. None of the remaining features have individual MSA values below 0.5:</span>
<span id="cb89-110"><a href="#cb89-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-113"><a href="#cb89-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-114"><a href="#cb89-114" aria-hidden="true" tabindex="-1"></a>kmo2<span class="sc">$</span>MSAi[<span class="fu">order</span>(kmo2<span class="sc">$</span>MSAi)] <span class="sc">|&gt;</span>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb89-115"><a href="#cb89-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-116"><a href="#cb89-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-117"><a href="#cb89-117" aria-hidden="true" tabindex="-1"></a><span class="fu">### Choosing the number of principal components to retain</span></span>
<span id="cb89-118"><a href="#cb89-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-119"><a href="#cb89-119" aria-hidden="true" tabindex="-1"></a>On the basis of this scree plot, six principal components were initially retained.</span>
<span id="cb89-120"><a href="#cb89-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-123"><a href="#cb89-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-124"><a href="#cb89-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: screeplot</span></span>
<span id="cb89-125"><a href="#cb89-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-126"><a href="#cb89-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-127"><a href="#cb89-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot screen plot</span></span>
<span id="cb89-128"><a href="#cb89-128" aria-hidden="true" tabindex="-1"></a><span class="co">#png(here("plots", "screeplot-TEC-only.png"), width = 20, height= 12, units = "cm", res = 300)</span></span>
<span id="cb89-129"><a href="#cb89-129" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(TxBdata[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(TxBdata)], <span class="at">factors =</span> <span class="cn">FALSE</span>, <span class="at">pc =</span> <span class="cn">TRUE</span>) <span class="co"># Retain six components</span></span>
<span id="cb89-130"><a href="#cb89-130" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb89-131"><a href="#cb89-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-132"><a href="#cb89-132" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb89-133"><a href="#cb89-133" aria-hidden="true" tabindex="-1"></a>pca1 <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">principal</span>(TxBdata[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(TxBdata)], </span>
<span id="cb89-134"><a href="#cb89-134" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nfactors =</span> <span class="dv">6</span>,</span>
<span id="cb89-135"><a href="#cb89-135" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb89-136"><a href="#cb89-136" aria-hidden="true" tabindex="-1"></a><span class="co">#pca1$loadings</span></span>
<span id="cb89-137"><a href="#cb89-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-138"><a href="#cb89-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-139"><a href="#cb89-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-140"><a href="#cb89-140" aria-hidden="true" tabindex="-1"></a><span class="fu">### Excluding features with low final communalites</span></span>
<span id="cb89-141"><a href="#cb89-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-142"><a href="#cb89-142" aria-hidden="true" tabindex="-1"></a>We first check whether some feature have extremely low communalities (see <span class="co">[</span><span class="ot">https://rdrr.io/cran/FactorAssumptions/man/communalities_optimal_solution.html</span><span class="co">](https://rdrr.io/cran/FactorAssumptions/man/communalities_optimal_solution.htmlhttps://rdrr.io/cran/FactorAssumptions/man/communalities_optimal_solution.html)</span>).</span>
<span id="cb89-143"><a href="#cb89-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-146"><a href="#cb89-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-147"><a href="#cb89-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb89-148"><a href="#cb89-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-149"><a href="#cb89-149" aria-hidden="true" tabindex="-1"></a>pca1<span class="sc">$</span>communality <span class="sc">|&gt;</span> <span class="fu">sort</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb89-150"><a href="#cb89-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-151"><a href="#cb89-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-152"><a href="#cb89-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-153"><a href="#cb89-153" aria-hidden="true" tabindex="-1"></a>As we chose to exclude features with communalities of <span class="sc">\&lt;</span> 0.2, we remove STPR, HDG, MDNE and CAUSE from the dataset to be analysed.</span>
<span id="cb89-154"><a href="#cb89-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-157"><a href="#cb89-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-158"><a href="#cb89-158" aria-hidden="true" tabindex="-1"></a>TxBdataforPCA <span class="ot">&lt;-</span> TxBdata <span class="sc">|&gt;</span> </span>
<span id="cb89-159"><a href="#cb89-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(STPR, MDNE, HDG, CAUSE))</span>
<span id="cb89-160"><a href="#cb89-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-161"><a href="#cb89-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-164"><a href="#cb89-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-165"><a href="#cb89-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb89-166"><a href="#cb89-166" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(TxBdataforPCA, here("data", "processed", "TxBdataforPCA.rds")) # Last saved on 6 March 2024</span></span>
<span id="cb89-167"><a href="#cb89-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-168"><a href="#cb89-168" aria-hidden="true" tabindex="-1"></a>kmo3 <span class="ot">&lt;-</span> <span class="fu">KMO</span>(TxBdataforPCA[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(TxBdataforPCA)]) </span>
<span id="cb89-169"><a href="#cb89-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-170"><a href="#cb89-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-171"><a href="#cb89-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-172"><a href="#cb89-172" aria-hidden="true" tabindex="-1"></a>The overall MSA value of the dataset is now <span class="in">`{r} kmo3$MSA |&gt; round(2)`</span>. None of the remaining features have individual MSA values below 0.5:</span>
<span id="cb89-173"><a href="#cb89-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-176"><a href="#cb89-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-177"><a href="#cb89-177" aria-hidden="true" tabindex="-1"></a>kmo3<span class="sc">$</span>MSAi[<span class="fu">order</span>(kmo3<span class="sc">$</span>MSAi)] <span class="sc">|&gt;</span><span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb89-178"><a href="#cb89-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-179"><a href="#cb89-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-180"><a href="#cb89-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-181"><a href="#cb89-181" aria-hidden="true" tabindex="-1"></a>The final number of linguistic features entered in the intra-textbook model of linguistic variation is <span class="in">`{r} ncol(TxBdataforPCA)-6`</span>.</span>
<span id="cb89-182"><a href="#cb89-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-183"><a href="#cb89-183" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing the effect of rotating the components</span></span>
<span id="cb89-184"><a href="#cb89-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-185"><a href="#cb89-185" aria-hidden="true" tabindex="-1"></a>This chunk was used when considering whether or not to rotate the components (see methods section). Ultimately, the components were not rotated.</span>
<span id="cb89-186"><a href="#cb89-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-189"><a href="#cb89-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-190"><a href="#cb89-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCA-rotation-tests</span></span>
<span id="cb89-191"><a href="#cb89-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb89-192"><a href="#cb89-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-193"><a href="#cb89-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparing a rotated vs. a non-rotated solution</span></span>
<span id="cb89-194"><a href="#cb89-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-195"><a href="#cb89-195" aria-hidden="true" tabindex="-1"></a><span class="co">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span id="cb89-196"><a href="#cb89-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-197"><a href="#cb89-197" aria-hidden="true" tabindex="-1"></a><span class="co"># No rotation</span></span>
<span id="cb89-198"><a href="#cb89-198" aria-hidden="true" tabindex="-1"></a>pca2 <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">principal</span>(TxBdata[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(TxBdata)], </span>
<span id="cb89-199"><a href="#cb89-199" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nfactors =</span> <span class="dv">6</span>, </span>
<span id="cb89-200"><a href="#cb89-200" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb89-201"><a href="#cb89-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-202"><a href="#cb89-202" aria-hidden="true" tabindex="-1"></a>pca2<span class="sc">$</span>loadings</span>
<span id="cb89-203"><a href="#cb89-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-204"><a href="#cb89-204" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot.psych</span>(pca2, </span>
<span id="cb89-205"><a href="#cb89-205" aria-hidden="true" tabindex="-1"></a>             <span class="at">vars =</span> <span class="cn">TRUE</span>, </span>
<span id="cb89-206"><a href="#cb89-206" aria-hidden="true" tabindex="-1"></a>             <span class="at">choose=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb89-207"><a href="#cb89-207" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb89-208"><a href="#cb89-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-209"><a href="#cb89-209" aria-hidden="true" tabindex="-1"></a><span class="co"># Promax rotation</span></span>
<span id="cb89-210"><a href="#cb89-210" aria-hidden="true" tabindex="-1"></a>pca2.rotated <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">principal</span>(TxBdata[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(TxBdata)], </span>
<span id="cb89-211"><a href="#cb89-211" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nfactors =</span> <span class="dv">6</span>, </span>
<span id="cb89-212"><a href="#cb89-212" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rotate =</span> <span class="st">"promax"</span>)</span>
<span id="cb89-213"><a href="#cb89-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-214"><a href="#cb89-214" aria-hidden="true" tabindex="-1"></a><span class="co"># This summary shows the component correlations which is particularly interesting</span></span>
<span id="cb89-215"><a href="#cb89-215" aria-hidden="true" tabindex="-1"></a>pca2.rotated</span>
<span id="cb89-216"><a href="#cb89-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-217"><a href="#cb89-217" aria-hidden="true" tabindex="-1"></a>pca2.rotated<span class="sc">$</span>loadings</span>
<span id="cb89-218"><a href="#cb89-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-219"><a href="#cb89-219" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot.psych</span>(pca2.rotated, <span class="at">vars =</span> <span class="cn">TRUE</span>, <span class="at">choose=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb89-220"><a href="#cb89-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-221"><a href="#cb89-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-222"><a href="#cb89-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-223"><a href="#cb89-223" aria-hidden="true" tabindex="-1"></a><span class="fu">## Principal Component Analysis (PCA)</span></span>
<span id="cb89-224"><a href="#cb89-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-225"><a href="#cb89-225" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using the full dataset</span></span>
<span id="cb89-226"><a href="#cb89-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-227"><a href="#cb89-227" aria-hidden="true" tabindex="-1"></a>Except outliers removed as part of the data preparation (see Appendix D).</span>
<span id="cb89-228"><a href="#cb89-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-229"><a href="#cb89-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCA-prcomp-full-data}</span></span>
<span id="cb89-230"><a href="#cb89-230" aria-hidden="true" tabindex="-1"></a><span class="in"># Perform PCA on full data</span></span>
<span id="cb89-231"><a href="#cb89-231" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span id="cb89-232"><a href="#cb89-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-233"><a href="#cb89-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-234"><a href="#cb89-234" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using random subsets of the data</span></span>
<span id="cb89-235"><a href="#cb89-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-236"><a href="#cb89-236" aria-hidden="true" tabindex="-1"></a>Alternatively, it is possible to conduct the PCA on random subsets of the data to test the stability of the solution. Re-running this line will generate a new subset of the TEC texts containing 2/3 of the texts randomly sampled.</span>
<span id="cb89-237"><a href="#cb89-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-238"><a href="#cb89-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCA-prcomp-random-subset, eval=FALSE}</span></span>
<span id="cb89-239"><a href="#cb89-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-240"><a href="#cb89-240" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds")) |&gt;</span></span>
<span id="cb89-241"><a href="#cb89-241" aria-hidden="true" tabindex="-1"></a><span class="in">  slice_sample(n = round(1961*0.6), replace = FALSE)</span></span>
<span id="cb89-242"><a href="#cb89-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-243"><a href="#cb89-243" aria-hidden="true" tabindex="-1"></a><span class="in">nrow(TxBdata)</span></span>
<span id="cb89-244"><a href="#cb89-244" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata$Filename[1:10]</span></span>
<span id="cb89-245"><a href="#cb89-245" aria-hidden="true" tabindex="-1"></a><span class="in">nrow(TxBdata) / (ncol(TxBdata)-6) # Check that there is enough data to conduct a PCA. This ratio should be at least 5 (see Friginal &amp; Hardy 2014: 303–304).</span></span>
<span id="cb89-246"><a href="#cb89-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-247"><a href="#cb89-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-248"><a href="#cb89-248" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using specific subsets of the data</span></span>
<span id="cb89-249"><a href="#cb89-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-250"><a href="#cb89-250" aria-hidden="true" tabindex="-1"></a>The following chunk can be used to perform the PCA on a country subset of the data to test the stability of the solution. See <span class="co">[</span><span class="ot">@lefoll</span><span class="co">]</span> for a detailed analysis of the subcorpus of textbooks used in Germany.</span>
<span id="cb89-251"><a href="#cb89-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-252"><a href="#cb89-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCA-prcomp-country-subset, eval=FALSE}</span></span>
<span id="cb89-253"><a href="#cb89-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-254"><a href="#cb89-254" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds")) |&gt;</span></span>
<span id="cb89-255"><a href="#cb89-255" aria-hidden="true" tabindex="-1"></a><span class="in">  #filter(Country == "France")</span></span>
<span id="cb89-256"><a href="#cb89-256" aria-hidden="true" tabindex="-1"></a><span class="in">  #filter(Country == "Germany")</span></span>
<span id="cb89-257"><a href="#cb89-257" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Country == "Spain")</span></span>
<span id="cb89-258"><a href="#cb89-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-259"><a href="#cb89-259" aria-hidden="true" tabindex="-1"></a><span class="in">nrow(TxBdata)</span></span>
<span id="cb89-260"><a href="#cb89-260" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata$Filename[1:10] # Check data</span></span>
<span id="cb89-261"><a href="#cb89-261" aria-hidden="true" tabindex="-1"></a><span class="in">nrow(TxBdata) / (ncol(TxBdata)-6) # Check that there is enough data to conduct a PCA. This should be &gt; 5 (see Friginal &amp; Hardy 2014: 303–304).</span></span>
<span id="cb89-262"><a href="#cb89-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-263"><a href="#cb89-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-264"><a href="#cb89-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-265"><a href="#cb89-265" aria-hidden="true" tabindex="-1"></a><span class="fu">### Performing the PCA</span></span>
<span id="cb89-266"><a href="#cb89-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-267"><a href="#cb89-267" aria-hidden="true" tabindex="-1"></a>We perform the PCA using the <span class="in">`prcomp`</span> function and print a summary of the results.</span>
<span id="cb89-268"><a href="#cb89-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-269"><a href="#cb89-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCA-prcomp}</span></span>
<span id="cb89-270"><a href="#cb89-270" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb89-271"><a href="#cb89-271" aria-hidden="true" tabindex="-1"></a><span class="in">pca &lt;- prcomp(TxBdata[,7:ncol(TxBdata)], scale.=FALSE, rank. = 6) # All quantitative variables for all TxB files except outliers</span></span>
<span id="cb89-272"><a href="#cb89-272" aria-hidden="true" tabindex="-1"></a><span class="in">register  &lt;- factor(TxBdata[,"Register"]) # Register</span></span>
<span id="cb89-273"><a href="#cb89-273" aria-hidden="true" tabindex="-1"></a><span class="in">level &lt;- factor(TxBdata[,"Level"]) # Textbook proficiency level</span></span>
<span id="cb89-274"><a href="#cb89-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-275"><a href="#cb89-275" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(register)</span></span>
<span id="cb89-276"><a href="#cb89-276" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(level)</span></span>
<span id="cb89-277"><a href="#cb89-277" aria-hidden="true" tabindex="-1"></a><span class="in">summary(pca)</span></span>
<span id="cb89-278"><a href="#cb89-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-279"><a href="#cb89-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-280"><a href="#cb89-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-281"><a href="#cb89-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plotting PCA results</span></span>
<span id="cb89-282"><a href="#cb89-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-283"><a href="#cb89-283" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3D plots</span></span>
<span id="cb89-284"><a href="#cb89-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-285"><a href="#cb89-285" aria-hidden="true" tabindex="-1"></a>The following chunk can be used to create projections of TEC texts on three dimensions of the model. These plots cannot be rendered in two dimensions and are therefore not generated in the present document. For more information on the <span class="in">`pca3d`</span> library, see: <span class="ot">&lt;https://cran.r-project.org/web/packages/pca3d/vignettes/pca3d.pdf&gt;</span>.</span>
<span id="cb89-286"><a href="#cb89-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-287"><a href="#cb89-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 3D-plots-TxB, eval=FALSE}</span></span>
<span id="cb89-288"><a href="#cb89-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-289"><a href="#cb89-289" aria-hidden="true" tabindex="-1"></a><span class="in">library(pca3d) # For 3-D plots</span></span>
<span id="cb89-290"><a href="#cb89-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-291"><a href="#cb89-291" aria-hidden="true" tabindex="-1"></a><span class="in">col &lt;- palette[c(1:3,8,7)] # without poetry</span></span>
<span id="cb89-292"><a href="#cb89-292" aria-hidden="true" tabindex="-1"></a><span class="in">names(col) &lt;- c("Conversation", "Fiction", "Informative", "Instructional", "Personal")</span></span>
<span id="cb89-293"><a href="#cb89-293" aria-hidden="true" tabindex="-1"></a><span class="in">scales::show_col(col) # Check colours</span></span>
<span id="cb89-294"><a href="#cb89-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-295"><a href="#cb89-295" aria-hidden="true" tabindex="-1"></a><span class="in">pca3d(pca, </span></span>
<span id="cb89-296"><a href="#cb89-296" aria-hidden="true" tabindex="-1"></a><span class="in">      group = register,</span></span>
<span id="cb89-297"><a href="#cb89-297" aria-hidden="true" tabindex="-1"></a><span class="in">      components = 1:3,</span></span>
<span id="cb89-298"><a href="#cb89-298" aria-hidden="true" tabindex="-1"></a><span class="in">      #components = 4:6,</span></span>
<span id="cb89-299"><a href="#cb89-299" aria-hidden="true" tabindex="-1"></a><span class="in">      show.ellipses=FALSE, </span></span>
<span id="cb89-300"><a href="#cb89-300" aria-hidden="true" tabindex="-1"></a><span class="in">      ellipse.ci=0.75,</span></span>
<span id="cb89-301"><a href="#cb89-301" aria-hidden="true" tabindex="-1"></a><span class="in">      show.plane=FALSE,</span></span>
<span id="cb89-302"><a href="#cb89-302" aria-hidden="true" tabindex="-1"></a><span class="in">      col = col,</span></span>
<span id="cb89-303"><a href="#cb89-303" aria-hidden="true" tabindex="-1"></a><span class="in">      shape = "sphere",</span></span>
<span id="cb89-304"><a href="#cb89-304" aria-hidden="true" tabindex="-1"></a><span class="in">      radius = 1,</span></span>
<span id="cb89-305"><a href="#cb89-305" aria-hidden="true" tabindex="-1"></a><span class="in">      legend = "right")</span></span>
<span id="cb89-306"><a href="#cb89-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-307"><a href="#cb89-307" aria-hidden="true" tabindex="-1"></a><span class="in">snapshotPCA3d(here("plots", "PCA_TxB_3Dsnapshot.png"))</span></span>
<span id="cb89-308"><a href="#cb89-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-309"><a href="#cb89-309" aria-hidden="true" tabindex="-1"></a><span class="in">names(col) &lt;- c("C", "B", "E", "A", "D") # To colour the dots according to the profiency level of the textbooks</span></span>
<span id="cb89-310"><a href="#cb89-310" aria-hidden="true" tabindex="-1"></a><span class="in">pca3d(pca, </span></span>
<span id="cb89-311"><a href="#cb89-311" aria-hidden="true" tabindex="-1"></a><span class="in">      components = 4:6,</span></span>
<span id="cb89-312"><a href="#cb89-312" aria-hidden="true" tabindex="-1"></a><span class="in">      group = level,</span></span>
<span id="cb89-313"><a href="#cb89-313" aria-hidden="true" tabindex="-1"></a><span class="in">      show.ellipses=FALSE, </span></span>
<span id="cb89-314"><a href="#cb89-314" aria-hidden="true" tabindex="-1"></a><span class="in">      ellipse.ci=0.75,</span></span>
<span id="cb89-315"><a href="#cb89-315" aria-hidden="true" tabindex="-1"></a><span class="in">      show.plane=FALSE,</span></span>
<span id="cb89-316"><a href="#cb89-316" aria-hidden="true" tabindex="-1"></a><span class="in">      col = col,</span></span>
<span id="cb89-317"><a href="#cb89-317" aria-hidden="true" tabindex="-1"></a><span class="in">      shape = "sphere",</span></span>
<span id="cb89-318"><a href="#cb89-318" aria-hidden="true" tabindex="-1"></a><span class="in">      radius = 0.8,</span></span>
<span id="cb89-319"><a href="#cb89-319" aria-hidden="true" tabindex="-1"></a><span class="in">      legend = "right")</span></span>
<span id="cb89-320"><a href="#cb89-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-321"><a href="#cb89-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-322"><a href="#cb89-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-323"><a href="#cb89-323" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two-dimensional plots (biplots)</span></span>
<span id="cb89-324"><a href="#cb89-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-325"><a href="#cb89-325" aria-hidden="true" tabindex="-1"></a>These plots were generated using the <span class="in">`PCAtools`</span> package, which requires the data to be formatted in a rather unconventional way so it needs to wrangled first.</span>
<span id="cb89-326"><a href="#cb89-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-327"><a href="#cb89-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data wrangling for PCAtools</span></span>
<span id="cb89-328"><a href="#cb89-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-329"><a href="#cb89-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCAtools-biplots}</span></span>
<span id="cb89-330"><a href="#cb89-330" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb89-331"><a href="#cb89-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-332"><a href="#cb89-332" aria-hidden="true" tabindex="-1"></a><span class="in">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span id="cb89-333"><a href="#cb89-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-334"><a href="#cb89-334" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata2meta &lt;- TxBdata[,1:6]</span></span>
<span id="cb89-335"><a href="#cb89-335" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(TxBdata2meta) &lt;- TxBdata2meta$Filename</span></span>
<span id="cb89-336"><a href="#cb89-336" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata2meta &lt;- TxBdata2meta |&gt; select(-Filename)</span></span>
<span id="cb89-337"><a href="#cb89-337" aria-hidden="true" tabindex="-1"></a><span class="in">#head(TxBdata2meta)</span></span>
<span id="cb89-338"><a href="#cb89-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-339"><a href="#cb89-339" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata2 = TxBdata</span></span>
<span id="cb89-340"><a href="#cb89-340" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(TxBdata2) &lt;- TxBdata2$Filename</span></span>
<span id="cb89-341"><a href="#cb89-341" aria-hidden="true" tabindex="-1"></a><span class="in">TxBdata2num &lt;- as.data.frame(base::t(TxBdata2[,7:ncol(TxBdata2)]))</span></span>
<span id="cb89-342"><a href="#cb89-342" aria-hidden="true" tabindex="-1"></a><span class="in">#TxBdata2num[1:12,1:3] # Check sanity of data</span></span>
<span id="cb89-343"><a href="#cb89-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-344"><a href="#cb89-344" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- PCAtools::pca(TxBdata2num, </span></span>
<span id="cb89-345"><a href="#cb89-345" aria-hidden="true" tabindex="-1"></a><span class="in">         metadata = TxBdata2meta,</span></span>
<span id="cb89-346"><a href="#cb89-346" aria-hidden="true" tabindex="-1"></a><span class="in">         scale = FALSE)</span></span>
<span id="cb89-347"><a href="#cb89-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-348"><a href="#cb89-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-349"><a href="#cb89-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-350"><a href="#cb89-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pairs plot</span></span>
<span id="cb89-351"><a href="#cb89-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-352"><a href="#cb89-352" aria-hidden="true" tabindex="-1"></a>We first produce a scatterplot matrix of all the combinations of the first six dimensions of the model of intra-textbook variation. Note that the number before the comma on each axis label shows which principal component is plotted on that axis; this is followed by the percentage of the total variance explained by that particular component. The colours correspond to the text registers.</span>
<span id="cb89-353"><a href="#cb89-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-356"><a href="#cb89-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-357"><a href="#cb89-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-358"><a href="#cb89-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCAtools-pairsplots-TxB</span></span>
<span id="cb89-359"><a href="#cb89-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb89-360"><a href="#cb89-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb89-361"><a href="#cb89-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-362"><a href="#cb89-362" aria-hidden="true" tabindex="-1"></a><span class="do">## Colour and shape scheme for all biplots</span></span>
<span id="cb89-363"><a href="#cb89-363" aria-hidden="true" tabindex="-1"></a>colkey <span class="ot">=</span> <span class="fu">c</span>(<span class="at">Conversation=</span><span class="st">"#BD241E"</span>, <span class="at">Fiction=</span><span class="st">"#A18A33"</span>, <span class="at">Informative=</span><span class="st">"#15274D"</span>, <span class="at">Instructional=</span><span class="st">"#F9B921"</span>, <span class="at">Personal=</span><span class="st">"#722672"</span>)</span>
<span id="cb89-364"><a href="#cb89-364" aria-hidden="true" tabindex="-1"></a>shapekey <span class="ot">=</span> <span class="fu">c</span>(<span class="at">A=</span><span class="dv">1</span>, <span class="at">B=</span><span class="dv">2</span>, <span class="at">C=</span><span class="dv">6</span>, <span class="at">D=</span><span class="dv">0</span>, <span class="at">E=</span><span class="dv">5</span>)</span>
<span id="cb89-365"><a href="#cb89-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-366"><a href="#cb89-366" aria-hidden="true" tabindex="-1"></a><span class="do">## Very slow, open in zoomed out window!</span></span>
<span id="cb89-367"><a href="#cb89-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend manually? Yes (take it from the biplot code below), sadly really the simplest solution, here. Or use Evert's mvar.pairs plot function (though that also requires manual axis annotation).</span></span>
<span id="cb89-368"><a href="#cb89-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-369"><a href="#cb89-369" aria-hidden="true" tabindex="-1"></a><span class="co"># png(here("plots", "PCA_TxB_pairsplot.png"), width = 12, height= 19, units = "cm", res = 300)</span></span>
<span id="cb89-370"><a href="#cb89-370" aria-hidden="true" tabindex="-1"></a>PCAtools<span class="sc">::</span><span class="fu">pairsplot</span>(p,</span>
<span id="cb89-371"><a href="#cb89-371" aria-hidden="true" tabindex="-1"></a>                 <span class="at">triangle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-372"><a href="#cb89-372" aria-hidden="true" tabindex="-1"></a>                 <span class="at">components =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb89-373"><a href="#cb89-373" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb89-374"><a href="#cb89-374" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">5</span>,</span>
<span id="cb89-375"><a href="#cb89-375" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="fl">0.8</span>,</span>
<span id="cb89-376"><a href="#cb89-376" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb89-377"><a href="#cb89-377" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Register"</span>,</span>
<span id="cb89-378"><a href="#cb89-378" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey,</span>
<span id="cb89-379"><a href="#cb89-379" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb89-380"><a href="#cb89-380" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb89-381"><a href="#cb89-381" aria-hidden="true" tabindex="-1"></a>                 <span class="at">margingaps =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="st">"cm"</span>),</span>
<span id="cb89-382"><a href="#cb89-382" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">"none"</span>)</span>
<span id="cb89-383"><a href="#cb89-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-384"><a href="#cb89-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-387"><a href="#cb89-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-388"><a href="#cb89-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb89-389"><a href="#cb89-389" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb89-390"><a href="#cb89-390" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(here("plots", "PCA_TxB_pairsplot.svg"), width = 6, height = 10)</span></span>
<span id="cb89-391"><a href="#cb89-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-392"><a href="#cb89-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-393"><a href="#cb89-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-394"><a href="#cb89-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bi-plots</span></span>
<span id="cb89-395"><a href="#cb89-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-396"><a href="#cb89-396" aria-hidden="true" tabindex="-1"></a>Then, biplots of the most important dimensions are generated to examine components more carefully.</span>
<span id="cb89-397"><a href="#cb89-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-400"><a href="#cb89-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-401"><a href="#cb89-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-402"><a href="#cb89-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCAtools-biplots-TxB</span></span>
<span id="cb89-403"><a href="#cb89-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb89-404"><a href="#cb89-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 13</span></span>
<span id="cb89-405"><a href="#cb89-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-406"><a href="#cb89-406" aria-hidden="true" tabindex="-1"></a>colkey <span class="ot">=</span> <span class="fu">c</span>(<span class="at">Conversation=</span><span class="st">"#BD241E"</span>, <span class="at">Fiction=</span><span class="st">"#A18A33"</span>, <span class="at">Informative=</span><span class="st">"#15274D"</span>, <span class="at">Instructional=</span><span class="st">"#F9B921"</span>, <span class="at">Personal=</span><span class="st">"#722672"</span>)</span>
<span id="cb89-407"><a href="#cb89-407" aria-hidden="true" tabindex="-1"></a>shapekey <span class="ot">=</span> <span class="fu">c</span>(<span class="at">A=</span><span class="dv">1</span>, <span class="at">B=</span><span class="dv">2</span>, <span class="at">C=</span><span class="dv">6</span>, <span class="at">D=</span><span class="dv">0</span>, <span class="at">E=</span><span class="dv">5</span>)</span>
<span id="cb89-408"><a href="#cb89-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-409"><a href="#cb89-409" aria-hidden="true" tabindex="-1"></a><span class="co">#png(here("plots", "PCA_TxB_Biplot_PC1_PC2.png"), width = 40, height= 25, units = "cm", res = 300)</span></span>
<span id="cb89-410"><a href="#cb89-410" aria-hidden="true" tabindex="-1"></a>PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb89-411"><a href="#cb89-411" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC1"</span>,</span>
<span id="cb89-412"><a href="#cb89-412" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC2"</span>,</span>
<span id="cb89-413"><a href="#cb89-413" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb89-414"><a href="#cb89-414" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#xlim = c(min(p$rotated$PC1)-0.5, max(p$rotated$PC1)+0.5),</span></span>
<span id="cb89-415"><a href="#cb89-415" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#ylim = c(min(p$rotated$PC2)-0.5, max(p$rotated$PC2)+0.5),</span></span>
<span id="cb89-416"><a href="#cb89-416" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Register"</span>,</span>
<span id="cb89-417"><a href="#cb89-417" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="dv">2</span>,</span>
<span id="cb89-418"><a href="#cb89-418" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey,</span>
<span id="cb89-419"><a href="#cb89-419" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb89-420"><a href="#cb89-420" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb89-421"><a href="#cb89-421" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-422"><a href="#cb89-422" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-423"><a href="#cb89-423" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisLabSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-424"><a href="#cb89-424" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb89-425"><a href="#cb89-425" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-426"><a href="#cb89-426" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">18</span>, </span>
<span id="cb89-427"><a href="#cb89-427" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb89-428"><a href="#cb89-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb89-429"><a href="#cb89-429" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb89-430"><a href="#cb89-430" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC1_PC2.svg"), width = 12, height = 10)</span></span>
<span id="cb89-431"><a href="#cb89-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-432"><a href="#cb89-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-433"><a href="#cb89-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-436"><a href="#cb89-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-437"><a href="#cb89-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb89-438"><a href="#cb89-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb89-439"><a href="#cb89-439" aria-hidden="true" tabindex="-1"></a><span class="do">### This allows for the interactive examination of individual data points (i.e., texts):</span></span>
<span id="cb89-440"><a href="#cb89-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-441"><a href="#cb89-441" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb89-442"><a href="#cb89-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-443"><a href="#cb89-443" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb89-444"><a href="#cb89-444" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC1"</span>,</span>
<span id="cb89-445"><a href="#cb89-445" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC2"</span>,</span>
<span id="cb89-446"><a href="#cb89-446" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb89-447"><a href="#cb89-447" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Register"</span>,</span>
<span id="cb89-448"><a href="#cb89-448" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="dv">2</span>,</span>
<span id="cb89-449"><a href="#cb89-449" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey,</span>
<span id="cb89-450"><a href="#cb89-450" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb89-451"><a href="#cb89-451" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb89-452"><a href="#cb89-452" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-453"><a href="#cb89-453" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-454"><a href="#cb89-454" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axisLabSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-455"><a href="#cb89-455" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb89-456"><a href="#cb89-456" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-457"><a href="#cb89-457" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">18</span>, </span>
<span id="cb89-458"><a href="#cb89-458" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb89-459"><a href="#cb89-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb89-460"><a href="#cb89-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-461"><a href="#cb89-461" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(plot) <span class="co"># tooltip</span></span>
<span id="cb89-462"><a href="#cb89-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-463"><a href="#cb89-463" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb89-464"><a href="#cb89-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-465"><a href="#cb89-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-466"><a href="#cb89-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-469"><a href="#cb89-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-470"><a href="#cb89-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-471"><a href="#cb89-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCAtools-biplots-TxB2</span></span>
<span id="cb89-472"><a href="#cb89-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb89-473"><a href="#cb89-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 13</span></span>
<span id="cb89-474"><a href="#cb89-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-475"><a href="#cb89-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplots to examine components more carefully</span></span>
<span id="cb89-476"><a href="#cb89-476" aria-hidden="true" tabindex="-1"></a>pRegisters <span class="ot">&lt;-</span> PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb89-477"><a href="#cb89-477" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC3"</span>,</span>
<span id="cb89-478"><a href="#cb89-478" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC4"</span>,</span>
<span id="cb89-479"><a href="#cb89-479" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb89-480"><a href="#cb89-480" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Register"</span>,</span>
<span id="cb89-481"><a href="#cb89-481" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="dv">2</span>,</span>
<span id="cb89-482"><a href="#cb89-482" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey,</span>
<span id="cb89-483"><a href="#cb89-483" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb89-484"><a href="#cb89-484" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb89-485"><a href="#cb89-485" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-486"><a href="#cb89-486" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-487"><a href="#cb89-487" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb89-488"><a href="#cb89-488" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-489"><a href="#cb89-489" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">18</span>, </span>
<span id="cb89-490"><a href="#cb89-490" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb89-491"><a href="#cb89-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb89-492"><a href="#cb89-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-493"><a href="#cb89-493" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC3_PC4.svg"), width = 12, height = 10)</span></span>
<span id="cb89-494"><a href="#cb89-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-495"><a href="#cb89-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplots to examine components more carefully</span></span>
<span id="cb89-496"><a href="#cb89-496" aria-hidden="true" tabindex="-1"></a>pRegisters2 <span class="ot">&lt;-</span> PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb89-497"><a href="#cb89-497" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC5"</span>,</span>
<span id="cb89-498"><a href="#cb89-498" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC6"</span>,</span>
<span id="cb89-499"><a href="#cb89-499" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb89-500"><a href="#cb89-500" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Register"</span>,</span>
<span id="cb89-501"><a href="#cb89-501" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="dv">2</span>,</span>
<span id="cb89-502"><a href="#cb89-502" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkey,</span>
<span id="cb89-503"><a href="#cb89-503" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Level"</span>,</span>
<span id="cb89-504"><a href="#cb89-504" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekey,</span>
<span id="cb89-505"><a href="#cb89-505" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-506"><a href="#cb89-506" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-507"><a href="#cb89-507" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb89-508"><a href="#cb89-508" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-509"><a href="#cb89-509" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">18</span>, </span>
<span id="cb89-510"><a href="#cb89-510" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb89-511"><a href="#cb89-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb89-512"><a href="#cb89-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-513"><a href="#cb89-513" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC5_PC6.svg"), width = 12, height = 10)</span></span>
<span id="cb89-514"><a href="#cb89-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-515"><a href="#cb89-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-516"><a href="#cb89-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-517"><a href="#cb89-517" aria-hidden="true" tabindex="-1"></a>Changing the colour of the points and the ellipses to represent the texts' target proficiency levels instead of the register allows for a different interpretation of the model.</span>
<span id="cb89-518"><a href="#cb89-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-521"><a href="#cb89-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-522"><a href="#cb89-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-523"><a href="#cb89-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: PCAtools-biplots-TxB-Levels</span></span>
<span id="cb89-524"><a href="#cb89-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb89-525"><a href="#cb89-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 13</span></span>
<span id="cb89-526"><a href="#cb89-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-527"><a href="#cb89-527" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverted keys for the biplots with ellipses for Level rather than Register</span></span>
<span id="cb89-528"><a href="#cb89-528" aria-hidden="true" tabindex="-1"></a>colkeyLevels <span class="ot">=</span> <span class="fu">c</span>(<span class="at">A=</span><span class="st">"#F9B921"</span>, <span class="at">B=</span><span class="st">"#A18A33"</span>, <span class="at">C=</span><span class="st">"#BD241E"</span>, <span class="at">D=</span><span class="st">"#722672"</span>, <span class="at">E=</span><span class="st">"#15274D"</span>)</span>
<span id="cb89-529"><a href="#cb89-529" aria-hidden="true" tabindex="-1"></a>shapekeyLevels <span class="ot">=</span> <span class="fu">c</span>(<span class="at">Conversation=</span><span class="dv">1</span>, <span class="at">Fiction=</span><span class="dv">2</span>, <span class="at">Informative=</span><span class="dv">6</span>, <span class="at">Instructional=</span><span class="dv">0</span>, <span class="at">Personal=</span><span class="dv">5</span>)</span>
<span id="cb89-530"><a href="#cb89-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-531"><a href="#cb89-531" aria-hidden="true" tabindex="-1"></a>pLevels <span class="ot">&lt;-</span> PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb89-532"><a href="#cb89-532" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC3"</span>,</span>
<span id="cb89-533"><a href="#cb89-533" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC4"</span>,</span>
<span id="cb89-534"><a href="#cb89-534" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb89-535"><a href="#cb89-535" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#xlim = c(min(p$rotated$PC1)-0.5, max(p$rotated$PC1)+0.5),</span></span>
<span id="cb89-536"><a href="#cb89-536" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#ylim = c(min(p$rotated$PC2)-0.5, max(p$rotated$PC2)+0.5),</span></span>
<span id="cb89-537"><a href="#cb89-537" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Level"</span>,</span>
<span id="cb89-538"><a href="#cb89-538" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="dv">2</span>,</span>
<span id="cb89-539"><a href="#cb89-539" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkeyLevels,</span>
<span id="cb89-540"><a href="#cb89-540" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Register"</span>,</span>
<span id="cb89-541"><a href="#cb89-541" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekeyLevels,</span>
<span id="cb89-542"><a href="#cb89-542" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-543"><a href="#cb89-543" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-544"><a href="#cb89-544" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb89-545"><a href="#cb89-545" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-546"><a href="#cb89-546" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">18</span>, </span>
<span id="cb89-547"><a href="#cb89-547" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb89-548"><a href="#cb89-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb89-549"><a href="#cb89-549" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC3_PC4_Level.svg"), width = 12, height = 10)</span></span>
<span id="cb89-550"><a href="#cb89-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-551"><a href="#cb89-551" aria-hidden="true" tabindex="-1"></a>pLevels2 <span class="ot">&lt;-</span> PCAtools<span class="sc">::</span><span class="fu">biplot</span>(p,</span>
<span id="cb89-552"><a href="#cb89-552" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"PC5"</span>,</span>
<span id="cb89-553"><a href="#cb89-553" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">"PC6"</span>,</span>
<span id="cb89-554"><a href="#cb89-554" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lab =</span> <span class="cn">NULL</span>, <span class="co"># Otherwise will try to label each data point!</span></span>
<span id="cb89-555"><a href="#cb89-555" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#xlim = c(min(p$rotated$PC1)-0.5, max(p$rotated$PC1)+0.5),</span></span>
<span id="cb89-556"><a href="#cb89-556" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#ylim = c(min(p$rotated$PC2)-0.5, max(p$rotated$PC2)+0.5),</span></span>
<span id="cb89-557"><a href="#cb89-557" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colby =</span> <span class="st">"Level"</span>,</span>
<span id="cb89-558"><a href="#cb89-558" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pointSize =</span> <span class="dv">2</span>,</span>
<span id="cb89-559"><a href="#cb89-559" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colkey =</span> colkeyLevels,</span>
<span id="cb89-560"><a href="#cb89-560" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">"Register"</span>,</span>
<span id="cb89-561"><a href="#cb89-561" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shapekey =</span> shapekeyLevels,</span>
<span id="cb89-562"><a href="#cb89-562" aria-hidden="true" tabindex="-1"></a>                 <span class="at">showLoadings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-563"><a href="#cb89-563" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-564"><a href="#cb89-564" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendPosition =</span> <span class="st">'right'</span>,</span>
<span id="cb89-565"><a href="#cb89-565" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendTitleSize =</span> <span class="dv">22</span>,</span>
<span id="cb89-566"><a href="#cb89-566" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendLabSize =</span> <span class="dv">18</span>, </span>
<span id="cb89-567"><a href="#cb89-567" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legendIconSize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb89-568"><a href="#cb89-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="st">"cm"</span>))</span>
<span id="cb89-569"><a href="#cb89-569" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC5_PC6_Level.svg"), width = 12, height = 10)</span></span>
<span id="cb89-570"><a href="#cb89-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-571"><a href="#cb89-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-572"><a href="#cb89-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Display and save the two different representations of data points on PC2 and PC3 using the {patchwork} package</span></span>
<span id="cb89-573"><a href="#cb89-573" aria-hidden="true" tabindex="-1"></a>pRegisters <span class="sc">/</span> pLevels</span>
<span id="cb89-574"><a href="#cb89-574" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC3_PC4_Register_vs_Level.svg"), width = 14, height = 20)</span></span>
<span id="cb89-575"><a href="#cb89-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-576"><a href="#cb89-576" aria-hidden="true" tabindex="-1"></a><span class="co"># Display and save the two different representations of data points on PC5 and PC6 using the {patchwork} package </span></span>
<span id="cb89-577"><a href="#cb89-577" aria-hidden="true" tabindex="-1"></a>pRegisters2 <span class="sc">/</span> pLevels2</span>
<span id="cb89-578"><a href="#cb89-578" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "PCA_TxB_BiplotPC5_PC6_Register_vs_Level.svg"), width = 14, height = 20)</span></span>
<span id="cb89-579"><a href="#cb89-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-580"><a href="#cb89-580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-581"><a href="#cb89-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-582"><a href="#cb89-582" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature contributions (loadings) on each component</span></span>
<span id="cb89-583"><a href="#cb89-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-586"><a href="#cb89-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-587"><a href="#cb89-587" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-588"><a href="#cb89-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: loadings</span></span>
<span id="cb89-589"><a href="#cb89-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-590"><a href="#cb89-590" aria-hidden="true" tabindex="-1"></a><span class="co">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span id="cb89-591"><a href="#cb89-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-592"><a href="#cb89-592" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(TxBdata[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(TxBdata)], <span class="at">scale.=</span><span class="cn">FALSE</span>) <span class="co"># All quantitative variables for all TEC files</span></span>
<span id="cb89-593"><a href="#cb89-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-594"><a href="#cb89-594" aria-hidden="true" tabindex="-1"></a><span class="co"># The rotated data that represents the observations / samples is stored in rotated, while the variable loadings are stored in loadings</span></span>
<span id="cb89-595"><a href="#cb89-595" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>rotation[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb89-596"><a href="#cb89-596" aria-hidden="true" tabindex="-1"></a>loadings <span class="sc">|&gt;</span> </span>
<span id="cb89-597"><a href="#cb89-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb89-598"><a href="#cb89-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span>
<span id="cb89-599"><a href="#cb89-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-600"><a href="#cb89-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-601"><a href="#cb89-601" aria-hidden="true" tabindex="-1"></a>We can go back to the normalised frequencies of the individual features to compare them across different registers and levels, e.g.:</span>
<span id="cb89-602"><a href="#cb89-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-605"><a href="#cb89-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-606"><a href="#cb89-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: comparisons</span></span>
<span id="cb89-607"><a href="#cb89-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-608"><a href="#cb89-608" aria-hidden="true" tabindex="-1"></a>TxBcounts <span class="sc">|&gt;</span> </span>
<span id="cb89-609"><a href="#cb89-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Register, Level) <span class="sc">|&gt;</span> </span>
<span id="cb89-610"><a href="#cb89-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">median</span>(NCOMP), <span class="fu">MAD</span>(NCOMP)) <span class="sc">|&gt;</span> </span>
<span id="cb89-611"><a href="#cb89-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb89-612"><a href="#cb89-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb89-613"><a href="#cb89-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-614"><a href="#cb89-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-615"><a href="#cb89-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-616"><a href="#cb89-616" aria-hidden="true" tabindex="-1"></a>Graphs of features display the features with the strongest contributions to any two dimensions of the model of intra-textbook variation. They are created using the <span class="in">`factoextra::fviz_pca_var`</span> function.</span>
<span id="cb89-617"><a href="#cb89-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-618"><a href="#cb89-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r graphs-of-variables}</span></span>
<span id="cb89-619"><a href="#cb89-619" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb89-620"><a href="#cb89-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-621"><a href="#cb89-621" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_var(pca,</span></span>
<span id="cb89-622"><a href="#cb89-622" aria-hidden="true" tabindex="-1"></a><span class="in">             axes = c(1,2),</span></span>
<span id="cb89-623"><a href="#cb89-623" aria-hidden="true" tabindex="-1"></a><span class="in">             select.var = list(cos2 = 0.1),</span></span>
<span id="cb89-624"><a href="#cb89-624" aria-hidden="true" tabindex="-1"></a><span class="in">             col.var = "contrib", # Colour by contributions to the PC</span></span>
<span id="cb89-625"><a href="#cb89-625" aria-hidden="true" tabindex="-1"></a><span class="in">             gradient.cols = c("#F9B921", "#DB241E", "#722672"),</span></span>
<span id="cb89-626"><a href="#cb89-626" aria-hidden="true" tabindex="-1"></a><span class="in">             title = "",</span></span>
<span id="cb89-627"><a href="#cb89-627" aria-hidden="true" tabindex="-1"></a><span class="in">             repel = TRUE, # Try to avoid too much text overlapping</span></span>
<span id="cb89-628"><a href="#cb89-628" aria-hidden="true" tabindex="-1"></a><span class="in">             ggtheme = ggthemes::theme_few())</span></span>
<span id="cb89-629"><a href="#cb89-629" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "fviz_pca_var_PC1_PC2.svg"), width = 11, height = 9)</span></span>
<span id="cb89-630"><a href="#cb89-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-631"><a href="#cb89-631" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_var(pca,</span></span>
<span id="cb89-632"><a href="#cb89-632" aria-hidden="true" tabindex="-1"></a><span class="in">             axes = c(3,2),</span></span>
<span id="cb89-633"><a href="#cb89-633" aria-hidden="true" tabindex="-1"></a><span class="in">             select.var = list(contrib = 30),</span></span>
<span id="cb89-634"><a href="#cb89-634" aria-hidden="true" tabindex="-1"></a><span class="in">             col.var = "contrib", # Colour by contributions to the PC</span></span>
<span id="cb89-635"><a href="#cb89-635" aria-hidden="true" tabindex="-1"></a><span class="in">             gradient.cols = c("#F9B921", "#DB241E", "#722672"),</span></span>
<span id="cb89-636"><a href="#cb89-636" aria-hidden="true" tabindex="-1"></a><span class="in">             title = "",</span></span>
<span id="cb89-637"><a href="#cb89-637" aria-hidden="true" tabindex="-1"></a><span class="in">             repel = TRUE, # Try to avoid too much text overlapping</span></span>
<span id="cb89-638"><a href="#cb89-638" aria-hidden="true" tabindex="-1"></a><span class="in">             ggtheme = ggthemes::theme_few())</span></span>
<span id="cb89-639"><a href="#cb89-639" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "fviz_pca_var_PC3_PC2.svg"), width = 9, height = 8)</span></span>
<span id="cb89-640"><a href="#cb89-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-641"><a href="#cb89-641" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_var(pca,</span></span>
<span id="cb89-642"><a href="#cb89-642" aria-hidden="true" tabindex="-1"></a><span class="in">             axes = c(3,4),</span></span>
<span id="cb89-643"><a href="#cb89-643" aria-hidden="true" tabindex="-1"></a><span class="in">             select.var = list(contrib = 30),</span></span>
<span id="cb89-644"><a href="#cb89-644" aria-hidden="true" tabindex="-1"></a><span class="in">             col.var = "contrib", # Colour by contributions to the PC</span></span>
<span id="cb89-645"><a href="#cb89-645" aria-hidden="true" tabindex="-1"></a><span class="in">             gradient.cols = c("#F9B921", "#DB241E", "#722672"),</span></span>
<span id="cb89-646"><a href="#cb89-646" aria-hidden="true" tabindex="-1"></a><span class="in">             title = "",</span></span>
<span id="cb89-647"><a href="#cb89-647" aria-hidden="true" tabindex="-1"></a><span class="in">             repel = TRUE, # Try to avoid too much text overlapping</span></span>
<span id="cb89-648"><a href="#cb89-648" aria-hidden="true" tabindex="-1"></a><span class="in">             ggtheme = ggthemes::theme_few())</span></span>
<span id="cb89-649"><a href="#cb89-649" aria-hidden="true" tabindex="-1"></a><span class="in">#ggsave(here("plots", "fviz_pca_var_PC3_PC4.svg"), width = 9, height = 8)</span></span>
<span id="cb89-650"><a href="#cb89-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-651"><a href="#cb89-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-652"><a href="#cb89-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-653"><a href="#cb89-653" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploring the dimensions of the model</span></span>
<span id="cb89-654"><a href="#cb89-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-655"><a href="#cb89-655" aria-hidden="true" tabindex="-1"></a>We begin with some descriptive statistics of the dimension scores.</span>
<span id="cb89-656"><a href="#cb89-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-657"><a href="#cb89-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCA-numerical-results}</span></span>
<span id="cb89-658"><a href="#cb89-658" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb89-659"><a href="#cb89-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-660"><a href="#cb89-660" aria-hidden="true" tabindex="-1"></a><span class="in"># http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/#pca-results-for-variables</span></span>
<span id="cb89-661"><a href="#cb89-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-662"><a href="#cb89-662" aria-hidden="true" tabindex="-1"></a><span class="in">#TxBdata &lt;- readRDS(here("data", "processed", "TxBdataforPCA.rds"))</span></span>
<span id="cb89-663"><a href="#cb89-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-664"><a href="#cb89-664" aria-hidden="true" tabindex="-1"></a><span class="in">pca &lt;- prcomp(TxBdata[,7:ncol(TxBdata)], scale.=FALSE) # All quantitative variables for all TxB files</span></span>
<span id="cb89-665"><a href="#cb89-665" aria-hidden="true" tabindex="-1"></a><span class="in">register  &lt;- factor(TxBdata[,"Register"]) # Register</span></span>
<span id="cb89-666"><a href="#cb89-666" aria-hidden="true" tabindex="-1"></a><span class="in">level &lt;- factor(TxBdata[,"Level"]) # Textbook proficiency level</span></span>
<span id="cb89-667"><a href="#cb89-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-668"><a href="#cb89-668" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(register)</span></span>
<span id="cb89-669"><a href="#cb89-669" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(level)</span></span>
<span id="cb89-670"><a href="#cb89-670" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(pca)</span></span>
<span id="cb89-671"><a href="#cb89-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-672"><a href="#cb89-672" aria-hidden="true" tabindex="-1"></a><span class="in">## Access to the PCA results for individual PC</span></span>
<span id="cb89-673"><a href="#cb89-673" aria-hidden="true" tabindex="-1"></a><span class="in">#pca$rotation[,1]</span></span>
<span id="cb89-674"><a href="#cb89-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-675"><a href="#cb89-675" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind &lt;- cbind(TxBdata[,1:5], as.data.frame(pca$x)[,1:6])</span></span>
<span id="cb89-676"><a href="#cb89-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-677"><a href="#cb89-677" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind |&gt; </span></span>
<span id="cb89-678"><a href="#cb89-678" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Register) |&gt; </span></span>
<span id="cb89-679"><a href="#cb89-679" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise_if(is.numeric, mean) |&gt; </span></span>
<span id="cb89-680"><a href="#cb89-680" aria-hidden="true" tabindex="-1"></a><span class="in">  kable(digits = 2)</span></span>
<span id="cb89-681"><a href="#cb89-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-682"><a href="#cb89-682" aria-hidden="true" tabindex="-1"></a><span class="in">res.ind |&gt; </span></span>
<span id="cb89-683"><a href="#cb89-683" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Register, Level) |&gt; </span></span>
<span id="cb89-684"><a href="#cb89-684" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise_if(is.numeric, mean) |&gt; </span></span>
<span id="cb89-685"><a href="#cb89-685" aria-hidden="true" tabindex="-1"></a><span class="in">  kable(digits = 2)</span></span>
<span id="cb89-686"><a href="#cb89-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-687"><a href="#cb89-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-688"><a href="#cb89-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-689"><a href="#cb89-689" aria-hidden="true" tabindex="-1"></a>The following chunk can be used to search for example texts that are located in specific areas of the biplots. For example, we can search for texts that have high scores on Dim3 and low ones on Dim2 to proceed with a qualitative comparison and analysis of these texts.</span>
<span id="cb89-690"><a href="#cb89-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-693"><a href="#cb89-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-694"><a href="#cb89-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: example-texts</span></span>
<span id="cb89-695"><a href="#cb89-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-696"><a href="#cb89-696" aria-hidden="true" tabindex="-1"></a>res.ind <span class="sc">|&gt;</span> </span>
<span id="cb89-697"><a href="#cb89-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PC3 <span class="sc">&gt;</span> <span class="fl">2.5</span> <span class="sc">&amp;</span> PC2 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb89-698"><a href="#cb89-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Filename, PC2, PC3) <span class="sc">|&gt;</span> </span>
<span id="cb89-699"><a href="#cb89-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb89-700"><a href="#cb89-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-701"><a href="#cb89-701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-702"><a href="#cb89-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-703"><a href="#cb89-703" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computing mixed-effects models of the dimension scores</span></span>
<span id="cb89-704"><a href="#cb89-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-705"><a href="#cb89-705" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 1: ‘Overt instructions and explanations’</span></span>
<span id="cb89-706"><a href="#cb89-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-707"><a href="#cb89-707" aria-hidden="true" tabindex="-1"></a>Having compared various models, the following model is chosen as the best-fitting one.</span>
<span id="cb89-708"><a href="#cb89-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-709"><a href="#cb89-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lmer-models-dim1}</span></span>
<span id="cb89-710"><a href="#cb89-710" aria-hidden="true" tabindex="-1"></a><span class="in"># Models with Textbook series as random intercepts</span></span>
<span id="cb89-711"><a href="#cb89-711" aria-hidden="true" tabindex="-1"></a><span class="in">md1 &lt;- lmer(PC1 ~ Register*Level + (1|Series), data = res.ind, REML = FALSE)</span></span>
<span id="cb89-712"><a href="#cb89-712" aria-hidden="true" tabindex="-1"></a><span class="in">md1Register &lt;- lmer(PC1 ~ Register + (1|Series), data = res.ind, REML = FALSE)</span></span>
<span id="cb89-713"><a href="#cb89-713" aria-hidden="true" tabindex="-1"></a><span class="in">md1Level &lt;- lmer(PC1 ~ Level + (1|Series), data = res.ind, REML = FALSE)</span></span>
<span id="cb89-714"><a href="#cb89-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-715"><a href="#cb89-715" aria-hidden="true" tabindex="-1"></a><span class="in">anova(md1, md1Register, md1Level)</span></span>
<span id="cb89-716"><a href="#cb89-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-717"><a href="#cb89-717" aria-hidden="true" tabindex="-1"></a><span class="in">tab_model(md1, wrap.labels = 300) # Marginal R2 = 0.890</span></span>
<span id="cb89-718"><a href="#cb89-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-719"><a href="#cb89-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-722"><a href="#cb89-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-723"><a href="#cb89-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb89-724"><a href="#cb89-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-725"><a href="#cb89-725" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md1Register) # Marginal R2 = 0.877</span></span>
<span id="cb89-726"><a href="#cb89-726" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md1Level) # Marginal R2 = 0.002</span></span>
<span id="cb89-727"><a href="#cb89-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-728"><a href="#cb89-728" aria-hidden="true" tabindex="-1"></a><span class="co"># Tweak plot aesthetics with: https://cran.r-project.org/web/packages/sjPlot/vignettes/custplot.html</span></span>
<span id="cb89-729"><a href="#cb89-729" aria-hidden="true" tabindex="-1"></a><span class="co"># Colour customisation trick from: https://stackoverflow.com/questions/55598920/different-line-colors-in-forest-plot-output-from-sjplot-r-package</span></span>
<span id="cb89-730"><a href="#cb89-730" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-731"><a href="#cb89-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-732"><a href="#cb89-732" aria-hidden="true" tabindex="-1"></a>Its estimated coefficients are visualised in the plot below.</span>
<span id="cb89-733"><a href="#cb89-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-736"><a href="#cb89-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-737"><a href="#cb89-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim1fixed</span></span>
<span id="cb89-738"><a href="#cb89-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-739"><a href="#cb89-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-740"><a href="#cb89-740" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of fixed effects:</span></span>
<span id="cb89-741"><a href="#cb89-741" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md1Register, </span>
<span id="cb89-742"><a href="#cb89-742" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb89-743"><a href="#cb89-743" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-744"><a href="#cb89-744" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-745"><a href="#cb89-745" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-746"><a href="#cb89-746" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-747"><a href="#cb89-747" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-748"><a href="#cb89-748" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">7</span>)],</span>
<span id="cb89-749"><a href="#cb89-749" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb89-750"><a href="#cb89-750" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb89-751"><a href="#cb89-751" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-752"><a href="#cb89-752" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC1 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-753"><a href="#cb89-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb89-754"><a href="#cb89-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-755"><a href="#cb89-755" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA1_lmer_fixedeffects_Register.svg"), height = 3, width = 8)</span></span>
<span id="cb89-756"><a href="#cb89-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-757"><a href="#cb89-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-758"><a href="#cb89-758" aria-hidden="true" tabindex="-1"></a>The <span class="in">`emmeans`</span> and <span class="in">`pairs`</span> functions are used to compare the estimated Dim1 scores for each register and to compare these to one another.</span>
<span id="cb89-759"><a href="#cb89-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-762"><a href="#cb89-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-763"><a href="#cb89-763" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim1comparisons</span></span>
<span id="cb89-764"><a href="#cb89-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-765"><a href="#cb89-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-766"><a href="#cb89-766" aria-hidden="true" tabindex="-1"></a>Register_results <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(md1Register, <span class="st">"Register"</span>)</span>
<span id="cb89-767"><a href="#cb89-767" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Register_results)</span>
<span id="cb89-768"><a href="#cb89-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-769"><a href="#cb89-769" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">&lt;-</span> <span class="fu">pairs</span>(Register_results, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb89-770"><a href="#cb89-770" aria-hidden="true" tabindex="-1"></a>comparisons</span>
<span id="cb89-771"><a href="#cb89-771" aria-hidden="true" tabindex="-1"></a><span class="co">#write_last_clip()</span></span>
<span id="cb89-772"><a href="#cb89-772" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(comparisons)</span>
<span id="cb89-773"><a href="#cb89-773" aria-hidden="true" tabindex="-1"></a><span class="co">#write_last_clip()</span></span>
<span id="cb89-774"><a href="#cb89-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-775"><a href="#cb89-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-776"><a href="#cb89-776" aria-hidden="true" tabindex="-1"></a>We can also visualise the estimated coefficients for the textbook series, which is modelled here as a random effect.</span>
<span id="cb89-777"><a href="#cb89-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-780"><a href="#cb89-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-781"><a href="#cb89-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim1random</span></span>
<span id="cb89-782"><a href="#cb89-782" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-783"><a href="#cb89-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-784"><a href="#cb89-784" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md1, </span>
<span id="cb89-785"><a href="#cb89-785" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span id="cb89-786"><a href="#cb89-786" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-787"><a href="#cb89-787" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-788"><a href="#cb89-788" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-789"><a href="#cb89-789" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-790"><a href="#cb89-790" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> <span class="st">"bw"</span>,</span>
<span id="cb89-791"><a href="#cb89-791" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-792"><a href="#cb89-792" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC1 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-793"><a href="#cb89-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>()</span>
<span id="cb89-794"><a href="#cb89-794" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA1_lmer_randomeffects.svg"), height = 3, width = 8)</span></span>
<span id="cb89-795"><a href="#cb89-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-796"><a href="#cb89-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-797"><a href="#cb89-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-798"><a href="#cb89-798" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 2: ‘Involved vs. Informational Production’</span></span>
<span id="cb89-799"><a href="#cb89-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-802"><a href="#cb89-802" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-803"><a href="#cb89-803" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim2model</span></span>
<span id="cb89-804"><a href="#cb89-804" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-805"><a href="#cb89-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-806"><a href="#cb89-806" aria-hidden="true" tabindex="-1"></a>md2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC2 <span class="sc">~</span> Register<span class="sc">*</span>Level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-807"><a href="#cb89-807" aria-hidden="true" tabindex="-1"></a>md2Register <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC2 <span class="sc">~</span> Register <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-808"><a href="#cb89-808" aria-hidden="true" tabindex="-1"></a>md2Level <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC2 <span class="sc">~</span> Level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-809"><a href="#cb89-809" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(md2, md2Register, md2Level)</span>
<span id="cb89-810"><a href="#cb89-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-811"><a href="#cb89-811" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(md2) <span class="co"># Marginal R2 = 0.723</span></span>
<span id="cb89-812"><a href="#cb89-812" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md2Register) # Marginal R2 = 0.558</span></span>
<span id="cb89-813"><a href="#cb89-813" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md2Level) # Marginal R2 = 0.228</span></span>
<span id="cb89-814"><a href="#cb89-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-815"><a href="#cb89-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-816"><a href="#cb89-816" aria-hidden="true" tabindex="-1"></a>Estimated coefficients of fixed effects on Dim2 scores:</span>
<span id="cb89-817"><a href="#cb89-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-820"><a href="#cb89-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-821"><a href="#cb89-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim2fixed</span></span>
<span id="cb89-822"><a href="#cb89-822" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-823"><a href="#cb89-823" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb89-824"><a href="#cb89-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-825"><a href="#cb89-825" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md2, </span>
<span id="cb89-826"><a href="#cb89-826" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb89-827"><a href="#cb89-827" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-828"><a href="#cb89-828" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-829"><a href="#cb89-829" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-830"><a href="#cb89-830" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-831"><a href="#cb89-831" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-832"><a href="#cb89-832" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">7</span>)],</span>
<span id="cb89-833"><a href="#cb89-833" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb89-834"><a href="#cb89-834" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb89-835"><a href="#cb89-835" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-836"><a href="#cb89-836" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC2 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-837"><a href="#cb89-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb89-838"><a href="#cb89-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-839"><a href="#cb89-839" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA2_lmer_fixedeffects.svg"), height = 8, width = 8)</span></span>
<span id="cb89-840"><a href="#cb89-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-841"><a href="#cb89-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-842"><a href="#cb89-842" aria-hidden="true" tabindex="-1"></a>Estimated coefficients of random effects on Dim2 scores:</span>
<span id="cb89-843"><a href="#cb89-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-846"><a href="#cb89-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-847"><a href="#cb89-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim2random</span></span>
<span id="cb89-848"><a href="#cb89-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-849"><a href="#cb89-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-850"><a href="#cb89-850" aria-hidden="true" tabindex="-1"></a><span class="do">## Random intercepts</span></span>
<span id="cb89-851"><a href="#cb89-851" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md2, </span>
<span id="cb89-852"><a href="#cb89-852" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span id="cb89-853"><a href="#cb89-853" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-854"><a href="#cb89-854" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-855"><a href="#cb89-855" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-856"><a href="#cb89-856" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-857"><a href="#cb89-857" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> <span class="st">"bw"</span>,</span>
<span id="cb89-858"><a href="#cb89-858" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-859"><a href="#cb89-859" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC2 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-860"><a href="#cb89-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>()</span>
<span id="cb89-861"><a href="#cb89-861" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA2_lmer_randomeffects.svg"), height = 3, width = 8)</span></span>
<span id="cb89-862"><a href="#cb89-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-863"><a href="#cb89-863" aria-hidden="true" tabindex="-1"></a><span class="co"># Textbook Country as a random effect variable</span></span>
<span id="cb89-864"><a href="#cb89-864" aria-hidden="true" tabindex="-1"></a>md2country <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC2 <span class="sc">~</span> Register<span class="sc">*</span>Level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Country), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-865"><a href="#cb89-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-866"><a href="#cb89-866" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md2country, </span>
<span id="cb89-867"><a href="#cb89-867" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span id="cb89-868"><a href="#cb89-868" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-869"><a href="#cb89-869" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-870"><a href="#cb89-870" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-871"><a href="#cb89-871" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-872"><a href="#cb89-872" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> <span class="st">"bw"</span>,</span>
<span id="cb89-873"><a href="#cb89-873" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-874"><a href="#cb89-874" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC2 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-875"><a href="#cb89-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>()</span>
<span id="cb89-876"><a href="#cb89-876" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA2_lmer_randomeffects_country.svg"), height = 3, width = 8)</span></span>
<span id="cb89-877"><a href="#cb89-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-878"><a href="#cb89-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-879"><a href="#cb89-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-880"><a href="#cb89-880" aria-hidden="true" tabindex="-1"></a>The <span class="in">`visreg`</span> function is used to visualise the distributions of the modelled Dim2 scores:</span>
<span id="cb89-881"><a href="#cb89-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-884"><a href="#cb89-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-885"><a href="#cb89-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim2estimateplots</span></span>
<span id="cb89-886"><a href="#cb89-886" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-887"><a href="#cb89-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb89-888"><a href="#cb89-888" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb89-889"><a href="#cb89-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-890"><a href="#cb89-890" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxB_predicted_PC2_scores_interactions.svg"), height = 5, width = 8)</span></span>
<span id="cb89-891"><a href="#cb89-891" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md2, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Register"</span>, <span class="at">type =</span> <span class="st">"conditional"</span>,</span>
<span id="cb89-892"><a href="#cb89-892" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), </span>
<span id="cb89-893"><a href="#cb89-893" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Textbook Level"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span></span>
<span id="cb89-894"><a href="#cb89-894" aria-hidden="true" tabindex="-1"></a>       <span class="co">#,gg = TRUE</span></span>
<span id="cb89-895"><a href="#cb89-895" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">layout=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb89-896"><a href="#cb89-896" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-897"><a href="#cb89-897" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb89-898"><a href="#cb89-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-899"><a href="#cb89-899" aria-hidden="true" tabindex="-1"></a><span class="co"># Textbook Series-Register interactions</span></span>
<span id="cb89-900"><a href="#cb89-900" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md2, <span class="at">xvar =</span> <span class="st">"Series"</span>, <span class="at">by=</span><span class="st">"Level"</span>, <span class="at">type =</span> <span class="st">"conditional"</span>, <span class="at">re.form=</span><span class="sc">~</span>(<span class="dv">1</span><span class="sc">|</span>Series), </span>
<span id="cb89-901"><a href="#cb89-901" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), <span class="at">xlab =</span> <span class="st">"Textbook Series"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>,</span>
<span id="cb89-902"><a href="#cb89-902" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>))</span>
<span id="cb89-903"><a href="#cb89-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-904"><a href="#cb89-904" aria-hidden="true" tabindex="-1"></a><span class="co"># Textbook Series-Register interactions</span></span>
<span id="cb89-905"><a href="#cb89-905" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxB_PCA2_lmer_randomeffects_country_register.svg"), height = 5, width = 8)</span></span>
<span id="cb89-906"><a href="#cb89-906" aria-hidden="true" tabindex="-1"></a>visreg<span class="sc">::</span><span class="fu">visreg</span>(md2country, <span class="st">"Country"</span>, <span class="at">by=</span><span class="st">"Register"</span>, <span class="at">re.form=</span><span class="sc">~</span>(<span class="dv">1</span><span class="sc">|</span>Country),</span>
<span id="cb89-907"><a href="#cb89-907" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>))</span>
<span id="cb89-908"><a href="#cb89-908" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb89-909"><a href="#cb89-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-910"><a href="#cb89-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-911"><a href="#cb89-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-912"><a href="#cb89-912" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 3: ‘Narrative vs. factual discourse’</span></span>
<span id="cb89-913"><a href="#cb89-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-916"><a href="#cb89-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-917"><a href="#cb89-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim3model</span></span>
<span id="cb89-918"><a href="#cb89-918" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-919"><a href="#cb89-919" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb89-920"><a href="#cb89-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-921"><a href="#cb89-921" aria-hidden="true" tabindex="-1"></a>md3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC3 <span class="sc">~</span> Register<span class="sc">*</span>Level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-922"><a href="#cb89-922" aria-hidden="true" tabindex="-1"></a>md3Register <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC3 <span class="sc">~</span> Register <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-923"><a href="#cb89-923" aria-hidden="true" tabindex="-1"></a>md3Level <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC3 <span class="sc">~</span> Level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-924"><a href="#cb89-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-925"><a href="#cb89-925" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(md3, md3Register, md3Level)</span>
<span id="cb89-926"><a href="#cb89-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-927"><a href="#cb89-927" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(md3) <span class="co"># Marginal R2 = 0.436</span></span>
<span id="cb89-928"><a href="#cb89-928" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md3Register) # Marginal R2 = 0.272</span></span>
<span id="cb89-929"><a href="#cb89-929" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md3Level) # Marginal R2 = 0.119</span></span>
<span id="cb89-930"><a href="#cb89-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-931"><a href="#cb89-931" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of fixed effects:</span></span>
<span id="cb89-932"><a href="#cb89-932" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md3, </span>
<span id="cb89-933"><a href="#cb89-933" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb89-934"><a href="#cb89-934" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-935"><a href="#cb89-935" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-936"><a href="#cb89-936" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-937"><a href="#cb89-937" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-938"><a href="#cb89-938" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-939"><a href="#cb89-939" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">7</span>)],</span>
<span id="cb89-940"><a href="#cb89-940" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb89-941"><a href="#cb89-941" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb89-942"><a href="#cb89-942" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-943"><a href="#cb89-943" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC3 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-944"><a href="#cb89-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb89-945"><a href="#cb89-945" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA3_lmer_fixedeffects.svg"), height = 8, width = 8)</span></span>
<span id="cb89-946"><a href="#cb89-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-947"><a href="#cb89-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-950"><a href="#cb89-950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-951"><a href="#cb89-951" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of random effects:</span></span>
<span id="cb89-952"><a href="#cb89-952" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md3, </span>
<span id="cb89-953"><a href="#cb89-953" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span id="cb89-954"><a href="#cb89-954" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-955"><a href="#cb89-955" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-956"><a href="#cb89-956" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-957"><a href="#cb89-957" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-958"><a href="#cb89-958" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"bw"</span>,</span>
<span id="cb89-959"><a href="#cb89-959" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-960"><a href="#cb89-960" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC3 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-961"><a href="#cb89-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>()</span>
<span id="cb89-962"><a href="#cb89-962" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA3_lmer_randomeffects.svg"), height = 3, width = 8)</span></span>
<span id="cb89-963"><a href="#cb89-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-964"><a href="#cb89-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-965"><a href="#cb89-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-968"><a href="#cb89-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-969"><a href="#cb89-969" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim3comparisons</span></span>
<span id="cb89-970"><a href="#cb89-970" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-971"><a href="#cb89-971" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb89-972"><a href="#cb89-972" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb89-973"><a href="#cb89-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-974"><a href="#cb89-974" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxB_predicted_PC3_scores_interactions.svg"), height = 5, width = 8)</span></span>
<span id="cb89-975"><a href="#cb89-975" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md3, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Register"</span>, <span class="at">type =</span> <span class="st">"conditional"</span>,</span>
<span id="cb89-976"><a href="#cb89-976" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), </span>
<span id="cb89-977"><a href="#cb89-977" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Textbook Level"</span>, <span class="at">ylab =</span> <span class="st">"PC3"</span></span>
<span id="cb89-978"><a href="#cb89-978" aria-hidden="true" tabindex="-1"></a>       <span class="co">#,gg = TRUE</span></span>
<span id="cb89-979"><a href="#cb89-979" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">layout=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb89-980"><a href="#cb89-980" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-981"><a href="#cb89-981" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb89-982"><a href="#cb89-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-983"><a href="#cb89-983" aria-hidden="true" tabindex="-1"></a><span class="co"># Textbook Series-Register interactions</span></span>
<span id="cb89-984"><a href="#cb89-984" aria-hidden="true" tabindex="-1"></a>visreg<span class="sc">::</span><span class="fu">visreg</span>(md3, <span class="st">"Series"</span>, <span class="at">by=</span><span class="st">"Register"</span>, <span class="at">re.form=</span><span class="sc">~</span>(<span class="dv">1</span><span class="sc">|</span>Series),</span>
<span id="cb89-985"><a href="#cb89-985" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab=</span><span class="st">"PC3"</span>, <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>))</span>
<span id="cb89-986"><a href="#cb89-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-987"><a href="#cb89-987" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md3, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Series"</span>, <span class="at">type =</span> <span class="st">"conditional"</span>, <span class="at">re.form=</span><span class="sc">~</span>(<span class="dv">1</span><span class="sc">|</span>Series), </span>
<span id="cb89-988"><a href="#cb89-988" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), <span class="at">xlab =</span> <span class="st">"Textbook Series"</span>, <span class="at">ylab =</span> <span class="st">"PC3"</span>)</span>
<span id="cb89-989"><a href="#cb89-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-990"><a href="#cb89-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-991"><a href="#cb89-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-992"><a href="#cb89-992" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimension 4: ‘Informational compression vs. elaboration’</span></span>
<span id="cb89-993"><a href="#cb89-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-996"><a href="#cb89-996" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-997"><a href="#cb89-997" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Dim4model</span></span>
<span id="cb89-998"><a href="#cb89-998" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb89-999"><a href="#cb89-999" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb89-1000"><a href="#cb89-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1001"><a href="#cb89-1001" aria-hidden="true" tabindex="-1"></a>md4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC4 <span class="sc">~</span> Register<span class="sc">*</span>Level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-1002"><a href="#cb89-1002" aria-hidden="true" tabindex="-1"></a>md4Register <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC4 <span class="sc">~</span> Register <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-1003"><a href="#cb89-1003" aria-hidden="true" tabindex="-1"></a>md4Level <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PC4 <span class="sc">~</span> Level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Series), <span class="at">data =</span> res.ind, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-1004"><a href="#cb89-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1005"><a href="#cb89-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(md4, md4Register, md4Level)</span>
<span id="cb89-1006"><a href="#cb89-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1007"><a href="#cb89-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(md4) <span class="co"># Marginal R2 = 0.426</span></span>
<span id="cb89-1008"><a href="#cb89-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md4Register) # Marginal R2 = 0.203</span></span>
<span id="cb89-1009"><a href="#cb89-1009" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_model(md4Level) # Marginal R2 = 0.187</span></span>
<span id="cb89-1010"><a href="#cb89-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1011"><a href="#cb89-1011" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of fixed effects:</span></span>
<span id="cb89-1012"><a href="#cb89-1012" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md4, </span>
<span id="cb89-1013"><a href="#cb89-1013" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"est"</span>,</span>
<span id="cb89-1014"><a href="#cb89-1014" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-1015"><a href="#cb89-1015" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-1016"><a href="#cb89-1016" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-1017"><a href="#cb89-1017" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-1018"><a href="#cb89-1018" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-1019"><a href="#cb89-1019" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> palette[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">7</span>)],</span>
<span id="cb89-1020"><a href="#cb89-1020" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.terms =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb89-1021"><a href="#cb89-1021" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb89-1022"><a href="#cb89-1022" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-1023"><a href="#cb89-1023" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC4 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-1024"><a href="#cb89-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>() </span>
<span id="cb89-1025"><a href="#cb89-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA4_lmer_fixedeffects.svg"), height = 8, width = 8)</span></span>
<span id="cb89-1026"><a href="#cb89-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-1027"><a href="#cb89-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1030"><a href="#cb89-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-1031"><a href="#cb89-1031" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of random effects:</span></span>
<span id="cb89-1032"><a href="#cb89-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(md4, </span>
<span id="cb89-1033"><a href="#cb89-1033" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"re"</span>, <span class="co"># Option to visualise random effects</span></span>
<span id="cb89-1034"><a href="#cb89-1034" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values=</span><span class="cn">TRUE</span>, </span>
<span id="cb89-1035"><a href="#cb89-1035" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.p=</span><span class="cn">TRUE</span>,</span>
<span id="cb89-1036"><a href="#cb89-1036" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.offset =</span> .<span class="dv">4</span>,</span>
<span id="cb89-1037"><a href="#cb89-1037" aria-hidden="true" tabindex="-1"></a>           <span class="at">value.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb89-1038"><a href="#cb89-1038" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"bw"</span>,</span>
<span id="cb89-1039"><a href="#cb89-1039" aria-hidden="true" tabindex="-1"></a>           <span class="at">wrap.labels =</span> <span class="dv">40</span>,</span>
<span id="cb89-1040"><a href="#cb89-1040" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="st">"PC4 estimated coefficients"</span>) <span class="sc">+</span></span>
<span id="cb89-1041"><a href="#cb89-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_sjplot2</span>()</span>
<span id="cb89-1042"><a href="#cb89-1042" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "TxB_PCA4_lmer_randomeffects.svg"), height = 3, width = 8)</span></span>
<span id="cb89-1043"><a href="#cb89-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-1044"><a href="#cb89-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1047"><a href="#cb89-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-1048"><a href="#cb89-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb89-1049"><a href="#cb89-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1050"><a href="#cb89-1050" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(here("plots", "TxB_predicted_PC4_scores_interactions.svg"), height = 5, width = 8)</span></span>
<span id="cb89-1051"><a href="#cb89-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(md4, <span class="at">xvar =</span> <span class="st">"Level"</span>, <span class="at">by=</span><span class="st">"Register"</span>, <span class="at">type =</span> <span class="st">"conditional"</span>,</span>
<span id="cb89-1052"><a href="#cb89-1052" aria-hidden="true" tabindex="-1"></a>       <span class="at">line=</span><span class="fu">list</span>(<span class="at">col=</span><span class="st">"darkred"</span>), </span>
<span id="cb89-1053"><a href="#cb89-1053" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Textbook Level"</span>, <span class="at">ylab =</span> <span class="st">"PC4"</span></span>
<span id="cb89-1054"><a href="#cb89-1054" aria-hidden="true" tabindex="-1"></a>       <span class="co">#,gg = TRUE</span></span>
<span id="cb89-1055"><a href="#cb89-1055" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">layout=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb89-1056"><a href="#cb89-1056" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-1057"><a href="#cb89-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb89-1058"><a href="#cb89-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1059"><a href="#cb89-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-1060"><a href="#cb89-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1061"><a href="#cb89-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">### Testing model assumptions</span></span>
<span id="cb89-1062"><a href="#cb89-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1063"><a href="#cb89-1063" aria-hidden="true" tabindex="-1"></a>This chunk can be used to check the assumptions of all of the models computed above. In the following example, we examine the final model selected to predict Dim2 scores.</span>
<span id="cb89-1064"><a href="#cb89-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1065"><a href="#cb89-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lmer-diagnostics}</span></span>
<span id="cb89-1066"><a href="#cb89-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1067"><a href="#cb89-1067" aria-hidden="true" tabindex="-1"></a><span class="in">model2test &lt;- md2</span></span>
<span id="cb89-1068"><a href="#cb89-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1069"><a href="#cb89-1069" aria-hidden="true" tabindex="-1"></a><span class="in"># check distribution of residuals</span></span>
<span id="cb89-1070"><a href="#cb89-1070" aria-hidden="true" tabindex="-1"></a><span class="in">plot(model2test)</span></span>
<span id="cb89-1071"><a href="#cb89-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1072"><a href="#cb89-1072" aria-hidden="true" tabindex="-1"></a><span class="in"># scale-location plot</span></span>
<span id="cb89-1073"><a href="#cb89-1073" aria-hidden="true" tabindex="-1"></a><span class="in">plot(model2test,</span></span>
<span id="cb89-1074"><a href="#cb89-1074" aria-hidden="true" tabindex="-1"></a><span class="in">     sqrt(abs(resid(.)))~fitted(.),</span></span>
<span id="cb89-1075"><a href="#cb89-1075" aria-hidden="true" tabindex="-1"></a><span class="in">     type=c("p","smooth"), col.line=1)</span></span>
<span id="cb89-1076"><a href="#cb89-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1077"><a href="#cb89-1077" aria-hidden="true" tabindex="-1"></a><span class="in"># Q-Q plot</span></span>
<span id="cb89-1078"><a href="#cb89-1078" aria-hidden="true" tabindex="-1"></a><span class="in">lattice::qqmath(model2test)</span></span>
<span id="cb89-1079"><a href="#cb89-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1080"><a href="#cb89-1080" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-1081"><a href="#cb89-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1082"><a href="#cb89-1082" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages used in this script</span></span>
<span id="cb89-1083"><a href="#cb89-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1084"><a href="#cb89-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package names and versions</span></span>
<span id="cb89-1085"><a href="#cb89-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1086"><a href="#cb89-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```{r package-versions, echo=FALSE}</span></span>
<span id="cb89-1087"><a href="#cb89-1087" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb89-1088"><a href="#cb89-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-1089"><a href="#cb89-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1090"><a href="#cb89-1090" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package references</span></span>
<span id="cb89-1091"><a href="#cb89-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1092"><a href="#cb89-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generateBibliography, results="asis", echo=FALSE}</span></span>
<span id="cb89-1093"><a href="#cb89-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1094"><a href="#cb89-1094" aria-hidden="true" tabindex="-1"></a><span class="in">#AppendixF_packages.bib &lt;- sapply(1:length(loadedNamespaces()), function(i) toBibtex(citation(loadedNamespaces()[i])))</span></span>
<span id="cb89-1095"><a href="#cb89-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1096"><a href="#cb89-1096" aria-hidden="true" tabindex="-1"></a><span class="in">#knitr::write_bib(c(.packages(), "knitr"), "AppendixF_packages.bib")</span></span>
<span id="cb89-1097"><a href="#cb89-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-1098"><a href="#cb89-1098" aria-hidden="true" tabindex="-1"></a><span class="in">require("knitcitations")</span></span>
<span id="cb89-1099"><a href="#cb89-1099" aria-hidden="true" tabindex="-1"></a><span class="in">cleanbib()</span></span>
<span id="cb89-1100"><a href="#cb89-1100" aria-hidden="true" tabindex="-1"></a><span class="in">options("citation_format" = "pandoc")</span></span>
<span id="cb89-1101"><a href="#cb89-1101" aria-hidden="true" tabindex="-1"></a><span class="in">read.bibtex(file = "AppendixF_packages.bib")</span></span>
<span id="cb89-1102"><a href="#cb89-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.elenlefoll.eu">Elen Le Foll</a></p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://benjamins.com/catalog/scl">Textbook English</a></p>
</div>
    <div class="nav-footer-right">
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a></p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"selector":".lightbox","closeEffect":"zoom","openEffect":"zoom","descPosition":"bottom","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>