<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Elen Le Foll">
<title>Textbook English: A Multi-Dimensional Approach - Appendix F: Data Preparation for the Model of Textbook English vs. ‘real-world’ English</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./Ch6_Analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch7_DataPrep.html">Appendix F: Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Textbook English: A Multi-Dimensional Approach</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/elenlefoll/TextbookMDA/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Textbook-English--A-Multi-Dimensional-Approach.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4_OpenScience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Open Science statement</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3_LitReview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix A: Literature review</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4_CorpusData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix B: Corpus data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6_DataPrep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix D: Data Preparation for the Model of Intra-Textbook Variation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix E: Data Analysis for the Model of Intra-Textbook Variation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch7_DataPrep.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Appendix F: Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#packages-required" id="toc-packages-required" class="nav-link active" data-scroll-target="#packages-required">Packages required</a></li>
  <li>
<a href="#data-import-from-mfte-outputs" id="toc-data-import-from-mfte-outputs" class="nav-link" data-scroll-target="#data-import-from-mfte-outputs">Data import from MFTE outputs</a>
  <ul class="collapse">
<li><a href="#spoken-bnc2014" id="toc-spoken-bnc2014" class="nav-link" data-scroll-target="#spoken-bnc2014">Spoken BNC2014</a></li>
  <li><a href="#youth-fiction-corpus" id="toc-youth-fiction-corpus" class="nav-link" data-scroll-target="#youth-fiction-corpus">Youth Fiction corpus</a></li>
  <li><a href="#informative-texts-for-teens-infoteens-corpus" id="toc-informative-texts-for-teens-infoteens-corpus" class="nav-link" data-scroll-target="#informative-texts-for-teens-infoteens-corpus">Informative Texts for Teens (InfoTeens) corpus</a></li>
  </ul>
</li>
  <li>
<a href="#merging-tec-and-reference-corpora-data" id="toc-merging-tec-and-reference-corpora-data" class="nav-link" data-scroll-target="#merging-tec-and-reference-corpora-data">Merging TEC and reference corpora data</a>
  <ul class="collapse">
<li><a href="#corpus-size" id="toc-corpus-size" class="nav-link" data-scroll-target="#corpus-size">Corpus size</a></li>
  </ul>
</li>
  <li>
<a href="#data-preparation-for-pca" id="toc-data-preparation-for-pca" class="nav-link" data-scroll-target="#data-preparation-for-pca">Data preparation for PCA</a>
  <ul class="collapse">
<li><a href="#feature-distributions" id="toc-feature-distributions" class="nav-link" data-scroll-target="#feature-distributions">Feature distributions</a></li>
  <li><a href="#feature-removal" id="toc-feature-removal" class="nav-link" data-scroll-target="#feature-removal">Feature removal</a></li>
  <li><a href="#identifying-potential-outlier-texts" id="toc-identifying-potential-outlier-texts" class="nav-link" data-scroll-target="#identifying-potential-outlier-texts">Identifying potential outlier texts</a></li>
  <li><a href="#signed-log-transformation" id="toc-signed-log-transformation" class="nav-link" data-scroll-target="#signed-log-transformation">Signed log transformation</a></li>
  <li><a href="#merging-of-data-for-mda" id="toc-merging-of-data-for-mda" class="nav-link" data-scroll-target="#merging-of-data-for-mda">Merging of data for MDA</a></li>
  </ul>
</li>
  <li>
<a href="#testing-factorability-of-data" id="toc-testing-factorability-of-data" class="nav-link" data-scroll-target="#testing-factorability-of-data">Testing factorability of data</a>
  <ul class="collapse">
<li><a href="#visualisation-of-feature-correlations" id="toc-visualisation-of-feature-correlations" class="nav-link" data-scroll-target="#visualisation-of-feature-correlations">Visualisation of feature correlations</a></li>
  </ul>
</li>
  <li>
<a href="#checking-the-factorability-of-data" id="toc-checking-the-factorability-of-data" class="nav-link" data-scroll-target="#checking-the-factorability-of-data">Checking the factorability of data</a>
  <ul class="collapse">
<li><a href="#collinearity" id="toc-collinearity" class="nav-link" data-scroll-target="#collinearity">Collinearity</a></li>
  <li><a href="#msa" id="toc-msa" class="nav-link" data-scroll-target="#msa">MSA</a></li>
  <li><a href="#scree-plot" id="toc-scree-plot" class="nav-link" data-scroll-target="#scree-plot">Scree plot</a></li>
  <li><a href="#communalities" id="toc-communalities" class="nav-link" data-scroll-target="#communalities">Communalities</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Appendix F: Data Preparation for the Model of Textbook English vs.&nbsp;‘real-world’ English</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>This script documents the steps taken to pre-process the data extracted from the Textbook English Corpus (TEC) and the three reference corpora that were ultimately entered in the comparative multi-dimensional model of Textbook English as compared to English outside the EFL classroom (Chapter 7).</p>
<section id="packages-required" class="level2"><h2 class="anchored" data-anchor-id="packages-required">Packages required</h2>
<p>The following packages must be installed and loaded to process the data.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original thesis.</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed">broom.mixed</a></span><span class="op">)</span> <span class="co"># For checking singularity issues </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span> <span class="co"># For recoding data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span> <span class="co"># For the feature correlation matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span> <span class="co"># For nice plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span> <span class="co"># Comparing group means of predicted values</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span> <span class="co"># For ggpairs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span> <span class="co"># For making large faceted plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span> <span class="co"># For ease of sharing</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span> <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span> <span class="co"># For mixed effects modelling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span> <span class="co"># For various useful stats function, including KMO()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span> <span class="co"># For working with colours</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span> <span class="co"># For nice tabular display of regression models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># For data wrangling and plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbreheny.github.io/visreg">visreg</a></span><span class="op">)</span> <span class="co"># For nice visualisations of model results</span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R_rainclouds.R"</span><span class="op">)</span><span class="op">)</span> <span class="co"># For geom_flat_violin rainplots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Colours used in Register Studies paper and included in Open Access plots published on Zenodo:</span></span>
<span><span class="co">#colours &lt;- suf_palette(name = "london", n = 6, type = "continuous") # Very nice, similar to OrRd palette</span></span>
<span><span class="co">#scales::show_col(colours)</span></span>
<span><span class="co">#colours &lt;- colours[6:1] </span></span>
<span></span>
<span><span class="co"># Colour scheme used in PhD thesis:</span></span>
<span><span class="va">colours</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B921"</span>, <span class="st">"#A18A33"</span>,  <span class="st">"#722672"</span>, <span class="st">"#BD241E"</span>, <span class="st">"#15274D"</span>, <span class="st">"#D54E1E"</span><span class="op">)</span> </span>
<span><span class="co"># scales::show_col(colours)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="data-import-from-mfte-outputs" class="level2"><h2 class="anchored" data-anchor-id="data-import-from-mfte-outputs">Data import from MFTE outputs</h2>
<p>The raw data used in this script comes from the matrices of mixed normalised frequencies as output by the <a href="https://github.com/mshakirDr/MultiFeatureTaggerEnglish">MFTE Perl v. 3.1</a> <span class="citation" data-cites="lefoll2021">(<a href="references.html#ref-lefoll2021" role="doc-biblioref">Le Foll 2021a</a>)</span>.</p>
<section id="spoken-bnc2014" class="level3"><h3 class="anchored" data-anchor-id="spoken-bnc2014">Spoken BNC2014</h3>
<p>These normalised frequencies were computed on the basis of my own “John and Jill in Ivybridge” version of the Spoken BNC2014 with added full stops at speaker turns (see Appendix B for details).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SpokenBNC2014</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"MFTE"</span>, <span class="st">"SpokenBNC2014_3.1_normed_complex_counts.tsv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Series</span> <span class="op">&lt;-</span> <span class="st">"Spoken BNC2014"</span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Level</span> <span class="op">&lt;-</span> <span class="st">"Ref."</span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Country</span> <span class="op">&lt;-</span> <span class="st">"Spoken BNC2014"</span></span>
<span><span class="va">SpokenBNC2014</span><span class="op">$</span><span class="va">Register</span> <span class="op">&lt;-</span> <span class="st">"Spoken BNC2014"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="youth-fiction-corpus" class="level3"><h3 class="anchored" data-anchor-id="youth-fiction-corpus">Youth Fiction corpus</h3>
<p>These normalised frequencies were computed on the basis of the random samples of approximately 5,000 words of the books of the Youth Fiction corpus (for details of the works included in this corpus, see Appendix B).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">YouthFiction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"MFTE"</span>, <span class="st">"YF_sampled_500_3.1_normed_complex_counts.tsv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Series</span> <span class="op">&lt;-</span> <span class="st">"Youth Fiction"</span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Level</span> <span class="op">&lt;-</span> <span class="st">"Ref."</span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Country</span> <span class="op">&lt;-</span> <span class="st">"Youth Fiction"</span></span>
<span><span class="va">YouthFiction</span><span class="op">$</span><span class="va">Register</span> <span class="op">&lt;-</span> <span class="st">"Youth Fiction"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="informative-texts-for-teens-infoteens-corpus" class="level3"><h3 class="anchored" data-anchor-id="informative-texts-for-teens-infoteens-corpus">Informative Texts for Teens (InfoTeens) corpus</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">InfoTeen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"MFTE"</span>, <span class="st">"InfoTeen_3.1_normed_complex_counts.tsv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Removes three outlier files which should not have been included in the corpus as they contain exam papers only</span></span>
<span><span class="va">InfoTeen</span> <span class="op">&lt;-</span> <span class="va">InfoTeen</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Filename</span><span class="op">!=</span><span class="st">".DS_Store"</span> <span class="op">&amp;</span> <span class="va">Filename</span><span class="op">!=</span><span class="st">"Revision_World_GCSE_10529068_wjec-level-law-past-papers.txt"</span> <span class="op">&amp;</span> <span class="va">Filename</span><span class="op">!=</span><span class="st">"Revision_World_GCSE_10528474_wjec-level-history-past-papers.txt"</span> <span class="op">&amp;</span> <span class="va">Filename</span><span class="op">!=</span><span class="st">"Revision_World_GCSE_10528472_edexcel-level-history-past-papers.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Series</span> <span class="op">&lt;-</span> <span class="st">"Info Teens"</span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Level</span> <span class="op">&lt;-</span> <span class="st">"Ref."</span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Country</span> <span class="op">&lt;-</span> <span class="st">"Info Teens"</span></span>
<span><span class="va">InfoTeen</span><span class="op">$</span><span class="va">Register</span> <span class="op">&lt;-</span> <span class="st">"Info Teens"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Details of the composition of the Info Teens corpus can be found in Section 4.3.2.5 of the book. The version used in the present study comprises 1,411 texts.</p>
</section></section><section id="merging-tec-and-reference-corpora-data" class="level2"><h2 class="anchored" data-anchor-id="merging-tec-and-reference-corpora-data">Merging TEC and reference corpora data</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Conversation"   "Fiction"        "Info Teens"     "Informative"   
[5] "Spoken BNC2014" "Youth Fiction" </code></pre>
</div>
</div>
<section id="corpus-size" class="level3"><h3 class="anchored" data-anchor-id="corpus-size">Corpus size</h3>
<p>These tables provide some summary statistics about the texts/files whose normalised feature frequencies were entered in the model of Textbook English vs.&nbsp;real-life English.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ncounts</span><span class="op">$</span><span class="va">Subcorpus</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(Sub)corpus"</span>, <span class="st">"# texts"</span><span class="op">)</span>,</span>
<span>        format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">(Sub)corpus</th>
<th style="text-align: right;"># texts</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Textbook Conversation</td>
<td style="text-align: right;">593</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Fiction</td>
<td style="text-align: right;">285</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Info Teens Ref.</td>
<td style="text-align: right;">1,411</td>
</tr>
<tr class="even">
<td style="text-align: left;">Textbook Informative</td>
<td style="text-align: right;">364</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spoken BNC2014 Ref.</td>
<td style="text-align: right;">1,251</td>
</tr>
<tr class="even">
<td style="text-align: left;">Youth Fiction Ref.</td>
<td style="text-align: right;">1,191</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ncounts</span>  <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Register</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>totaltexts <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            totalwords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Words</span><span class="op">)</span>, </span>
<span>            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Words</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Words</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            TTRmean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">TTR</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, </span>
<span>        format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Register</th>
<th style="text-align: right;">totaltexts</th>
<th style="text-align: right;">totalwords</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">TTRmean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conversation</td>
<td style="text-align: right;">1,844</td>
<td style="text-align: right;">13,804,196</td>
<td style="text-align: right;">7,486</td>
<td style="text-align: right;">8,690</td>
<td style="text-align: right;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fiction</td>
<td style="text-align: right;">1,476</td>
<td style="text-align: right;">7,321,747</td>
<td style="text-align: right;">4,960</td>
<td style="text-align: right;">2,022</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informative</td>
<td style="text-align: right;">1,775</td>
<td style="text-align: right;">1,436,732</td>
<td style="text-align: right;">809</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">0.51</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="data-preparation-for-pca" class="level2"><h2 class="anchored" data-anchor-id="data-preparation-for-pca">Data preparation for PCA</h2>
<section id="feature-distributions" class="level3"><h3 class="anchored" data-anchor-id="feature-distributions">Feature distributions</h3>
<p>The distributions of each linguistic features were examined by means of visualisation. As shown below, before transformation, many of the features displayed highly skewed distributions.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ncounts &lt;- readRDS(here("data", "processed", "counts3Reg.rds"))</span></span>
<span></span>
<span><span class="va">ncounts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Words</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, colour<span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkred"</span>, weight <span class="op">=</span> <span class="fl">2</span>, fill<span class="op">=</span><span class="st">"darkred"</span>, alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Ch7_DataPrep_files/figure-html/distribution-viz-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "DensityPlotsAllVariables.svg"), width = 15, height = 49)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="feature-removal" class="level3"><h3 class="anchored" data-anchor-id="feature-removal">Feature removal</h3>
<p>A number of features were removed from the dataset as they are not linguistically interpretable. In the case of the TEC, this included the variable CD because numbers spelt out as digits were removed from the textbooks before these were tagged with the MFTE. In addition, the variables LIKE and SO because these are “bin” features included in the output of the MFTE to ensure that the counts for these polysemous words do not inflate other categories due to mistags <span class="citation" data-cites="lefoll2021a">(<a href="references.html#ref-lefoll2021a" role="doc-biblioref">Le Foll 2021b</a>)</span>.</p>
<p>Whenever linguistically meaningful, very low-frequency features, features with low MSA or communalities (see chunks below) were merged. Finally, features absent from more than third of texts were also excluded. For the comparative analysis of TEC and the reference corpora, the following linguistic features were excluded from the analysis due to low dispersion:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Removal of meaningless feature: CD because numbers as digits were mostly removed from the textbooks, LIKE and SO because they are dustbin categories</span></span>
<span><span class="va">ncounts</span> <span class="op">&lt;-</span> <span class="va">ncounts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">CD</span>, <span class="va">LIKE</span>, <span class="va">SO</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine problematic features into meaningful groups whenever this makes linguistic sense</span></span>
<span><span class="va">ncounts</span> <span class="op">&lt;-</span> <span class="va">ncounts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>JJPR <span class="op">=</span> <span class="va">JJPR</span> <span class="op">+</span> <span class="va">ABLE</span>, ABLE <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>PASS <span class="op">=</span> <span class="va">PGET</span> <span class="op">+</span> <span class="va">PASS</span>, PGET <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>TPP3 <span class="op">=</span> <span class="va">TPP3S</span> <span class="op">+</span> <span class="va">TPP3P</span>, TPP3P <span class="op">=</span> <span class="cn">NULL</span>, TPP3S <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Merged due to TTP3P having an individual MSA &lt; 0.5</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FQTI <span class="op">=</span> <span class="va">FREQ</span> <span class="op">+</span> <span class="va">TIME</span>, FREQ <span class="op">=</span> <span class="cn">NULL</span>, TIME <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># Merged due to TIME communality &lt; 0.2 (see below)</span></span>
<span></span>
<span><span class="co"># Function to compute percentage of texts with occurrences meeting a condition</span></span>
<span><span class="va">compute_percentage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">condition</span>, <span class="va">threshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">numeric_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Filter</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">condition</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">numeric_data</span>, <span class="va">is.numeric</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Percentage"</span></span>
<span>  <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="va">percentage</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Percentage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">Percentage</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">threshold</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">percentage</span> <span class="op">&lt;-</span> <span class="va">percentage</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Percentage</span> <span class="op">&gt;</span> <span class="va">threshold</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate percentage of texts with 0 occurrences of each feature</span></span>
<span><span class="va">zero_features</span> <span class="op">&lt;-</span> <span class="fu">compute_percentage</span><span class="op">(</span><span class="va">ncounts</span>, <span class="va">ncounts</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">66.6</span><span class="op">)</span></span>
<span><span class="va">zero_features</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Feature"</span>, <span class="st">"% texts with zero occurrences"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Feature</th>
<th style="text-align: right;">% texts with zero occurrences</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PRP</td>
<td style="text-align: right;">85.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">URL</td>
<td style="text-align: right;">93.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EMO</td>
<td style="text-align: right;">98.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">HST</td>
<td style="text-align: right;">99.55</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Drop variables with low document frequency</span></span>
<span><span class="va">ncounts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ncounts</span>, <span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html">one_of</a></span><span class="op">(</span><span class="va">zero_features</span><span class="op">$</span><span class="va">rowname</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These feature removal operations resulted in a feature set of 71 linguistic variables.</p>
</section><section id="identifying-potential-outlier-texts" class="level3"><h3 class="anchored" data-anchor-id="identifying-potential-outlier-texts">Identifying potential outlier texts</h3>
<p>All normalised frequencies were normalised to identify any potential outlier texts.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First scale the normalised counts (z-standardisation) to be able to compare the various features</span></span>
<span><span class="va">zcounts</span> <span class="op">&lt;-</span> <span class="va">ncounts2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Words</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If necessary, remove any outliers at this stage.</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ncounts2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">zcounts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outliers</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_any</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">Words</span>,  .fns <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">8</span><span class="op">}</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Filename</span>, <span class="va">Corpus</span>, <span class="va">Series</span>, <span class="va">Register</span>, <span class="va">Level</span>, <span class="va">Words</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following outlier texts were identified according to the above conditions and excluded in subsequent analyses.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># These are potential outlier texts :</span></span>
<span><span class="va">outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                                                                        Filename
1                                                                         POC_4e_Spoken_0007.txt
2                                                       Solutions_Elementary_ELF_Spoken_0013.txt
3                                                               EIM_Starter_Informative_0004.txt
4                                                                    GreenLine_1_Spoken_0003.txt
5                                                                       Access_1_Spoken_0011.txt
6                                                              Achievers_B1_Informative_0003.txt
7                                                                    EIM_Starter_Spoken_0002.txt
8                                                                    GreenLine_1_Spoken_0008.txt
9                                                                     JTT_3_Informative_0003.txt
10                                                                   GreenLine_1_Spoken_0010.txt
11                                                                         EIM_1_Spoken_0012.txt
12                                                                         NGL_1_Spoken_0013.txt
13                                                                         NGL_3_Spoken_0018.txt
14                                                        Solutions_Intermediate_Spoken_0029.txt
15                                                                         NGL_1_Spoken_0012.txt
16                                                                   GreenLine_1_Spoken_0006.txt
17                                                                   GreenLine_2_Spoken_0004.txt
18                                                                      Access_2_Spoken_0023.txt
19                                                                     HT_4_Informative_0006.txt
20                                                   Solutions_Intermediate_Informative_0017.txt
21                                                                         EIM_1_Spoken_0013.txt
22                                                      Solutions_Elementary_ELF_Spoken_0021.txt
23                                                   Solutions_Intermediate_Plus_Spoken_0022.txt
24                                                                      Access_2_Spoken_0028.txt
25                                                                         NGL_1_Spoken_0005.txt
26                                                      Solutions_Elementary_ELF_Spoken_0016.txt
27                                                Solutions_Pre-Intermediate_ELF_Spoken_0007.txt
28                                                   Solutions_Intermediate_Informative_0013.txt
29                                                                   GreenLine_2_Spoken_0003.txt
30                                                                          HT_4_Spoken_0010.txt
31                                                     Solutions_Elementary_Informative_0003.txt
32                                                                 Access_2_Informative_0001.txt
33                                                     Solutions_Elementary_Informative_0010.txt
34                                                              GreenLine_1_Informative_0001.txt
35                                                                      Access_2_Spoken_0002.txt
36                                                        Solutions_Intermediate_Spoken_0019.txt
37                                                                 Access_3_Informative_0003.txt
38                                                                      Access_1_Spoken_0019.txt
39                                                                      Access_2_Spoken_0013.txt
40                                              Solutions_Intermediate_Plus_Informative_0014.txt
41                                               Revision_World_GCSE_10525362_literary-terms.txt
42                             Revision_World_GCSE_10528697_p6-physics-radioactive-materials.txt
43                                                       Science_Tech_Kinds_NZ_10382383_math.txt
44                                   Science_for_students_10064820_scientists-say-metabolism.txt
45                                                  Science_Tech_Kinds_NZ_10382388_recycling.txt
46                                                     History_Kids_BBC_10404337_go_furthers.txt
47                                                     Science_Tech_Kinds_NZ_10382391_sports.txt
48                                    Teen_Kids_News_10402607_so-you-want-to-be-an-archivist.txt
49                                                    Science_Tech_Kinds_NZ_10382234_biology.txt
50                                                  Science_Tech_Kinds_NZ_10382372_astronomy.txt
51    Dogo_News_file10060404_banana-plant-extract-may-be-the-key-to-slower-melting-ice-cream.txt
52                                                  Science_Tech_Kinds_NZ_10382667_countries.txt
53                                    Quatr_us_file10390777_quick-summary-geological-erashtm.txt
54                                                    Science_Tech_Kinds_NZ_10382873_physics.txt
55                                                      Science_Tech_Kinds_NZ_10382382_light.txt
56                                                            Factmonster_10053687_august-13.txt
57                                            Revision_World_GCSE_10526703_limited-companies.txt
58                                            Revision_World_GCSE_10529637_transition-metals.txt
59                                                Quatr_us_10390856_early-african-historyhtm.txt
60                                             History_Kids_BBC_10401873_ff6_sicilylandingss.txt
61                                                                Quatr_us_10394250_harappan.txt
62                                                                Ducksters_10398301_iraqphp.txt
63                                       History_Kids_BBC_10403171_death_sakkara_gallery_04s.txt
64                                          Revision_World_GCSE_10528246_agricultural-change.txt
65                                      Revision_World_GCSE_10528086_uk-government-judiciary.txt
66                                                  Revision_World_GCSE_10529794_definitions.txt
67                                   Encyclopedia_Kinds_au_10085347_Nobel_Prize_in_Chemistry.txt
68       Science_for_students_10064875_questions-big-melt-earths-ice-sheets-are-under-attack.txt
69                       Teen_Kids_News_10403301_golden-globe-winners-2019-the-complete-list.txt
70                                                   Science_Tech_Kinds_NZ_10382201_projects.txt
71                                                  Revision_World_GCSE_10529753_probability.txt
72                                           Encyclopedia_Kinds_au_10085531_Complex_analysis.txt
73                                                       History_Kids_BBC_10401890_ff7_ddays.txt
74                                                                History_Kids_BBC_10403434s.txt
75                                                      History_Kids_BBC_10401872_ff6_italys.txt
76                                                    Science_Tech_Kinds_NZ_10382371_amazing.txt
77                                                              Quatr_us_10391129_athabascan.txt
78                                               Encyclopedia_Kinds_au_10085355_20th_century.txt
79  Dogo_News_10060755_luxury-space-hotel-promises-guests-a-truly-out-of-this-world-vacation.txt
80                                         Revision_World_GCSE_10528072_nationalism-practice.txt
81                                              Quatr_us_10390861_quatr-us-privacy-policyhtm.txt
82                                                      History_Kids_BBC_10401909_ff7_bulges.txt
83                                             History_kids_10381259_timeline-of-mesopotamia.txt
84                    Revision_World_GCSE_10528123_gender-written-textual-analysis-framework.txt
85                                                     Science_Tech_Kinds_NZ_10386406_floods.txt
86                                                   Revision_World_GCSE_10529693_advantages.txt
87                                                  Science_Tech_Kinds_NZ_10382378_geography.txt
88                                                      Science_Tech_Kinds_NZ_10382374_earth.txt
89                 Science_for_students_10066286_watering-plants-wastewater-can-spread-germs.txt
90                                                      Science_Tech_Kinds_NZ_10382393_water.txt
91                                                     World_Dteen_10406069_website_policies.txt
92                                                     Science_Tech_Kinds_NZ_10382384_metals.txt
93    Dogo_News_10062028_puppy-bowl-14-promises-viewers-a-paw-some-time-on-super-bowl-sunday.txt
94                                                     History_Kids_BBC_10404730_go_furthers.txt
95                                                     Science_Tech_Kinds_NZ_10382385_nature.txt
96                               Science_for_students_10065015_scientists-say-dna-sequencing.txt
97                                  Quatr_us_file10390817_conifers-pine-trees-gymnospermshtm.txt
98                                         TweenTribute_10051509_it-true-elephants-cant-jump.txt
99                                         Revision_World_GCSE_10528494_application-software.txt
100                      Revision_World_GCSE_10529581_different-types-questions-examinations.txt
101        Dogo_News_10061669_the-chinese-city-of-chengdu-may-soon-be-home-to-multiple-moons.txt
102                                         Ducksters_10398306_geography_of_ancient_chinaphp.txt
103                                  Science_for_students_10065144_scientists-say-multiverse.txt
104                                                    Science_Tech_Kinds_NZ_10382211_images.txt
105                                                              Factmonster_10053754_may-18.txt
106                                                      World_Dteen_10406047_AboutWORLDteen.txt
107                                                     Ducksters_10398078_first_new_dealphp.txt
108                                             Revision_World_GCSE_10526926_economies-scale.txt
109                                                        Factmonster_10053201_september-03.txt
110                                         Science_Tech_Kinds_NZ_10387183_calciumcarbonates.txt
111                                                    Science_Tech_Kinds_NZ_10382380_health.txt
112                                             Revision_World_GCSE_10529587_sources-finance.txt
113                                                                Quatr_us_10393444_fishing.txt
114                                                 Ducksters_10398315_glossary_and_termsphp.txt
115                                                                                     S5AA.txt
               Corpus         Series     Register Level Words
1    Textbook.English            POC Conversation     C   750
2    Textbook.English      Solutions Conversation     A   931
3    Textbook.English            EIM  Informative     A   534
4    Textbook.English      GreenLine Conversation     A   970
5    Textbook.English         Access Conversation     A   784
6    Textbook.English      Achievers  Informative     C   926
7    Textbook.English            EIM Conversation     A   824
8    Textbook.English      GreenLine Conversation     A   876
9    Textbook.English            JTT  Informative     D   699
10   Textbook.English      GreenLine Conversation     A   701
11   Textbook.English            EIM Conversation     B   640
12   Textbook.English            NGL Conversation     A   940
13   Textbook.English            NGL Conversation     C   751
14   Textbook.English      Solutions Conversation     C   672
15   Textbook.English            NGL Conversation     A   910
16   Textbook.English      GreenLine Conversation     A   622
17   Textbook.English      GreenLine Conversation     B  1102
18   Textbook.English         Access Conversation     B   875
19   Textbook.English             HT  Informative     C   513
20   Textbook.English      Solutions  Informative     C   816
21   Textbook.English            EIM Conversation     B   967
22   Textbook.English      Solutions Conversation     A   846
23   Textbook.English      Solutions Conversation     D   596
24   Textbook.English         Access Conversation     B   813
25   Textbook.English            NGL Conversation     A  1020
26   Textbook.English      Solutions Conversation     A   871
27   Textbook.English      Solutions Conversation     B   630
28   Textbook.English      Solutions  Informative     C   770
29   Textbook.English      GreenLine Conversation     B   850
30   Textbook.English             HT Conversation     C   727
31   Textbook.English      Solutions  Informative     A  1051
32   Textbook.English         Access  Informative     B   655
33   Textbook.English      Solutions  Informative     A   708
34   Textbook.English      GreenLine  Informative     A   731
35   Textbook.English         Access Conversation     B   572
36   Textbook.English      Solutions Conversation     C  1024
37   Textbook.English         Access  Informative     C  1000
38   Textbook.English         Access Conversation     A   701
39   Textbook.English         Access Conversation     B   981
40   Textbook.English      Solutions  Informative     D   537
41  Informative.Teens     Info Teens  Informative  Ref.   790
42  Informative.Teens     Info Teens  Informative  Ref.  1015
43  Informative.Teens     Info Teens  Informative  Ref.   522
44  Informative.Teens     Info Teens  Informative  Ref.   895
45  Informative.Teens     Info Teens  Informative  Ref.   666
46  Informative.Teens     Info Teens  Informative  Ref.   620
47  Informative.Teens     Info Teens  Informative  Ref.   657
48  Informative.Teens     Info Teens  Informative  Ref.   763
49  Informative.Teens     Info Teens  Informative  Ref.   843
50  Informative.Teens     Info Teens  Informative  Ref.   900
51  Informative.Teens     Info Teens  Informative  Ref.   611
52  Informative.Teens     Info Teens  Informative  Ref.   717
53  Informative.Teens     Info Teens  Informative  Ref.   643
54  Informative.Teens     Info Teens  Informative  Ref.   722
55  Informative.Teens     Info Teens  Informative  Ref.   639
56  Informative.Teens     Info Teens  Informative  Ref.   523
57  Informative.Teens     Info Teens  Informative  Ref.   714
58  Informative.Teens     Info Teens  Informative  Ref.   787
59  Informative.Teens     Info Teens  Informative  Ref.  1136
60  Informative.Teens     Info Teens  Informative  Ref.   813
61  Informative.Teens     Info Teens  Informative  Ref.   651
62  Informative.Teens     Info Teens  Informative  Ref.   657
63  Informative.Teens     Info Teens  Informative  Ref.   844
64  Informative.Teens     Info Teens  Informative  Ref.   789
65  Informative.Teens     Info Teens  Informative  Ref.  1019
66  Informative.Teens     Info Teens  Informative  Ref.   904
67  Informative.Teens     Info Teens  Informative  Ref.   598
68  Informative.Teens     Info Teens  Informative  Ref.   685
69  Informative.Teens     Info Teens  Informative  Ref.   800
70  Informative.Teens     Info Teens  Informative  Ref.   947
71  Informative.Teens     Info Teens  Informative  Ref.   816
72  Informative.Teens     Info Teens  Informative  Ref.   735
73  Informative.Teens     Info Teens  Informative  Ref.   759
74  Informative.Teens     Info Teens  Informative  Ref.   732
75  Informative.Teens     Info Teens  Informative  Ref.   786
76  Informative.Teens     Info Teens  Informative  Ref.   629
77  Informative.Teens     Info Teens  Informative  Ref.   637
78  Informative.Teens     Info Teens  Informative  Ref.   864
79  Informative.Teens     Info Teens  Informative  Ref.   722
80  Informative.Teens     Info Teens  Informative  Ref.   776
81  Informative.Teens     Info Teens  Informative  Ref.   960
82  Informative.Teens     Info Teens  Informative  Ref.   732
83  Informative.Teens     Info Teens  Informative  Ref.   768
84  Informative.Teens     Info Teens  Informative  Ref.   905
85  Informative.Teens     Info Teens  Informative  Ref.   580
86  Informative.Teens     Info Teens  Informative  Ref.   782
87  Informative.Teens     Info Teens  Informative  Ref.   761
88  Informative.Teens     Info Teens  Informative  Ref.   726
89  Informative.Teens     Info Teens  Informative  Ref.   836
90  Informative.Teens     Info Teens  Informative  Ref.   856
91  Informative.Teens     Info Teens  Informative  Ref.   995
92  Informative.Teens     Info Teens  Informative  Ref.   669
93  Informative.Teens     Info Teens  Informative  Ref.   581
94  Informative.Teens     Info Teens  Informative  Ref.   611
95  Informative.Teens     Info Teens  Informative  Ref.   722
96  Informative.Teens     Info Teens  Informative  Ref.   953
97  Informative.Teens     Info Teens  Informative  Ref.   533
98  Informative.Teens     Info Teens  Informative  Ref.   790
99  Informative.Teens     Info Teens  Informative  Ref.   855
100 Informative.Teens     Info Teens  Informative  Ref.   742
101 Informative.Teens     Info Teens  Informative  Ref.   614
102 Informative.Teens     Info Teens  Informative  Ref.   638
103 Informative.Teens     Info Teens  Informative  Ref.   712
104 Informative.Teens     Info Teens  Informative  Ref.   793
105 Informative.Teens     Info Teens  Informative  Ref.   497
106 Informative.Teens     Info Teens  Informative  Ref.  1053
107 Informative.Teens     Info Teens  Informative  Ref.   649
108 Informative.Teens     Info Teens  Informative  Ref.   621
109 Informative.Teens     Info Teens  Informative  Ref.   445
110 Informative.Teens     Info Teens  Informative  Ref.   804
111 Informative.Teens     Info Teens  Informative  Ref.   694
112 Informative.Teens     Info Teens  Informative  Ref.   665
113 Informative.Teens     Info Teens  Informative  Ref.   656
114 Informative.Teens     Info Teens  Informative  Ref.   684
115    Spoken.BNC2014 Spoken BNC2014 Conversation  Ref.  1869</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Checking that outlier texts are not particularly long or short texts</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outliers</span><span class="op">$</span><span class="va">Words</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  445.0   655.5   751.0   773.6   860.0  1869.0 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">outliers</span><span class="op">$</span><span class="va">Words</span>, breaks <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Ch7_DataPrep_files/figure-html/list-outliers-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Distribution of outlier texts across the four corpora</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outliers</span><span class="op">$</span><span class="va">Corpus</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Textbook.English Informative.Teens    Spoken.BNC2014     Youth.Fiction 
               40                74                 1                 0 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Report on the manual check of a sample of these outliers:</span></span>
<span></span>
<span><span class="co"># Encyclopedia_Kinds_au_10085347_Nobel_Prize_in_Chemistry.txt is essentially a list of Nobel prize winners but with some additional information. In other words, not a bad representative of the type of texts of the Info Teen corpus.</span></span>
<span><span class="co"># Solutions_Elementary_ELF_Spoken_0013 --&gt; Has a lot of "going to" constructions because they are learnt in this chapter but is otherwise a well-formed text.</span></span>
<span><span class="co"># Teen_Kids_News_10403972_a-brief-history-of-white-house-weddings --&gt; No issues</span></span>
<span><span class="co"># Teen_Kids_News_10403301_golden-globe-winners-2019-the-complete-list --&gt; Similar to the Nobel prize laureates text.</span></span>
<span><span class="co"># Revision_World_GCSE_10528123_gender-written-textual-analysis-framework --&gt; Text includes bullet points tokenised as the letter "o" but otherwise a fairly typical informative text.</span></span>
<span></span>
<span><span class="co"># Removing the outliers at the request of the reviewers (but comparisons of models including the outliers showed that the results are very similar):</span></span>
<span><span class="va">ncounts3</span> <span class="op">&lt;-</span> <span class="va">ncounts2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">Filename</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">outliers</span><span class="op">$</span><span class="va">Filename</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#saveRDS(ncounts3, here("data", "processed", "ncounts3_3Reg.rds")) # Last saved 6 March 2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This resulted in 4,980 texts/files being included in the comparative model of Textbook English vs.&nbsp;‘real-life’ English. These standardised feature frequencies were distributed as follows:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">zcounts3</span> <span class="op">&lt;-</span> <span class="va">ncounts3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Words</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">zcounts3</span>, las <span class="op">=</span> <span class="fl">3</span>, main <span class="op">=</span> <span class="st">"z-scores"</span><span class="op">)</span> <span class="co"># Slow</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Ch7_DataPrep_files/figure-html/z-transformed-distributions-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="signed-log-transformation" class="level3"><h3 class="anchored" data-anchor-id="signed-log-transformation">Signed log transformation</h3>
<p>A signed logarithmic transformation was applied to (further) deskew the feature distributions <span class="citation" data-cites="diwersy2014 neumann2021">(<a href="references.html#ref-diwersy2014" role="doc-biblioref">Diwersy, Evert, and Neumann 2014</a>; <a href="references.html#ref-neumann2021" role="doc-biblioref">Neumann and Evert 2021</a>)</span>.</p>
<p>The signed log transformation function was inspired by the SignedLog function proposed in https://cran.r-project.org/web/packages/DataVisualizations/DataVisualizations.pdf</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">signed.log</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">zlogcounts</span> <span class="op">&lt;-</span> <span class="fu">signed.log</span><span class="op">(</span><span class="va">zcounts3</span><span class="op">)</span> <span class="co"># Standardise first, then sign log transform</span></span>
<span></span>
<span><span class="co">#saveRDS(zlogcounts, here("data", "processed", "zlogcounts_3Reg.rds")) # Last saved 16 March 2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The new feature distributions are visualised below.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">zlogcounts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, colour<span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkred"</span>, weight <span class="op">=</span> <span class="fl">2</span>, fill<span class="op">=</span><span class="st">"darkred"</span>, alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Ch7_DataPrep_files/figure-html/signed.log.transformation-distributions-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ggsave(here("plots", "DensityPlotsAllVariablesSignedLog.svg"), width = 15, height = 49)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="merging-of-data-for-mda" class="level3"><h3 class="anchored" data-anchor-id="merging-of-data-for-mda">Merging of data for MDA</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">zlogcounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"zlogcounts_3Reg.rds"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#nrow(zlogcounts)</span></span>
<span><span class="co">#colnames(zlogcounts)</span></span>
<span></span>
<span><span class="va">ncounts3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"ncounts3_3Reg.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#nrow(ncounts3)</span></span>
<span><span class="co">#colnames(ncounts3)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ncounts3</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">zlogcounts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#saveRDS(data, here("data", "processed", "datazlogcounts_3Reg.rds")) # Last saved 16 March 2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The final dataset comprises of 4,980 texts/files, divided as follows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Textbook Conversation      Textbook Fiction       Info Teens Ref. 
                  565                   285                  1337 
 Textbook Informative   Spoken BNC2014 Ref.    Youth Fiction Ref. 
                  352                  1250                  1191 </code></pre>
</div>
</div>
</section></section><section id="testing-factorability-of-data" class="level2"><h2 class="anchored" data-anchor-id="testing-factorability-of-data">Testing factorability of data</h2>
<section id="visualisation-of-feature-correlations" class="level3"><h3 class="anchored" data-anchor-id="visualisation-of-feature-correlations">Visualisation of feature correlations</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simple heatmap in base R (inspired by Stephanie Evert's SIGIL code)</span></span>
<span><span class="va">cor.colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/hsv.html">hsv</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, v<span class="op">=</span><span class="fl">1</span>, s<span class="op">=</span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, <span class="co"># blue = negative correlation </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="co"># white = no correlation </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/hsv.html">hsv</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">1</span>, s<span class="op">=</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># red = positive correlation</span></span>
<span></span>
<span><span class="co">#png(here("plots", "heatmapzlogcounts.png"), width = 30, height= 30, units = "cm", res = 300)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">zlogcounts</span><span class="op">)</span>, </span>
<span>        symm<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>        col<span class="op">=</span><span class="va">cor.colours</span>, </span>
<span>        margins<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Ch7_DataPrep_files/figure-html/heatmap-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="checking-the-factorability-of-data" class="level2"><h2 class="anchored" data-anchor-id="checking-the-factorability-of-data">Checking the factorability of data</h2>
<section id="collinearity" class="level3"><h3 class="anchored" data-anchor-id="collinearity">Collinearity</h3>
<p>As a result of the normalisation unit of finite verb phrases for verb-based features, the present tense (VPRT) and past tense (VBD) variables are highly correlated:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">VPRT</span>, <span class="va">data</span><span class="op">$</span><span class="va">VBD</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9731048</code></pre>
</div>
</div>
<p>We therefore remove the least marked of the pair of collinear variables: VPRT.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">VPRT</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="msa" class="level3"><h3 class="anchored" data-anchor-id="msa">MSA</h3>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/KMO.html">KMO</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The overall MSA value of the dataset is 0.95. The features have the following individual MSA values (ordered from lowest to largest):</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmo</span><span class="op">$</span><span class="va">MSAi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">kmo</span><span class="op">$</span><span class="va">MSAi</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   AMP   COMM    POS   TPP3   JJPR  PLACE  SPLIT     DT   JJAT   VIMP   MDCO 
  0.67   0.69   0.70   0.74   0.76   0.82   0.83   0.83   0.84   0.84   0.85 
    RP     EX   THSC     LD  NCOMP   BEMA   MDWS   FQTI  FPP1P   MDCA    ACT 
  0.85   0.85   0.86   0.87   0.88   0.88   0.89   0.89   0.89   0.89   0.89 
MENTAL    VBD  FPP1S   MDMM   PEAS   CONC   MDWO   THRC     NN   COND   PROG 
  0.91   0.91   0.91   0.91   0.91   0.93   0.93   0.94   0.94   0.95   0.95 
    CC   SPP2     RB   DWNT   MDNE   WHSC   CONT   QUPR    XX0  CAUSE   WHQU 
  0.95   0.95   0.95   0.95   0.95   0.96   0.96   0.96   0.96   0.96   0.96 
   VBG    AWL POLITE   PASS    PIT  DOAUX   ELAB ASPECT    DMA   DEMO    HDG 
  0.96   0.96   0.96   0.96   0.97   0.97   0.97   0.97   0.97   0.97   0.97 
    IN   FPUH  OCCUR    CUZ   EMPH   YNQU   QUAN    TTR  QUTAG  THATD    VBN 
  0.97   0.97   0.97   0.97   0.98   0.98   0.98   0.98   0.98   0.98   0.98 
 EXIST   STPR    GTO   HGOT 
  0.98   0.99   0.99   0.99 </code></pre>
</div>
</div>
<p>We aim to remove features with an individual MSA &lt; 0.5. All features have individual MSAs of &gt; 0.5 (but only because TPP3P was merged into a larger category earlier on).</p>
</section><section id="scree-plot" class="level3"><h3 class="anchored" data-anchor-id="scree-plot">Scree plot</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># png(here("plots", "screeplot-TEC-Ref_3Reg.png"), width = 20, height= 12, units = "cm", res = 300)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/VSS.scree.html">scree</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, factors <span class="op">=</span> <span class="cn">FALSE</span>, pc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># 6 components were originally retained on the basis of this screeplot (on the advice of an anonymous peer reviewer, only four were later retained).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Ch7_DataPrep_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dev.off()</span></span>
<span></span>
<span><span class="co"># Perform PCA</span></span>
<span><span class="va">pca1</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/principal.html">principal</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                         nfactors <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="communalities" class="level3"><h3 class="anchored" data-anchor-id="communalities">Communalities</h3>
<p>If features with final communalities of &lt; 0.2 are removed, we would remove TIME. TIME was therefore merged with FREQ in an earlier chunk so that now all features have final communalities of &gt; 0.2 (note: that this is a very generous threshold!).</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca1</span><span class="op">$</span><span class="va">communality</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  DWNT   STPR   CONC   FQTI    POS ASPECT   MDNE  FPP1P   PROG   MDCO   MDMM 
  0.22   0.23   0.23   0.23   0.24   0.25   0.27   0.28   0.29   0.32   0.32 
  MDWO  SPLIT   MDWS   PEAS   QUPR    AMP  PLACE    HDG   COMM  CAUSE     EX 
  0.32   0.33   0.34   0.35   0.35   0.35   0.37   0.38   0.38   0.38   0.38 
  THSC  OCCUR   WHSC   THRC   JJAT   COND MENTAL    ACT   VIMP   ELAB  EXIST 
  0.40   0.40   0.42   0.43   0.44   0.44   0.45   0.45   0.46   0.46   0.46 
  JJPR  NCOMP     RP    GTO   DEMO   MDCA POLITE    CUZ     CC   WHQU   TPP3 
  0.46   0.48   0.49   0.50   0.50   0.52   0.52   0.53   0.57   0.58   0.58 
   VBG  THATD    PIT   BEMA  FPP1S     DT   HGOT     RB    VBN  QUTAG   EMPH 
  0.60   0.60   0.61   0.61   0.61   0.61   0.62   0.62   0.64   0.64   0.64 
  PASS    XX0   QUAN   SPP2  DOAUX    TTR   YNQU    VBD     LD   FPUH     IN 
  0.65   0.65   0.67   0.68   0.69   0.71   0.74   0.78   0.81   0.83   0.86 
  CONT    DMA    AWL     NN 
  0.89   0.89   0.91   0.93 </code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#saveRDS(data, here("data", "processed", "dataforPCA.rds")) # Last saved on 6 March 2024</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The final dataset entered in the analysis described in Chapter 7 therefore comprises 4,980 texts/files, each with logged standardised normalised frequencies for 70 linguistic features.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-diwersy2014" class="csl-entry" role="listitem">
Diwersy, Sascha, Stephanie Evert, and Stella Neumann. 2014. <span>“A Weakly Supervised Multivariate Approach to the Study of Language Variation.”</span> In, edited by Benedikt Szmrecsanyi and Bernhard Wälchli, 174–204. Berlin: De Gruyter.
</div>
<div id="ref-lefoll2021" class="csl-entry" role="listitem">
Le Foll, Elen. 2021a. <em>Introducing the Multi-Feature Tagger of English (MFTE)</em>. Osnabrück University. <a href="https://github.com/elenlefoll/MultiFeatureTaggerEnglish">https://github.com/elenlefoll/MultiFeatureTaggerEnglish</a>.
</div>
<div id="ref-lefoll2021a" class="csl-entry" role="listitem">
———. 2021b. <em>Introducing the Multi-Feature Tagger of English (MFTE)</em>. Osnabrück University. <a href="https://github.com/elenlefoll/MultiFeatureTaggerEnglish">https://github.com/elenlefoll/MultiFeatureTaggerEnglish</a>.
</div>
<div id="ref-neumann2021" class="csl-entry" role="listitem">
Neumann, Stella, and Stephanie Evert. 2021. <span>“A Register Variation Perspective on Varieties of English.”</span> In, edited by Elena Seoane and Douglas Biber, 144178. Studies in Corpus Linguistics 103. Amsterdam: Benjamins.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/elenlefoll\.github\.io\/TextbookMDA\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./Ch6_Analysis.html" class="pagination-link  aria-label=" appendix="" e:="" data="" analysis="" for="" the="" model="" of="" intra-textbook="" variation="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Appendix E: Data Analysis for the Model of Intra-Textbook Variation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="<span class='chapter-number'>3</span>&nbsp; <span class='chapter-title'>Summary</span>">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb41" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendix F: Data Preparation for the Model of Textbook English vs. ‘real-world’ English {.unnumbered}</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>This script documents the steps taken to pre-process the data extracted from the Textbook English Corpus (TEC) and the three reference corpora that were ultimately entered in the comparative multi-dimensional model of Textbook English as compared to English outside the EFL classroom (Chapter 7).</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages required</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>The following packages must be installed and loaded to process the data.</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: set-up</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::restore() # Restore the project's dependencies from the lockfile to ensure that same package versions are used as in the original thesis.</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># For checking singularity issues </span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># For recoding data</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># For the feature correlation matrix</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># For nice plots</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co"># Comparing group means of predicted values</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co"># For ggpairs</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># For making large faceted plots</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># For ease of sharing</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># Loaded to display the tables using the kable() function</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># For mixed effects modelling</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co"># For various useful stats function, including KMO()</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co"># For working with colours</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># For nice tabular display of regression models</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># For data wrangling and plotting</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg) <span class="co"># For nice visualisations of model results</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R_rainclouds.R"</span>)) <span class="co"># For geom_flat_violin rainplots</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r palette}</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="in"># Colours used in Register Studies paper and included in Open Access plots published on Zenodo:</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="in">#colours &lt;- suf_palette(name = "london", n = 6, type = "continuous") # Very nice, similar to OrRd palette</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="in">#scales::show_col(colours)</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="in">#colours &lt;- colours[6:1] </span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="in"># Colour scheme used in PhD thesis:</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="in">colours = c("#F9B921", "#A18A33",  "#722672", "#BD241E", "#15274D", "#D54E1E") </span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a><span class="in"># scales::show_col(colours)</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data import from MFTE outputs</span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>The raw data used in this script comes from the matrices of mixed normalised frequencies as output by the <span class="co">[</span><span class="ot">MFTE Perl v. 3.1</span><span class="co">](https://github.com/mshakirDr/MultiFeatureTaggerEnglish)</span> <span class="co">[</span><span class="ot">@lefoll2021</span><span class="co">]</span>.</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a><span class="fu">### Spoken BNC2014</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>These normalised frequencies were computed on the basis of my own "John and Jill in Ivybridge" version of the Spoken BNC2014 with added full stops at speaker turns (see Appendix B for details).</span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r SpokenBNC2014}</span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014 &lt;- read.delim(here("data", "MFTE", "SpokenBNC2014_3.1_normed_complex_counts.tsv"), header = TRUE, stringsAsFactors = TRUE)</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Series &lt;- "Spoken BNC2014"</span></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Level &lt;- "Ref."</span></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Country &lt;- "Spoken BNC2014"</span></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a><span class="in">SpokenBNC2014$Register &lt;- "Spoken BNC2014"</span></span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Youth Fiction corpus</span></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>These normalised frequencies were computed on the basis of the random samples of approximately 5,000 words of the books of the Youth Fiction corpus (for details of the works included in this corpus, see Appendix B).</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r YouthFiction}</span></span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction &lt;- read.delim(here("data", "MFTE", "YF_sampled_500_3.1_normed_complex_counts.tsv"), header = TRUE, stringsAsFactors = TRUE)</span></span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Series &lt;- "Youth Fiction"</span></span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Level &lt;- "Ref."</span></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Country &lt;- "Youth Fiction"</span></span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a><span class="in">YouthFiction$Register &lt;- "Youth Fiction"</span></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a><span class="fu">### Informative Texts for Teens (InfoTeens) corpus</span></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r InfoTeencounts}</span></span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen &lt;- read.delim(here("data", "MFTE", "InfoTeen_3.1_normed_complex_counts.tsv"), header = TRUE, stringsAsFactors = TRUE)</span></span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a><span class="in"># Removes three outlier files which should not have been included in the corpus as they contain exam papers only</span></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen &lt;- InfoTeen |&gt; </span></span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Filename!=".DS_Store" &amp; Filename!="Revision_World_GCSE_10529068_wjec-level-law-past-papers.txt" &amp; Filename!="Revision_World_GCSE_10528474_wjec-level-history-past-papers.txt" &amp; Filename!="Revision_World_GCSE_10528472_edexcel-level-history-past-papers.txt")</span></span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Series &lt;- "Info Teens"</span></span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Level &lt;- "Ref."</span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Country &lt;- "Info Teens"</span></span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a><span class="in">InfoTeen$Register &lt;- "Info Teens"</span></span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>Details of the composition of the Info Teens corpus can be found in Section 4.3.2.5 of the book. The version used in the present study comprises <span class="in">`{r} nrow(InfoTeen) |&gt; format(big.mark=",")`</span> texts.</span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## Merging TEC and reference corpora data</span></span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r DataMerging}</span></span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a><span class="in">TxBncounts &lt;- readRDS(here("data", "processed", "TxBcounts.rds"))</span></span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a><span class="in">All3Reg &lt;- c("Conversation", "Fiction", "Informative")</span></span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a><span class="in">TxBncounts3Reg &lt;- TxBncounts |&gt; </span></span>
<span id="cb41-117"><a href="#cb41-117" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Register %in% All3Reg) |&gt; </span></span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a><span class="in">  droplevels()</span></span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts &lt;- bind_rows(TxBncounts3Reg, InfoTeen, SpokenBNC2014, YouthFiction, .id = "Corpus")</span></span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert all character vectors to factors</span></span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts[sapply(ncounts, is.character)] &lt;- lapply(ncounts[sapply(ncounts, is.character)], as.factor)</span></span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-125"><a href="#cb41-125" aria-hidden="true" tabindex="-1"></a><span class="in"># Change all NAs to 0</span></span>
<span id="cb41-126"><a href="#cb41-126" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts[is.na(ncounts)] &lt;- 0</span></span>
<span id="cb41-127"><a href="#cb41-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-128"><a href="#cb41-128" aria-hidden="true" tabindex="-1"></a><span class="in">levels(ncounts$Corpus) &lt;- list(Textbook.English="1", Informative.Teens="2", Spoken.BNC2014="3", Youth.Fiction="4")</span></span>
<span id="cb41-129"><a href="#cb41-129" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(ncounts$Corpus)</span></span>
<span id="cb41-130"><a href="#cb41-130" aria-hidden="true" tabindex="-1"></a><span class="in"># summary(ncounts$Series)</span></span>
<span id="cb41-131"><a href="#cb41-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-132"><a href="#cb41-132" aria-hidden="true" tabindex="-1"></a><span class="in"># Wrangle metadata variables</span></span>
<span id="cb41-133"><a href="#cb41-133" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts$Subcorpus &lt;- ncounts$Register</span></span>
<span id="cb41-134"><a href="#cb41-134" aria-hidden="true" tabindex="-1"></a><span class="in">#levels(ncounts$Subcorpus)</span></span>
<span id="cb41-135"><a href="#cb41-135" aria-hidden="true" tabindex="-1"></a><span class="in">levels(ncounts$Subcorpus) &lt;- c("Textbook Conversation", "Textbook Fiction", "Info Teens Ref.", "Textbook Informative", "Spoken BNC2014 Ref.", "Youth Fiction Ref.")</span></span>
<span id="cb41-136"><a href="#cb41-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-137"><a href="#cb41-137" aria-hidden="true" tabindex="-1"></a><span class="in"># Re-order registers</span></span>
<span id="cb41-138"><a href="#cb41-138" aria-hidden="true" tabindex="-1"></a><span class="in">levels(ncounts$Register)</span></span>
<span id="cb41-139"><a href="#cb41-139" aria-hidden="true" tabindex="-1"></a><span class="in">levels(ncounts$Register) &lt;- c("Conversation", "Fiction", "Informative", "Informative", "Conversation", "Fiction")</span></span>
<span id="cb41-140"><a href="#cb41-140" aria-hidden="true" tabindex="-1"></a><span class="in">#summary(ncounts$Register)</span></span>
<span id="cb41-141"><a href="#cb41-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-142"><a href="#cb41-142" aria-hidden="true" tabindex="-1"></a><span class="in"># Re-order variables</span></span>
<span id="cb41-143"><a href="#cb41-143" aria-hidden="true" tabindex="-1"></a><span class="in">ncounts &lt;- select(ncounts, order(names(ncounts))) |&gt; </span></span>
<span id="cb41-144"><a href="#cb41-144" aria-hidden="true" tabindex="-1"></a><span class="in">  select(Filename, Register, Level, Series, Country, Corpus, Subcorpus, Words, everything()) # Then place the metadata variable at the front of the table</span></span>
<span id="cb41-145"><a href="#cb41-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-146"><a href="#cb41-146" aria-hidden="true" tabindex="-1"></a><span class="in">#saveRDS(ncounts, here("data", "processed", "counts3Reg.rds")) # Last saved 6 March 2024</span></span>
<span id="cb41-147"><a href="#cb41-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-148"><a href="#cb41-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-149"><a href="#cb41-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-150"><a href="#cb41-150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Corpus size</span></span>
<span id="cb41-151"><a href="#cb41-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-152"><a href="#cb41-152" aria-hidden="true" tabindex="-1"></a>These tables provide some summary statistics about the texts/files whose normalised feature frequencies were entered in the model of Textbook English vs. real-life English.</span>
<span id="cb41-153"><a href="#cb41-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-156"><a href="#cb41-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-157"><a href="#cb41-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: corpora-summary-stats</span></span>
<span id="cb41-158"><a href="#cb41-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-159"><a href="#cb41-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-160"><a href="#cb41-160" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ncounts<span class="sc">$</span>Subcorpus) <span class="sc">|&gt;</span> </span>
<span id="cb41-161"><a href="#cb41-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"(Sub)corpus"</span>, <span class="st">"# texts"</span>),</span>
<span id="cb41-162"><a href="#cb41-162" aria-hidden="true" tabindex="-1"></a>        <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb41-163"><a href="#cb41-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-164"><a href="#cb41-164" aria-hidden="true" tabindex="-1"></a>ncounts  <span class="sc">|&gt;</span>  </span>
<span id="cb41-165"><a href="#cb41-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Register) <span class="sc">|&gt;</span>  </span>
<span id="cb41-166"><a href="#cb41-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totaltexts =</span> <span class="fu">n</span>(), </span>
<span id="cb41-167"><a href="#cb41-167" aria-hidden="true" tabindex="-1"></a>            <span class="at">totalwords =</span> <span class="fu">sum</span>(Words), </span>
<span id="cb41-168"><a href="#cb41-168" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">as.integer</span>(<span class="fu">mean</span>(Words)), </span>
<span id="cb41-169"><a href="#cb41-169" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">as.integer</span>(<span class="fu">sd</span>(Words)), </span>
<span id="cb41-170"><a href="#cb41-170" aria-hidden="true" tabindex="-1"></a>            <span class="at">TTRmean =</span> <span class="fu">mean</span>(TTR)) <span class="sc">|&gt;</span>  </span>
<span id="cb41-171"><a href="#cb41-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb41-172"><a href="#cb41-172" aria-hidden="true" tabindex="-1"></a>        <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb41-173"><a href="#cb41-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-174"><a href="#cb41-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-175"><a href="#cb41-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-176"><a href="#cb41-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data preparation for PCA</span></span>
<span id="cb41-177"><a href="#cb41-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-178"><a href="#cb41-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### Feature distributions</span></span>
<span id="cb41-179"><a href="#cb41-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-180"><a href="#cb41-180" aria-hidden="true" tabindex="-1"></a>The distributions of each linguistic features were examined by means of visualisation. As shown below, before transformation, many of the features displayed highly skewed distributions.</span>
<span id="cb41-181"><a href="#cb41-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-184"><a href="#cb41-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-185"><a href="#cb41-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: distribution-viz</span></span>
<span id="cb41-186"><a href="#cb41-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-187"><a href="#cb41-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 40</span></span>
<span id="cb41-188"><a href="#cb41-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-189"><a href="#cb41-189" aria-hidden="true" tabindex="-1"></a><span class="co">#ncounts &lt;- readRDS(here("data", "processed", "counts3Reg.rds"))</span></span>
<span id="cb41-190"><a href="#cb41-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-191"><a href="#cb41-191" aria-hidden="true" tabindex="-1"></a>ncounts <span class="sc">|&gt;</span></span>
<span id="cb41-192"><a href="#cb41-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Words) <span class="sc">|&gt;</span> </span>
<span id="cb41-193"><a href="#cb41-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb41-194"><a href="#cb41-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span id="cb41-195"><a href="#cb41-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb41-196"><a href="#cb41-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-197"><a href="#cb41-197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb41-198"><a href="#cb41-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb41-199"><a href="#cb41-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb41-200"><a href="#cb41-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">colour=</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb41-201"><a href="#cb41-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">weight =</span> <span class="dv">2</span>, <span class="at">fill=</span><span class="st">"darkred"</span>, <span class="at">alpha =</span> .<span class="dv">4</span>)</span>
<span id="cb41-202"><a href="#cb41-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-203"><a href="#cb41-203" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "DensityPlotsAllVariables.svg"), width = 15, height = 49)</span></span>
<span id="cb41-204"><a href="#cb41-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-205"><a href="#cb41-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-206"><a href="#cb41-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-207"><a href="#cb41-207" aria-hidden="true" tabindex="-1"></a><span class="fu">### Feature removal</span></span>
<span id="cb41-208"><a href="#cb41-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-209"><a href="#cb41-209" aria-hidden="true" tabindex="-1"></a>A number of features were removed from the dataset as they are not linguistically interpretable. In the case of the TEC, this included the variable CD because numbers spelt out as digits were removed from the textbooks before these were tagged with the MFTE. In addition, the variables LIKE and SO because these are "bin" features included in the output of the MFTE to ensure that the counts for these polysemous words do not inflate other categories due to mistags <span class="co">[</span><span class="ot">@lefoll2021a</span><span class="co">]</span>.</span>
<span id="cb41-210"><a href="#cb41-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-211"><a href="#cb41-211" aria-hidden="true" tabindex="-1"></a>Whenever linguistically meaningful, very low-frequency features, features with low MSA or communalities (see chunks below) were merged. Finally, features absent from more than third of texts were also excluded. For the comparative analysis of TEC and the reference corpora, the following linguistic features were excluded from the analysis due to low dispersion:</span>
<span id="cb41-212"><a href="#cb41-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-215"><a href="#cb41-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-216"><a href="#cb41-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: feature-removal</span></span>
<span id="cb41-217"><a href="#cb41-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-218"><a href="#cb41-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Removal of meaningless feature: CD because numbers as digits were mostly removed from the textbooks, LIKE and SO because they are dustbin categories</span></span>
<span id="cb41-219"><a href="#cb41-219" aria-hidden="true" tabindex="-1"></a>ncounts <span class="ot">&lt;-</span> ncounts <span class="sc">|&gt;</span> </span>
<span id="cb41-220"><a href="#cb41-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(CD, LIKE, SO))</span>
<span id="cb41-221"><a href="#cb41-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-222"><a href="#cb41-222" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine problematic features into meaningful groups whenever this makes linguistic sense</span></span>
<span id="cb41-223"><a href="#cb41-223" aria-hidden="true" tabindex="-1"></a>ncounts <span class="ot">&lt;-</span> ncounts <span class="sc">|&gt;</span> </span>
<span id="cb41-224"><a href="#cb41-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">JJPR =</span> JJPR <span class="sc">+</span> ABLE, <span class="at">ABLE =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-225"><a href="#cb41-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PASS =</span> PGET <span class="sc">+</span> PASS, <span class="at">PGET =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-226"><a href="#cb41-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TPP3 =</span> TPP3S <span class="sc">+</span> TPP3P, <span class="at">TPP3P =</span> <span class="cn">NULL</span>, <span class="at">TPP3S =</span> <span class="cn">NULL</span>) <span class="sc">|&gt;</span> <span class="co"># Merged due to TTP3P having an individual MSA &lt; 0.5</span></span>
<span id="cb41-227"><a href="#cb41-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FQTI =</span> FREQ <span class="sc">+</span> TIME, <span class="at">FREQ =</span> <span class="cn">NULL</span>, <span class="at">TIME =</span> <span class="cn">NULL</span>) <span class="co"># Merged due to TIME communality &lt; 0.2 (see below)</span></span>
<span id="cb41-228"><a href="#cb41-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-229"><a href="#cb41-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute percentage of texts with occurrences meeting a condition</span></span>
<span id="cb41-230"><a href="#cb41-230" aria-hidden="true" tabindex="-1"></a>compute_percentage <span class="ot">&lt;-</span> <span class="cf">function</span>(data, condition, threshold) {</span>
<span id="cb41-231"><a href="#cb41-231" aria-hidden="true" tabindex="-1"></a>  numeric_data <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.numeric, data)</span>
<span id="cb41-232"><a href="#cb41-232" aria-hidden="true" tabindex="-1"></a>  percentage <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">colSums</span>(condition[, <span class="fu">sapply</span>(numeric_data, is.numeric)])<span class="sc">/</span><span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb41-233"><a href="#cb41-233" aria-hidden="true" tabindex="-1"></a>  percentage <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(percentage)</span>
<span id="cb41-234"><a href="#cb41-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(percentage) <span class="ot">&lt;-</span> <span class="st">"Percentage"</span></span>
<span id="cb41-235"><a href="#cb41-235" aria-hidden="true" tabindex="-1"></a>  percentage <span class="ot">&lt;-</span> percentage <span class="sc">|&gt;</span> </span>
<span id="cb41-236"><a href="#cb41-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percentage)) <span class="sc">|&gt;</span></span>
<span id="cb41-237"><a href="#cb41-237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-238"><a href="#cb41-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(Percentage)</span>
<span id="cb41-239"><a href="#cb41-239" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(threshold)) {</span>
<span id="cb41-240"><a href="#cb41-240" aria-hidden="true" tabindex="-1"></a>    percentage <span class="ot">&lt;-</span> percentage <span class="sc">|&gt;</span> </span>
<span id="cb41-241"><a href="#cb41-241" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Percentage <span class="sc">&gt;</span> threshold)</span>
<span id="cb41-242"><a href="#cb41-242" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-243"><a href="#cb41-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(percentage)</span>
<span id="cb41-244"><a href="#cb41-244" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-245"><a href="#cb41-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-246"><a href="#cb41-246" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage of texts with 0 occurrences of each feature</span></span>
<span id="cb41-247"><a href="#cb41-247" aria-hidden="true" tabindex="-1"></a>zero_features <span class="ot">&lt;-</span> <span class="fu">compute_percentage</span>(ncounts, ncounts <span class="sc">==</span> <span class="dv">0</span>, <span class="fl">66.6</span>)</span>
<span id="cb41-248"><a href="#cb41-248" aria-hidden="true" tabindex="-1"></a>zero_features <span class="sc">|&gt;</span> </span>
<span id="cb41-249"><a href="#cb41-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Feature"</span>, <span class="st">"% texts with zero occurrences"</span>))</span>
<span id="cb41-250"><a href="#cb41-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-251"><a href="#cb41-251" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop variables with low document frequency</span></span>
<span id="cb41-252"><a href="#cb41-252" aria-hidden="true" tabindex="-1"></a>ncounts2 <span class="ot">&lt;-</span> <span class="fu">select</span>(ncounts, <span class="sc">-</span><span class="fu">one_of</span>(zero_features<span class="sc">$</span>rowname))</span>
<span id="cb41-253"><a href="#cb41-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-254"><a href="#cb41-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-255"><a href="#cb41-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-256"><a href="#cb41-256" aria-hidden="true" tabindex="-1"></a>These feature removal operations resulted in a feature set of <span class="in">`{r} ncol(ncounts2)-8`</span> linguistic variables.</span>
<span id="cb41-257"><a href="#cb41-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-258"><a href="#cb41-258" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identifying potential outlier texts</span></span>
<span id="cb41-259"><a href="#cb41-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-260"><a href="#cb41-260" aria-hidden="true" tabindex="-1"></a>All normalised frequencies were normalised to identify any potential outlier texts.</span>
<span id="cb41-261"><a href="#cb41-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-264"><a href="#cb41-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-265"><a href="#cb41-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: z-standardisation-outliers</span></span>
<span id="cb41-266"><a href="#cb41-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 15</span></span>
<span id="cb41-267"><a href="#cb41-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb41-268"><a href="#cb41-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-269"><a href="#cb41-269" aria-hidden="true" tabindex="-1"></a><span class="co"># First scale the normalised counts (z-standardisation) to be able to compare the various features</span></span>
<span id="cb41-270"><a href="#cb41-270" aria-hidden="true" tabindex="-1"></a>zcounts <span class="ot">&lt;-</span> ncounts2 <span class="sc">|&gt;</span></span>
<span id="cb41-271"><a href="#cb41-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Words) <span class="sc">|&gt;</span> </span>
<span id="cb41-272"><a href="#cb41-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb41-273"><a href="#cb41-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb41-274"><a href="#cb41-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-275"><a href="#cb41-275" aria-hidden="true" tabindex="-1"></a><span class="co"># If necessary, remove any outliers at this stage.</span></span>
<span id="cb41-276"><a href="#cb41-276" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ncounts2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="fu">as.data.frame</span>(zcounts))</span>
<span id="cb41-277"><a href="#cb41-277" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb41-278"><a href="#cb41-278" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(<span class="fu">if_any</span>(<span class="fu">where</span>(is.numeric) <span class="sc">&amp;</span> <span class="sc">!</span>Words,  <span class="at">.fns =</span> <span class="cf">function</span>(x){x <span class="sc">&gt;</span> <span class="dv">8</span>}))  <span class="sc">|&gt;</span> </span>
<span id="cb41-279"><a href="#cb41-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Filename, Corpus, Series, Register, Level, Words)</span>
<span id="cb41-280"><a href="#cb41-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-281"><a href="#cb41-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-282"><a href="#cb41-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-283"><a href="#cb41-283" aria-hidden="true" tabindex="-1"></a>The following outlier texts were identified according to the above conditions and excluded in subsequent analyses.</span>
<span id="cb41-284"><a href="#cb41-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-287"><a href="#cb41-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-288"><a href="#cb41-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: list-outliers</span></span>
<span id="cb41-289"><a href="#cb41-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-290"><a href="#cb41-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-291"><a href="#cb41-291" aria-hidden="true" tabindex="-1"></a><span class="co"># These are potential outlier texts :</span></span>
<span id="cb41-292"><a href="#cb41-292" aria-hidden="true" tabindex="-1"></a>outliers</span>
<span id="cb41-293"><a href="#cb41-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-294"><a href="#cb41-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking that outlier texts are not particularly long or short texts</span></span>
<span id="cb41-295"><a href="#cb41-295" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(outliers<span class="sc">$</span>Words)</span>
<span id="cb41-296"><a href="#cb41-296" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(outliers<span class="sc">$</span>Words, <span class="at">breaks =</span> <span class="dv">30</span>)</span>
<span id="cb41-297"><a href="#cb41-297" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of outlier texts across the four corpora</span></span>
<span id="cb41-298"><a href="#cb41-298" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(outliers<span class="sc">$</span>Corpus)</span>
<span id="cb41-299"><a href="#cb41-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-300"><a href="#cb41-300" aria-hidden="true" tabindex="-1"></a><span class="co"># Report on the manual check of a sample of these outliers:</span></span>
<span id="cb41-301"><a href="#cb41-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-302"><a href="#cb41-302" aria-hidden="true" tabindex="-1"></a><span class="co"># Encyclopedia_Kinds_au_10085347_Nobel_Prize_in_Chemistry.txt is essentially a list of Nobel prize winners but with some additional information. In other words, not a bad representative of the type of texts of the Info Teen corpus.</span></span>
<span id="cb41-303"><a href="#cb41-303" aria-hidden="true" tabindex="-1"></a><span class="co"># Solutions_Elementary_ELF_Spoken_0013 --&gt; Has a lot of "going to" constructions because they are learnt in this chapter but is otherwise a well-formed text.</span></span>
<span id="cb41-304"><a href="#cb41-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Teen_Kids_News_10403972_a-brief-history-of-white-house-weddings --&gt; No issues</span></span>
<span id="cb41-305"><a href="#cb41-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Teen_Kids_News_10403301_golden-globe-winners-2019-the-complete-list --&gt; Similar to the Nobel prize laureates text.</span></span>
<span id="cb41-306"><a href="#cb41-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Revision_World_GCSE_10528123_gender-written-textual-analysis-framework --&gt; Text includes bullet points tokenised as the letter "o" but otherwise a fairly typical informative text.</span></span>
<span id="cb41-307"><a href="#cb41-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-308"><a href="#cb41-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing the outliers at the request of the reviewers (but comparisons of models including the outliers showed that the results are very similar):</span></span>
<span id="cb41-309"><a href="#cb41-309" aria-hidden="true" tabindex="-1"></a>ncounts3 <span class="ot">&lt;-</span> ncounts2 <span class="sc">|&gt;</span> </span>
<span id="cb41-310"><a href="#cb41-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Filename <span class="sc">%in%</span> outliers<span class="sc">$</span>Filename)</span>
<span id="cb41-311"><a href="#cb41-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-312"><a href="#cb41-312" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(ncounts3, here("data", "processed", "ncounts3_3Reg.rds")) # Last saved 6 March 2024</span></span>
<span id="cb41-313"><a href="#cb41-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-314"><a href="#cb41-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-315"><a href="#cb41-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-316"><a href="#cb41-316" aria-hidden="true" tabindex="-1"></a>This resulted in <span class="in">`{r} nrow(ncounts3) |&gt; format(big.mark=",")`</span> texts/files being included in the comparative model of Textbook English vs. 'real-life' English. These standardised feature frequencies were distributed as follows:</span>
<span id="cb41-317"><a href="#cb41-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-320"><a href="#cb41-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-321"><a href="#cb41-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: z-transformed-distributions</span></span>
<span id="cb41-322"><a href="#cb41-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 40</span></span>
<span id="cb41-323"><a href="#cb41-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-324"><a href="#cb41-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-325"><a href="#cb41-325" aria-hidden="true" tabindex="-1"></a>zcounts3 <span class="ot">&lt;-</span> ncounts3 <span class="sc">|&gt;</span></span>
<span id="cb41-326"><a href="#cb41-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Words) <span class="sc">|&gt;</span> </span>
<span id="cb41-327"><a href="#cb41-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">|&gt;</span> </span>
<span id="cb41-328"><a href="#cb41-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb41-329"><a href="#cb41-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-330"><a href="#cb41-330" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(zcounts3, <span class="at">las =</span> <span class="dv">3</span>, <span class="at">main =</span> <span class="st">"z-scores"</span>) <span class="co"># Slow</span></span>
<span id="cb41-331"><a href="#cb41-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-332"><a href="#cb41-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-333"><a href="#cb41-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-334"><a href="#cb41-334" aria-hidden="true" tabindex="-1"></a><span class="fu">### Signed log transformation</span></span>
<span id="cb41-335"><a href="#cb41-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-336"><a href="#cb41-336" aria-hidden="true" tabindex="-1"></a>A signed logarithmic transformation was applied to (further) deskew the feature distributions <span class="co">[</span><span class="ot">@diwersy2014; @neumann2021</span><span class="co">]</span>.</span>
<span id="cb41-337"><a href="#cb41-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-338"><a href="#cb41-338" aria-hidden="true" tabindex="-1"></a>The signed log transformation function was inspired by the SignedLog function proposed in https://cran.r-project.org/web/packages/DataVisualizations/DataVisualizations.pdf</span>
<span id="cb41-339"><a href="#cb41-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-342"><a href="#cb41-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-343"><a href="#cb41-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: signed.log.transformation</span></span>
<span id="cb41-344"><a href="#cb41-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-345"><a href="#cb41-345" aria-hidden="true" tabindex="-1"></a>signed.log <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sign</span>(x)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">abs</span>(x)<span class="sc">+</span><span class="dv">1</span>)}</span>
<span id="cb41-346"><a href="#cb41-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-347"><a href="#cb41-347" aria-hidden="true" tabindex="-1"></a>zlogcounts <span class="ot">&lt;-</span> <span class="fu">signed.log</span>(zcounts3) <span class="co"># Standardise first, then sign log transform</span></span>
<span id="cb41-348"><a href="#cb41-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-349"><a href="#cb41-349" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(zlogcounts, here("data", "processed", "zlogcounts_3Reg.rds")) # Last saved 16 March 2024</span></span>
<span id="cb41-350"><a href="#cb41-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-351"><a href="#cb41-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-352"><a href="#cb41-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-353"><a href="#cb41-353" aria-hidden="true" tabindex="-1"></a>The new feature distributions are visualised below.</span>
<span id="cb41-354"><a href="#cb41-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-357"><a href="#cb41-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-358"><a href="#cb41-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: signed.log.transformation-distributions</span></span>
<span id="cb41-359"><a href="#cb41-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 40</span></span>
<span id="cb41-360"><a href="#cb41-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-361"><a href="#cb41-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-362"><a href="#cb41-362" aria-hidden="true" tabindex="-1"></a>zlogcounts <span class="sc">|&gt;</span></span>
<span id="cb41-363"><a href="#cb41-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb41-364"><a href="#cb41-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">|&gt;</span> <span class="co"># This function from tidyr converts a selection of variables into two variables: a key and a value. The key contains the names of the original variable and the value the data. This means we can then use the facet_wrap function from ggplot2</span></span>
<span id="cb41-365"><a href="#cb41-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb41-366"><a href="#cb41-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-367"><a href="#cb41-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb41-368"><a href="#cb41-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb41-369"><a href="#cb41-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb41-370"><a href="#cb41-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">colour=</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb41-371"><a href="#cb41-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">"darkred"</span>, <span class="at">weight =</span> <span class="dv">2</span>, <span class="at">fill=</span><span class="st">"darkred"</span>, <span class="at">alpha =</span> .<span class="dv">4</span>)</span>
<span id="cb41-372"><a href="#cb41-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-373"><a href="#cb41-373" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(here("plots", "DensityPlotsAllVariablesSignedLog.svg"), width = 15, height = 49)</span></span>
<span id="cb41-374"><a href="#cb41-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-375"><a href="#cb41-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-376"><a href="#cb41-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-377"><a href="#cb41-377" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merging of data for MDA</span></span>
<span id="cb41-378"><a href="#cb41-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-381"><a href="#cb41-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-382"><a href="#cb41-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-383"><a href="#cb41-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-384"><a href="#cb41-384" aria-hidden="true" tabindex="-1"></a>zlogcounts <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"zlogcounts_3Reg.rds"</span>)) </span>
<span id="cb41-385"><a href="#cb41-385" aria-hidden="true" tabindex="-1"></a><span class="co">#nrow(zlogcounts)</span></span>
<span id="cb41-386"><a href="#cb41-386" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(zlogcounts)</span></span>
<span id="cb41-387"><a href="#cb41-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-388"><a href="#cb41-388" aria-hidden="true" tabindex="-1"></a>ncounts3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>, <span class="st">"ncounts3_3Reg.rds"</span>))</span>
<span id="cb41-389"><a href="#cb41-389" aria-hidden="true" tabindex="-1"></a><span class="co">#nrow(ncounts3)</span></span>
<span id="cb41-390"><a href="#cb41-390" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(ncounts3)</span></span>
<span id="cb41-391"><a href="#cb41-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-392"><a href="#cb41-392" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ncounts3[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="fu">as.data.frame</span>(zlogcounts))</span>
<span id="cb41-393"><a href="#cb41-393" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(data, here("data", "processed", "datazlogcounts_3Reg.rds")) # Last saved 16 March 2024</span></span>
<span id="cb41-394"><a href="#cb41-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-395"><a href="#cb41-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-396"><a href="#cb41-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-397"><a href="#cb41-397" aria-hidden="true" tabindex="-1"></a>The final dataset comprises of <span class="in">`{r} nrow(data) |&gt; format(big.mark=",")`</span> texts/files, divided as follows:</span>
<span id="cb41-398"><a href="#cb41-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-401"><a href="#cb41-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-402"><a href="#cb41-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb41-403"><a href="#cb41-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-404"><a href="#cb41-404" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>Subcorpus)</span>
<span id="cb41-405"><a href="#cb41-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-406"><a href="#cb41-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-407"><a href="#cb41-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-408"><a href="#cb41-408" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing factorability of data</span></span>
<span id="cb41-409"><a href="#cb41-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-410"><a href="#cb41-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r prepare-data}</span></span>
<span id="cb41-411"><a href="#cb41-411" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb41-412"><a href="#cb41-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-413"><a href="#cb41-413" aria-hidden="true" tabindex="-1"></a><span class="in"># Quick import</span></span>
<span id="cb41-414"><a href="#cb41-414" aria-hidden="true" tabindex="-1"></a><span class="in">#data &lt;- readRDS(here("data", "processed", "datazlogcounts_3Reg.rds"))</span></span>
<span id="cb41-415"><a href="#cb41-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-416"><a href="#cb41-416" aria-hidden="true" tabindex="-1"></a><span class="in"># This rearranges the levels in the desired order for the plot legends:</span></span>
<span id="cb41-417"><a href="#cb41-417" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- data |&gt; </span></span>
<span id="cb41-418"><a href="#cb41-418" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Subcorpus = fct_relevel(Subcorpus, "Info Teens Ref.", after = 9))</span></span>
<span id="cb41-419"><a href="#cb41-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-420"><a href="#cb41-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-421"><a href="#cb41-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-422"><a href="#cb41-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualisation of feature correlations</span></span>
<span id="cb41-423"><a href="#cb41-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-424"><a href="#cb41-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r heatmap}</span></span>
<span id="cb41-425"><a href="#cb41-425" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb41-426"><a href="#cb41-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-427"><a href="#cb41-427" aria-hidden="true" tabindex="-1"></a><span class="in"># Simple heatmap in base R (inspired by Stephanie Evert's SIGIL code)</span></span>
<span id="cb41-428"><a href="#cb41-428" aria-hidden="true" tabindex="-1"></a><span class="in">cor.colours &lt;- c(</span></span>
<span id="cb41-429"><a href="#cb41-429" aria-hidden="true" tabindex="-1"></a><span class="in">  hsv(h=2/3, v=1, s=(10:1)/10), # blue = negative correlation </span></span>
<span id="cb41-430"><a href="#cb41-430" aria-hidden="true" tabindex="-1"></a><span class="in">  rgb(1,1,1), # white = no correlation </span></span>
<span id="cb41-431"><a href="#cb41-431" aria-hidden="true" tabindex="-1"></a><span class="in">  hsv(h=0, v=1, s=(1:10/10))) # red = positive correlation</span></span>
<span id="cb41-432"><a href="#cb41-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-433"><a href="#cb41-433" aria-hidden="true" tabindex="-1"></a><span class="in">#png(here("plots", "heatmapzlogcounts.png"), width = 30, height= 30, units = "cm", res = 300)</span></span>
<span id="cb41-434"><a href="#cb41-434" aria-hidden="true" tabindex="-1"></a><span class="in">heatmap(cor(zlogcounts), </span></span>
<span id="cb41-435"><a href="#cb41-435" aria-hidden="true" tabindex="-1"></a><span class="in">        symm=TRUE, </span></span>
<span id="cb41-436"><a href="#cb41-436" aria-hidden="true" tabindex="-1"></a><span class="in">        zlim=c(-1,1), </span></span>
<span id="cb41-437"><a href="#cb41-437" aria-hidden="true" tabindex="-1"></a><span class="in">        col=cor.colours, </span></span>
<span id="cb41-438"><a href="#cb41-438" aria-hidden="true" tabindex="-1"></a><span class="in">        margins=c(7,7))</span></span>
<span id="cb41-439"><a href="#cb41-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-440"><a href="#cb41-440" aria-hidden="true" tabindex="-1"></a><span class="in">#dev.off()</span></span>
<span id="cb41-441"><a href="#cb41-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-442"><a href="#cb41-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-443"><a href="#cb41-443" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking the factorability of data</span></span>
<span id="cb41-444"><a href="#cb41-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-445"><a href="#cb41-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Collinearity</span></span>
<span id="cb41-446"><a href="#cb41-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-447"><a href="#cb41-447" aria-hidden="true" tabindex="-1"></a>As a result of the normalisation unit of finite verb phrases for verb-based features, the present tense (VPRT) and past tense (VBD) variables are highly correlated:</span>
<span id="cb41-448"><a href="#cb41-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-449"><a href="#cb41-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collinear}</span></span>
<span id="cb41-450"><a href="#cb41-450" aria-hidden="true" tabindex="-1"></a><span class="in">cor(data$VPRT, data$VBD)</span></span>
<span id="cb41-451"><a href="#cb41-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-452"><a href="#cb41-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-453"><a href="#cb41-453" aria-hidden="true" tabindex="-1"></a>We therefore remove the least marked of the pair of collinear variables: VPRT.</span>
<span id="cb41-454"><a href="#cb41-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-455"><a href="#cb41-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collinear2}</span></span>
<span id="cb41-456"><a href="#cb41-456" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- data |&gt; </span></span>
<span id="cb41-457"><a href="#cb41-457" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(VPRT))</span></span>
<span id="cb41-458"><a href="#cb41-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-459"><a href="#cb41-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-460"><a href="#cb41-460" aria-hidden="true" tabindex="-1"></a><span class="fu">### MSA</span></span>
<span id="cb41-461"><a href="#cb41-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-462"><a href="#cb41-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r factorability.TEC}</span></span>
<span id="cb41-463"><a href="#cb41-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-464"><a href="#cb41-464" aria-hidden="true" tabindex="-1"></a><span class="in">kmo &lt;- KMO(data[,9:ncol(data)]) </span></span>
<span id="cb41-465"><a href="#cb41-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-466"><a href="#cb41-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-467"><a href="#cb41-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-468"><a href="#cb41-468" aria-hidden="true" tabindex="-1"></a>The overall MSA value of the dataset is <span class="in">`{r} kmo$MSA |&gt; round(2)`</span>. The features have the following individual MSA values (ordered from lowest to largest):</span>
<span id="cb41-469"><a href="#cb41-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-472"><a href="#cb41-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-473"><a href="#cb41-473" aria-hidden="true" tabindex="-1"></a>kmo<span class="sc">$</span>MSAi[<span class="fu">order</span>(kmo<span class="sc">$</span>MSAi)] <span class="sc">|&gt;</span>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb41-474"><a href="#cb41-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-475"><a href="#cb41-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-476"><a href="#cb41-476" aria-hidden="true" tabindex="-1"></a>We aim to remove features with an individual MSA <span class="sc">\&lt;</span> 0.5. All features have individual MSAs of &gt; 0.5 (but only because TPP3P was merged into a larger category earlier on).</span>
<span id="cb41-477"><a href="#cb41-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-478"><a href="#cb41-478" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scree plot</span></span>
<span id="cb41-479"><a href="#cb41-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-482"><a href="#cb41-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-483"><a href="#cb41-483" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb41-484"><a href="#cb41-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-485"><a href="#cb41-485" aria-hidden="true" tabindex="-1"></a><span class="co"># png(here("plots", "screeplot-TEC-Ref_3Reg.png"), width = 20, height= 12, units = "cm", res = 300)</span></span>
<span id="cb41-486"><a href="#cb41-486" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(data[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(data)], <span class="at">factors =</span> <span class="cn">FALSE</span>, <span class="at">pc =</span> <span class="cn">TRUE</span>) <span class="co"># 6 components were originally retained on the basis of this screeplot (on the advice of an anonymous peer reviewer, only four were later retained).</span></span>
<span id="cb41-487"><a href="#cb41-487" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb41-488"><a href="#cb41-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-489"><a href="#cb41-489" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb41-490"><a href="#cb41-490" aria-hidden="true" tabindex="-1"></a>pca1 <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">principal</span>(data[<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(data)], </span>
<span id="cb41-491"><a href="#cb41-491" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nfactors =</span> <span class="dv">6</span>)</span>
<span id="cb41-492"><a href="#cb41-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-493"><a href="#cb41-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-494"><a href="#cb41-494" aria-hidden="true" tabindex="-1"></a><span class="fu">### Communalities</span></span>
<span id="cb41-495"><a href="#cb41-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-496"><a href="#cb41-496" aria-hidden="true" tabindex="-1"></a>If features with final communalities of &lt; 0.2 are removed, we would remove TIME. TIME was therefore merged with FREQ in an earlier chunk so that now all features have final communalities of &gt; 0.2 (note: that this is a very generous threshold!).</span>
<span id="cb41-497"><a href="#cb41-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-498"><a href="#cb41-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r communalities}</span></span>
<span id="cb41-499"><a href="#cb41-499" aria-hidden="true" tabindex="-1"></a><span class="in">pca1$communality |&gt; sort() |&gt; round(2)</span></span>
<span id="cb41-500"><a href="#cb41-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-501"><a href="#cb41-501" aria-hidden="true" tabindex="-1"></a><span class="in">#saveRDS(data, here("data", "processed", "dataforPCA.rds")) # Last saved on 6 March 2024</span></span>
<span id="cb41-502"><a href="#cb41-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-503"><a href="#cb41-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-504"><a href="#cb41-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-505"><a href="#cb41-505" aria-hidden="true" tabindex="-1"></a>The final dataset entered in the analysis described in Chapter 7 therefore comprises <span class="in">`{r} nrow(data)  |&gt; format(big.mark=",")`</span> texts/files, each with logged standardised normalised frequencies for <span class="in">`{r} ncol(data)-8`</span> linguistic features.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.elenlefoll.eu">Elen Le Foll</a></p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://benjamins.com/catalog/scl">Textbook English</a></p>
</div>
    <div class="nav-footer-right">
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a></p>
</div>
  </div>
</footer>


</body></html>